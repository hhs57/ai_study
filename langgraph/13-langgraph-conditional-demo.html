<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LangGraph æ¡ä»¶è¾¹ - LangChain å­¦ä¹  13</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
            min-height: 100vh;
            color: #e2e8f0;
            overflow-x: hidden;
            position: relative;
        }

        /* æµ®åŠ¨å…‰çƒ */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            pointer-events: none;
            z-index: 0;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(217, 70, 239, 0.3) 0%, rgba(168, 85, 247, 0.1) 50%, transparent 70%);
            top: -200px;
            right: -200px;
        }

        .orb-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(236, 72, 153, 0.2) 0%, rgba(244, 114, 182, 0.1) 50%, transparent 70%);
            bottom: -150px;
            left: -150px;
            animation-delay: -10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(30px, -30px) scale(1.1); }
            50% { transform: translate(-20px, 20px) scale(0.9); }
            75% { transform: translate(-30px, -20px) scale(1.05); }
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        /* å¤´éƒ¨ */
        .header {
            text-align: center;
            margin-bottom: 60px;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #d946ef 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 40px rgba(217, 70, 239, 0.3);
        }

        .header p {
            font-size: 1.3em;
            color: rgba(226, 232, 240, 0.8);
        }

        /* è¿›åº¦æ¡ */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 1000;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #d946ef 0%, #a855f7 50%, #8b5cf6 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* åœºæ™¯å®¹å™¨ */
        .scene {
            display: none;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scene.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* åœºæ™¯æ ‡é¢˜ */
        .scene-title {
            font-size: 2.5em;
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(135deg, #d946ef 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* åŠ¨ç”»ç”»å¸ƒ */
        .canvas-container {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        /* å†³ç­–æ ‘å¯è§†åŒ– */
        .decision-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            padding: 20px;
        }

        .tree-level {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .decision-node {
            background: rgba(217, 70, 239, 0.2);
            border: 3px solid rgba(217, 70, 239, 0.5);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            min-width: 150px;
            transition: all 0.6s;
            transform: scale(0.8);
            opacity: 0;
            position: relative;
        }

        .decision-node.visible {
            transform: scale(1);
            opacity: 1;
        }

        .decision-node.active {
            background: rgba(34, 197, 94, 0.3);
            border-color: rgba(34, 197, 94, 0.7);
            box-shadow: 0 0 40px rgba(34, 197, 94, 0.6);
            transform: scale(1.15);
        }

        .decision-node.condition {
            background: rgba(251, 191, 36, 0.2);
            border-color: rgba(251, 191, 36, 0.5);
        }

        .decision-node.condition.active {
            background: rgba(251, 191, 36, 0.4);
            border-color: rgba(251, 191, 36, 0.8);
            box-shadow: 0 0 40px rgba(251, 191, 36, 0.6);
        }

        .decision-node .icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .decision-node h4 {
            color: #d946ef;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .decision-node p {
            color: rgba(226, 232, 240, 0.7);
            font-size: 0.85em;
        }

        /* è¿æ¥çº¿ */
        .connection-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .connection-line {
            stroke: rgba(217, 70, 239, 0.3);
            stroke-width: 3;
            fill: none;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .connection-line.visible {
            opacity: 1;
        }

        .connection-line.active {
            stroke: rgba(34, 197, 94, 0.6);
            stroke-width: 4;
        }

        /* ç‰¹æ€§å¡ç‰‡ */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            transform: translateY(30px);
            opacity: 0;
            transition: all 0.6s;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .feature-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .feature-card:hover {
            background: rgba(217, 70, 239, 0.15);
            transform: translateY(-8px);
            box-shadow: 0 10px 30px rgba(217, 70, 239, 0.3);
        }

        .feature-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .feature-card h4 {
            color: #d946ef;
            margin-bottom: 12px;
            font-size: 1.3em;
        }

        .feature-card p {
            color: rgba(226, 232, 240, 0.7);
            line-height: 1.6;
        }

        /* ä»£ç ç‰‡æ®µ */
        .code-snippet {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            overflow-x: auto;
        }

        .keyword { color: #c792ea; font-weight: bold; }
        .string { color: #c3e88d; }
        .comment { color: #546e7a; font-style: italic; }
        .function { color: #82aaff; }

        /* é«˜äº®æ¡† */
        .highlight-box {
            background: rgba(217, 70, 239, 0.15);
            border-left: 5px solid #d946ef;
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
            animation: slideInRight 0.8s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .highlight-box h3 {
            color: #d946ef;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .highlight-box p {
            line-height: 1.8;
            color: rgba(226, 232, 240, 0.9);
        }

        /* æ¼”ç¤ºæŒ‰é’® */
        .demo-btn {
            background: linear-gradient(135deg, #d946ef 0%, #a855f7 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(217, 70, 239, 0.4);
            margin: 20px auto;
            display: block;
        }

        .demo-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(217, 70, 239, 0.6);
        }

        .demo-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* å¯¼èˆªæŒ‰é’® */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            gap: 20px;
        }

        .nav-btn {
            padding: 15px 40px;
            background: rgba(217, 70, 239, 0.2);
            border: 2px solid rgba(217, 70, 239, 0.5);
            border-radius: 12px;
            color: #d946ef;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-btn:hover:not(:disabled) {
            background: rgba(217, 70, 239, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(217, 70, 239, 0.4);
        }

        /* é’ˆå¯¹ a æ ‡ç­¾çš„å¯¼èˆªæŒ‰é’®æ ·å¼ */
        .nav-btn.back-to-list {
            text-decoration: none;
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            color: #60a5fa;
        }

        .nav-btn.back-to-list:hover {
            background: rgba(59, 130, 246, 0.4);
            box-shadow: 0 5px 20px rgba(59, 130, 246, 0.4);
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .nav-btn.next {
            margin-left: auto;
        }

        /* åœºæ™¯æŒ‡ç¤ºå™¨ */
        .scene-indicators {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 40px 0;
        }

        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s;
        }

        .indicator.active {
            background: #d946ef;
            transform: scale(1.3);
        }

        .indicator:hover {
            transform: scale(1.2);
        }

        /* åˆ†æ”¯æ¡† */
        .branch-box {
            background: linear-gradient(135deg, rgba(217, 70, 239, 0.15), rgba(168, 85, 247, 0.15));
            border: 2px solid rgba(217, 70, 239, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin: 15px 0;
            text-align: center;
        }

        .branch-box h4 {
            color: #d946ef;
            margin-bottom: 10px;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .comparison-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 30px 0;
            overflow: hidden;
            border-radius: 15px;
        }

        .comparison-table thead {
            background: rgba(217, 70, 239, 0.3);
        }

        .comparison-table th {
            padding: 20px;
            text-align: left;
            font-weight: bold;
            color: #d946ef;
            font-size: 1.1em;
        }

        .comparison-table td {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }

        .comparison-table tr:hover td {
            background: rgba(217, 70, 239, 0.1);
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .tree-level {
                flex-direction: column;
            }
        }
    
        /* æ ‡å‡†å¯¼èˆªæ ·å¼ */
        .nav-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 32px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .nav-card a {
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .nav-card a:hover {
            transform: translateY(-2px);
        }

        /* é¡¶éƒ¨å¯¼èˆªå¡ç‰‡ */
        .top-nav-card {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px 24px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .top-nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .top-nav-left,
        .top-nav-center,
        .top-nav-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .top-nav-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #9ca3af;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .top-nav-link:hover {
            color: #e5e7eb;
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }

        .top-nav-link.home {
            color: #4ade80;
        }

        .top-nav-link.home:hover {
            color: #86efac;
        }

        .top-nav-link svg {
            width: 20px;
            height: 20px;
        }

        .top-nav-divider {
            width: 1px;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
        }

        .top-nav-text {
            color: #6b7280;
            font-size: 0.9em;
        }

        .top-nav-progress {
            color: #9ca3af;
            font-size: 0.9em;
            font-weight: 500;
        }
</style>
</head>
<body>
    <!-- æµ®åŠ¨å…‰çƒ -->
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>    <!-- é¡¶éƒ¨å¯¼èˆª - è·¨æ¨¡å— -->
    <div class="top-nav-card">
        <div class="top-nav-container">
            <div class="top-nav-left">
                <a href="index.html" class="top-nav-link home">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    è¿”å›LangGraphç›®å½•
                </a>
            </div>
            <div class="top-nav-center">
                <a href="12-langgraph-state-demo.html" class="top-nav-link">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    ä¸Šä¸€è¯¾
                </a>
                <div class="top-nav-divider"></div>
                <a href="14-langgraph-loops-demo.html" class="top-nav-link">
                    ä¸‹ä¸€è¯¾
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>
            <div class="top-nav-right">
                <span class="top-nav-progress">è¯¾ç¨‹ 13 / 20</span>
            </div>
        </div>
    </div>

    <!-- è¿›åº¦æ¡ -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>LangGraph æ¡ä»¶è¾¹</h1>
            <p>æ ¹æ®çŠ¶æ€åŠ¨æ€å†³å®šä¸‹ä¸€ä¸ªèŠ‚ç‚¹</p>
        </div>

        <!-- åœºæ™¯ 1: ä»€ä¹ˆæ˜¯æ¡ä»¶è¾¹ -->
        <div class="scene active" id="scene1">
            <h2 class="scene-title">ä»€ä¹ˆæ˜¯æ¡ä»¶è¾¹ï¼Ÿ</h2>

            <div class="highlight-box">
                <h3>ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ</h3>
                <p>
                    æ¡ä»¶è¾¹å…è®¸æ ¹æ®<strong>å½“å‰çŠ¶æ€åŠ¨æ€å†³å®š</strong>ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„èŠ‚ç‚¹ã€‚<br><br>
                    <strong>æƒ³è±¡ä¸€ä¸‹ï¼š</strong><br>
                    æ™®é€šè¾¹å°±åƒ<strong>å•è¡Œé“</strong>ï¼Œåªèƒ½æŒ‰å›ºå®šè·¯çº¿è¡Œé©¶<br>
                    æ¡ä»¶è¾¹å°±åƒ<strong>æ™ºèƒ½å¯¼èˆª</strong>ï¼Œå¯ä»¥æ ¹æ®å®æ—¶æƒ…å†µé€‰æ‹©ä¸åŒè·¯çº¿<br><br>
                    <strong>è¿™æ ·å°±èƒ½å®ç°ï¼š</strong><br>
                    âœ… åˆ†æ”¯æµç¨‹ï¼ˆif-elseï¼‰<br>
                    âœ… å¤šè·¯å¾„é€‰æ‹©ï¼ˆswitch-caseï¼‰<br>
                    âœ… å¾ªç¯å’Œè¿­ä»£<br>
                    âœ… å¤æ‚çš„å†³ç­–æ ‘
                </p>
            </div>

            <div class="canvas-container">
                <h3 style="text-align: center; color: #d946ef; margin-bottom: 30px; font-size: 1.5em;">æ¡ä»¶åˆ†æ”¯æ¼”ç¤º</h3>

                <!-- çŠ¶æ€æ˜¾ç¤ºé¢æ¿ -->
                <div class="state-display" id="simpleStateDisplay" style="margin-bottom: 30px; display: none;">
                    <div style="color: #a78bfa; font-weight: bold; margin-bottom: 8px;">ğŸ“Š å½“å‰çŠ¶æ€</div>
                    <div id="simpleStateContent" style="font-size: 1.3em; color: #60a5fa; font-weight: bold; font-family: monospace;">
                        { score: ? }
                    </div>
                </div>

                <!-- æ­¥éª¤æè¿° -->
                <div id="simpleStepDesc" style="text-align: center; min-height: 80px; padding: 20px; background: rgba(217, 70, 239, 0.1); border-radius: 10px; margin-bottom: 30px; color: #e2e8f0; font-size: 1.1em; line-height: 1.6;">
                    ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºæ¡ä»¶åˆ†æ”¯æµç¨‹
                </div>

                <div class="decision-tree" id="simpleDecisionTree">
                    <div class="tree-level">
                        <div class="decision-node" data-step="1">
                            <div class="icon">ğŸ”„</div>
                            <h4>æ¡ä»¶èŠ‚ç‚¹</h4>
                            <p>æ£€æŸ¥çŠ¶æ€</p>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node condition" data-step="2">
                            <div class="icon">â“</div>
                            <h4>åˆ¤æ–­æ¡ä»¶</h4>
                            <p>score >= 60?</p>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node" data-step="3">
                            <div class="icon">âœ…</div>
                            <h4>é€šè¿‡èŠ‚ç‚¹</h4>
                            <p>score >= 60</p>
                        </div>

                        <div class="decision-node" data-step="4">
                            <div class="icon">âŒ</div>
                            <h4>å¤±è´¥èŠ‚ç‚¹</h4>
                            <p>score < 60</p>
                        </div>
                    </div>
                </div>

                <button class="demo-btn" id="runDecisionBtn" onclick="runSimpleDecision()">â–¶ï¸ æ’­æ”¾æ¡ä»¶åˆ†æ”¯åŠ¨ç”»</button>
            </div>
        </div>

        <!-- åœºæ™¯ 2: ç®€å•æ¡ä»¶åˆ†æ”¯ -->
        <div class="scene" id="scene2">
            <h2 class="scene-title">ç®€å•æ¡ä»¶åˆ†æ”¯</h2>

            <div class="branch-box">
                <h4>ğŸ¯ äºŒåˆ†æ”¯é€»è¾‘ï¼ˆif-elseï¼‰</h4>
                <p>æ ¹æ®åˆ†æ•°å†³å®šæ˜¯é€šè¿‡è¿˜æ˜¯å¤±è´¥</p>
            </div>

            <div class="canvas-container">
                <h3 style="text-align: center; color: #d946ef; margin-bottom: 30px; font-size: 1.5em;">if-else äºŒåˆ†æ”¯åŠ¨ç”»æ¼”ç¤º</h3>

                <!-- çŠ¶æ€æ˜¾ç¤ºé¢æ¿ -->
                <div class="state-display" id="branchStateDisplay" style="margin-bottom: 30px; display: none;">
                    <div style="color: #a78bfa; font-weight: bold; margin-bottom: 8px;">ğŸ“Š å½“å‰çŠ¶æ€</div>
                    <div id="branchStateContent" style="font-size: 1.3em; color: #60a5fa; font-weight: bold; font-family: monospace;">
                        { score: ? }
                    </div>
                </div>

                <!-- æ­¥éª¤æè¿° -->
                <div id="branchStepDesc" style="text-align: center; min-height: 100px; padding: 20px; background: rgba(217, 70, 239, 0.1); border-radius: 10px; margin-bottom: 30px; color: #e2e8f0; font-size: 1.1em; line-height: 1.6;">
                    ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤º if-else äºŒåˆ†æ”¯æµç¨‹
                </div>

                <!-- if-else å†³ç­–æ ‘å¯è§†åŒ– -->
                <div class="decision-tree" id="branchDecisionTree">
                    <!-- ç¬¬1å±‚: è¾“å…¥èŠ‚ç‚¹ -->
                    <div class="tree-level">
                        <div class="decision-node" id="branch-input-node">
                            <div class="icon">ğŸ“¥</div>
                            <h4>è¾“å…¥çŠ¶æ€</h4>
                            <p>{ score: ? }</p>
                        </div>
                    </div>

                    <!-- ç¬¬2å±‚: æ¡ä»¶åˆ¤æ–­èŠ‚ç‚¹ -->
                    <div class="tree-level">
                        <div class="decision-node condition" id="branch-condition-node">
                            <div class="icon">â“</div>
                            <h4>æ¡ä»¶åˆ¤æ–­</h4>
                            <p>score >= 60?</p>
                        </div>
                    </div>

                    <!-- ç¬¬3å±‚: ä¸¤ä¸ªåˆ†æ”¯ -->
                    <div class="tree-level">
                        <div class="decision-node" id="branch-true-node">
                            <div class="icon">âœ…</div>
                            <h4>True åˆ†æ”¯</h4>
                            <p>pass_node</p>
                            <div style="margin-top: 8px; font-size: 0.8em; color: #94a3b8;">é€šè¿‡èŠ‚ç‚¹</div>
                        </div>

                        <div class="decision-node" id="branch-false-node">
                            <div class="icon">âŒ</div>
                            <h4>False åˆ†æ”¯</h4>
                            <p>fail_node</p>
                            <div style="margin-top: 8px; font-size: 0.8em; color: #94a3b8;">å¤±è´¥èŠ‚ç‚¹</div>
                        </div>
                    </div>
                </div>

                <button class="demo-btn" id="runBranchBtn" onclick="runBranchDecision()">â–¶ï¸ æ’­æ”¾ if-else äºŒåˆ†æ”¯åŠ¨ç”»</button>
            </div>

            <div class="code-snippet">
                <span class="comment"># 1ï¸âƒ£ å®šä¹‰æ¡ä»¶å‡½æ•°ï¼šè¿”å›ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åç§°</span><br>
                <span class="keyword">def</span> <span class="function">route_condition</span>(state):<br>
                &nbsp;&nbsp;<span class="keyword">if</span> state[<span class="string">"score"</span>] >= 60:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span> <span class="string">"pass_node"</span>  <span class="comment"># å»å¾€é€šè¿‡èŠ‚ç‚¹</span><br>
                &nbsp;&nbsp;<span class="keyword">else</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span> <span class="string">"fail_node"</span>   <span class="comment"># å»å¾€å¤±è´¥èŠ‚ç‚¹</span><br><br>
                <span class="comment"># 2ï¸âƒ£ æ·»åŠ æ¡ä»¶è¾¹</span><br>
                graph.add_conditional_edges(<br>
                &nbsp;&nbsp;<span class="string">"grade"</span>,  <span class="comment"># æºèŠ‚ç‚¹</span><br>
                &nbsp;&nbsp;route_condition,  <span class="comment"># æ¡ä»¶å‡½æ•°</span><br>
                &nbsp;&nbsp;{  <span class="comment"># æ˜ å°„è¿”å›å€¼åˆ°èŠ‚ç‚¹</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"pass_node"</span>: <span class="string">"pass_node"</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"fail_node"</span>: <span class="string">"fail_node"</span><br>
                &nbsp;&nbsp;}<br>
                )
            </div>

            <div class="feature-grid" style="margin-top: 40px;">
                <div class="feature-card" data-delay="0">
                    <div class="feature-icon">ğŸ“Š</div>
                    <h4>å®šä¹‰çŠ¶æ€</h4>
                    <p>åŒ…å«ç”¨äºåˆ¤æ–­çš„å­—æ®µï¼ˆå¦‚ scoreï¼‰</p>
                </div>

                <div class="feature-card" data-delay="100">
                    <div class="feature-icon">ğŸ”</div>
                    <h4>æ¡ä»¶å‡½æ•°</h4>
                    <p>è¿”å›ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„åç§°</p>
                </div>

                <div class="feature-card" data-delay="200">
                    <div class="feature-icon">ğŸ”—</div>
                    <h4>æ·»åŠ æ¡ä»¶è¾¹</h4>
                    <p>ä½¿ç”¨ add_conditional_edges()</p>
                </div>
            </div>
        </div>

        <!-- åœºæ™¯ 3: å¤šåˆ†æ”¯æ¡ä»¶ -->
        <div class="scene" id="scene3">
            <h2 class="scene-title">å¤šåˆ†æ”¯æ¡ä»¶</h2>

            <div class="highlight-box" style="background: rgba(168, 85, 247, 0.15); border-left-color: #a855f7;">
                <h3 style="color: #a855f7;">ğŸ¯ å¤šè·¯å¾„é€‰æ‹©ï¼ˆswitch-caseï¼‰</h3>
                <p>
                    æ ¹æ®å¤©æ°”ç±»å‹é€‰æ‹©ä¸åŒçš„æ´»åŠ¨<br><br>
                    <strong>å…³é”®ç‚¹ï¼š</strong><br>
                    âœ… æ¡ä»¶å‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªå¯èƒ½çš„å€¼<br>
                    âœ… æ¯ä¸ªè¿”å›å€¼å¯¹åº”ä¸€ä¸ªåˆ†æ”¯<br>
                    âœ… ä½¿ç”¨ Literal ç±»å‹å¯ä»¥æ£€æŸ¥é”™è¯¯
                </p>
            </div>

            <div class="canvas-container">
                <h3 style="text-align: center; color: #a855f7; margin-bottom: 30px; font-size: 1.5em;">å¤©æ°”å†³ç­–æ ‘</h3>

                <!-- çŠ¶æ€æ˜¾ç¤ºé¢æ¿ -->
                <div class="state-display" id="weatherStateDisplay" style="margin-bottom: 30px; display: none;">
                    <div style="color: #a78bfa; font-weight: bold; margin-bottom: 8px;">ğŸ“Š å½“å‰çŠ¶æ€</div>
                    <div id="weatherStateContent" style="font-size: 1.3em; color: #60a5fa; font-weight: bold; font-family: monospace;">
                        { weather: ? }
                    </div>
                </div>

                <!-- æ­¥éª¤æè¿° -->
                <div id="weatherStepDesc" style="text-align: center; min-height: 80px; padding: 20px; background: rgba(168, 85, 247, 0.1); border-radius: 10px; margin-bottom: 30px; color: #e2e8f0; font-size: 1.1em; line-height: 1.6;">
                    ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºå¤©æ°”å†³ç­–æµç¨‹
                </div>

                <div class="decision-tree" id="weatherTree">
                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">ğŸŒ¤ï¸</div>
                            <h4>æ£€æŸ¥å¤©æ°”</h4>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node condition">
                            <div class="icon">â“</div>
                            <h4>å¤©æ°”ç±»å‹</h4>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">â˜€ï¸</div>
                            <h4>æ™´å¤©</h4>
                            <p>é‡é¤</p>
                        </div>

                        <div class="decision-node">
                            <div class="icon">ğŸŒ§ï¸</div>
                            <h4>é›¨å¤©</h4>
                            <p>çœ‹ç”µå½±</p>
                        </div>

                        <div class="decision-node">
                            <div class="icon">â˜ï¸</div>
                            <h4>å¤šäº‘</h4>
                            <p>è´­ç‰©</p>
                        </div>

                        <div class="decision-node">
                            <div class="icon">â„ï¸</div>
                            <h4>é›ªå¤©</h4>
                            <p>å †é›ªäºº</p>
                        </div>
                    </div>
                </div>

                <button class="demo-btn" id="runWeatherBtn" onclick="runWeatherDecision()">â–¶ï¸ æ’­æ”¾å¤©æ°”å†³ç­–åŠ¨ç”»</button>
            </div>

            <div class="code-snippet">
                <span class="comment"># å¤šåˆ†æ”¯æ¡ä»¶å‡½æ•°</span><br>
                <span class="keyword">def</span> <span class="function">route_by_weather</span>(state):<br>
                &nbsp;&nbsp;<span class="comment"># ç›´æ¥è¿”å›å¤©æ°”ç±»å‹</span><br>
                &nbsp;&nbsp;<span class="keyword">return</span> state[<span class="string">"weather"</span>]  <span class="comment"># "sunny" | "rainy" | "cloudy" | "snowy"</span><br><br>
                <span class="comment"># æ·»åŠ å¤šåˆ†æ”¯æ¡ä»¶è¾¹</span><br>
                graph.add_conditional_edges(<br>
                &nbsp;&nbsp;<span class="string">"check_weather"</span>,<br>
                &nbsp;&nbsp;route_by_weather,<br>
                &nbsp;&nbsp;{<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"sunny"</span>: <span class="string">"sunny"</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"rainy"</span>: <span class="string">"rainy"</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"cloudy"</span>: <span class="string">"cloudy"</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"snowy"</span>: <span class="string">"snowy"</span><br>
                &nbsp;&nbsp;}<br>
                )
            </div>
        </div>

        <!-- åœºæ™¯ 4: æ„å›¾è·¯ç”± -->
        <div class="scene" id="scene4">
            <h2 class="scene-title">åŸºäºæ„å›¾çš„æ¡ä»¶è·¯ç”±</h2>

            <div class="highlight-box" style="background: rgba(236, 72, 153, 0.15); border-left-color: #ec4899;">
                <h3 style="color: #ec4899;">ğŸ¤– AI åº”ç”¨åœºæ™¯ï¼šæ„å›¾è¯†åˆ«</h3>
                <p>
                    åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ¡ä»¶è¾¹å¸¸ç”¨äº<strong>æ„å›¾è¯†åˆ«å’Œè·¯ç”±</strong>ã€‚<br><br>
                    <strong>å…¸å‹æµç¨‹ï¼š</strong><br>
                    1ï¸âƒ£ ç”¨æˆ·è¾“å…¥æ¶ˆæ¯<br>
                    2ï¸âƒ£ åˆ†ç±»å™¨è¯†åˆ«æ„å›¾ï¼ˆå¤©æ°”/æ—¶é—´/è®¡ç®—/é€šç”¨ï¼‰<br>
                    3ï¸âƒ£ æ¡ä»¶è¾¹è·¯ç”±åˆ°å¯¹åº”çš„å¤„ç†å™¨<br>
                    4ï¸âƒ£ ä¸“é—¨çš„å¤„ç†å™¨ç”Ÿæˆå“åº”
                </p>
            </div>

            <div class="canvas-container">
                <h3 style="text-align: center; color: #ec4899; margin-bottom: 30px; font-size: 1.5em;">æ„å›¾è·¯ç”±æµç¨‹</h3>

                <!-- ç”¨æˆ·æ¶ˆæ¯æ˜¾ç¤º -->
                <div class="state-display" id="intentMessageDisplay" style="margin-bottom: 30px; display: none;">
                    <div style="color: #ec4899; font-weight: bold; margin-bottom: 8px;">ğŸ’¬ ç”¨æˆ·æ¶ˆæ¯</div>
                    <div id="intentMessageContent" style="font-size: 1.2em; color: #e2e8f0; font-style: italic; padding: 10px; background: rgba(236, 72, 153, 0.1); border-radius: 8px; border-left: 3px solid #ec4899;">
                        "?"
                    </div>
                </div>

                <!-- æ­¥éª¤æè¿° -->
                <div id="intentStepDesc" style="text-align: center; min-height: 80px; padding: 20px; background: rgba(236, 72, 153, 0.1); border-radius: 10px; margin-bottom: 30px; color: #e2e8f0; font-size: 1.1em; line-height: 1.6;">
                    ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºæ„å›¾è·¯ç”±æµç¨‹
                </div>

                <div class="decision-tree" id="intentTree">
                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">ğŸ’¬</div>
                            <h4>ç”¨æˆ·è¾“å…¥</h4>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">ğŸ”</div>
                            <h4>æ„å›¾åˆ†ç±»</h4>
                            <p>è¯†åˆ«ç”¨æˆ·éœ€æ±‚</p>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">ğŸŒ¤ï¸</div>
                            <h4>å¤©æ°”</h4>
                        </div>

                        <div class="decision-node">
                            <div class="icon">ğŸ•</div>
                            <h4>æ—¶é—´</h4>
                        </div>

                        <div class="decision-node">
                            <div class="icon">ğŸ”¢</div>
                            <h4>è®¡ç®—</h4>
                        </div>

                        <div class="decision-node">
                            <div class="icon">ğŸ’¬</div>
                            <h4>é€šç”¨</h4>
                        </div>
                    </div>
                </div>

                <button class="demo-btn" id="runIntentBtn" onclick="runIntentDecision()">â–¶ï¸ æ’­æ”¾æ„å›¾è·¯ç”±åŠ¨ç”»</button>
            </div>

            <div class="code-snippet">
                <span class="comment"># æ„å›¾åˆ†ç±»å‡½æ•°</span><br>
                <span class="keyword">def</span> <span class="function">classify_intent</span>(state):<br>
                &nbsp;&nbsp;user_input = state[<span class="string">"messages"</span>][-1].lower()<br><br>
                &nbsp;&nbsp;<span class="keyword">if</span> <span class="string">"å¤©æ°”"</span> <span class="keyword">in</span> user_input:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span> <span class="string">"weather"</span><br>
                &nbsp;&nbsp;<span class="keyword">elif</span> <span class="string">"æ—¶é—´"</span> <span class="keyword">in</span> user_input:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span> <span class="string">"time"</span><br>
                &nbsp;&nbsp;<span class="keyword">elif</span> <span class="string">"è®¡ç®—"</span> <span class="keyword">in</span> user_input:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span> <span class="string">"calculator"</span><br>
                &nbsp;&nbsp;<span class="keyword">else</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span> <span class="string">"general"</span>
            </div>
        </div>

        <!-- åœºæ™¯ 5: å¤šçº§å†³ç­–æ ‘ -->
        <div class="scene" id="scene5">
            <h2 class="scene-title">å¤šçº§å†³ç­–æ ‘</h2>

            <div class="highlight-box" style="background: rgba(139, 92, 246, 0.15); border-left-color: #8b5cf6;">
                <h3 style="color: #8b5cf6;">ğŸŒ² å¤æ‚åœºæ™¯ï¼šçº§è”æ¡ä»¶åˆ¤æ–­</h3>
                <p>
                    å¤šä¸ªæ¡ä»¶è¾¹å¯ä»¥<strong>çº§è”</strong>ä½¿ç”¨ï¼Œå½¢æˆå¤æ‚çš„å†³ç­–æ ‘ã€‚<br><br>
                    <strong>å®é™…åº”ç”¨ï¼šå®¢æˆ·æœåŠ¡è·¯ç”±</strong><br>
                    ç¬¬ä¸€å±‚ï¼šå®¢æˆ·ç±»å‹ï¼ˆVIP/æ™®é€šï¼‰<br>
                    ç¬¬äºŒå±‚ï¼šé—®é¢˜ç±»å‹ï¼ˆæŠ€æœ¯/è´¦å•/é€šç”¨ï¼‰<br>
                    ç¬¬ä¸‰å±‚ï¼šä¼˜å…ˆçº§ï¼ˆç´§æ€¥/é«˜/æ­£å¸¸ï¼‰<br>
                    â†’ æœ€ç»ˆè·¯ç”±åˆ°åˆé€‚çš„å¤„ç†å›¢é˜Ÿ
                </p>
            </div>

            <div class="canvas-container">
                <h3 style="text-align: center; color: #8b5cf6; margin-bottom: 30px; font-size: 1.5em;">å®¢æˆ·æœåŠ¡å†³ç­–æ ‘</h3>

                <!-- çŠ¶æ€æ˜¾ç¤ºé¢æ¿ -->
                <div class="state-display" id="serviceStateDisplay" style="margin-bottom: 30px; display: none;">
                    <div style="color: #a78bfa; font-weight: bold; margin-bottom: 8px;">ğŸ“Š å½“å‰çŠ¶æ€</div>
                    <div id="serviceStateContent" style="font-size: 1.1em; color: #60a5fa; font-weight: bold; font-family: monospace;">
                        { customer_type: ?, issue_type: ? }
                    </div>
                </div>

                <!-- æ­¥éª¤æè¿° -->
                <div id="serviceStepDesc" style="text-align: center; min-height: 80px; padding: 20px; background: rgba(139, 92, 246, 0.1); border-radius: 10px; margin-bottom: 30px; color: #e2e8f0; font-size: 1.1em; line-height: 1.6;">
                    ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºå¤šçº§å†³ç­–æµç¨‹
                </div>

                <div class="decision-tree" id="serviceTree" style="font-size: 0.9em;">
                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">ğŸ‘¤</div>
                            <h4>å®¢æˆ·åˆ†ç±»</h4>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">â­</div>
                            <h4>VIPå®¢æˆ·</h4>
                        </div>

                        <div class="decision-node">
                            <div class="icon">ğŸ‘¥</div>
                            <h4>æ™®é€šå®¢æˆ·</h4>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node condition">
                            <div class="icon">â“</div>
                            <h4>é—®é¢˜ç±»å‹</h4>
                        </div>

                        <div class="decision-node condition">
                            <div class="icon">â“</div>
                            <h4>é—®é¢˜ç±»å‹</h4>
                        </div>
                    </div>

                    <div class="tree-level">
                        <div class="decision-node">
                            <div class="icon">ğŸ’</div>
                            <h4>VIPå›¢é˜Ÿ</h4>
                        </div>

                        <div class="decision-node">
                            <div class="icon">ğŸ‘¥</div>
                            <h4>æ™®é€šå›¢é˜Ÿ</h4>
                        </div>
                    </div>
                </div>

                <button class="demo-btn" id="runServiceBtn" onclick="runServiceDecision()">â–¶ï¸ æ’­æ”¾å®¢æˆ·æœåŠ¡è·¯ç”±åŠ¨ç”»</button>
            </div>
        </div>

        <!-- åœºæ™¯ 6: æ€»ç»“ -->
        <div class="scene" id="scene6">
            <h2 class="scene-title">æ¡ä»¶è¾¹ä½¿ç”¨æ¨¡å¼</h2>

            <div class="feature-grid">
                <div class="feature-card" data-delay="0">
                    <div class="feature-icon">ğŸ”€</div>
                    <h4>ç®€å•äºŒåˆ†æ”¯</h4>
                    <p>if-else é€»è¾‘ï¼Œæ ¹æ®æ¡ä»¶é€‰æ‹©ä¸¤ä¸ªè·¯å¾„ä¹‹ä¸€</p>
                </div>

                <div class="feature-card" data-delay="100">
                    <div class="feature-icon">ğŸ”€</div>
                    <h4>å¤šåˆ†æ”¯</h4>
                    <p>switch-case é€»è¾‘ï¼Œåœ¨å¤šä¸ªè·¯å¾„ä¸­é€‰æ‹©</p>
                </div>

                <div class="feature-card" data-delay="200">
                    <div class="feature-icon">ğŸŒ²</div>
                    <h4>çº§è”æ¡ä»¶</h4>
                    <p>å¤šå±‚å†³ç­–æ ‘ï¼Œé€æ­¥ç»†åŒ–åˆ¤æ–­</p>
                </div>

                <div class="feature-card" data-delay="300">
                    <div class="feature-icon">ğŸ¤–</div>
                    <h4>åŸºäºæ¨¡å‹è¾“å‡º</h4>
                    <p>LLM åˆ†ç±»ç»“æœå†³å®šè·¯ç”±</p>
                </div>
            </div>

            <div class="highlight-box" style="background: rgba(34, 197, 94, 0.15); border-left-color: #22c55e;">
                <h3 style="color: #22c55e;">ğŸ¯ æœ€ä½³å®è·µ</h3>
                <p>
                    âœ… <strong>æ¡ä»¶å‡½æ•°è¦ç®€å•æ˜ç¡®</strong> - é¿å…å¤æ‚é€»è¾‘<br>
                    âœ… <strong>ä½¿ç”¨ Literal ç±»å‹æ³¨è§£</strong> - å¯ä»¥æ£€æŸ¥é”™è¯¯<br>
                    âœ… <strong>ç¡®ä¿æ¯ä¸ªè¿”å›å€¼éƒ½æœ‰å¯¹åº”èŠ‚ç‚¹</strong> - é¿å…è·¯å¾„ç¼ºå¤±<br>
                    âœ… <strong>è€ƒè™‘æ·»åŠ é»˜è®¤åˆ†æ”¯</strong> - å¤„ç†æœªçŸ¥æƒ…å†µ<br>
                    âœ… <strong>æ¡ä»¶å‡½æ•°å‘½åæ¸…æ™°</strong> - å¦‚ route_by_xxx
                </p>
            </div>

            <div class="highlight-box">
                <h3>ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ </h3>
                <p>
                    æ­å–œä½ æŒæ¡äº† LangGraph çš„æ¡ä»¶è¾¹ï¼<br><br>
                    ğŸ“š <strong>å»ºè®®å®è·µï¼š</strong><br>
                    1. åˆ›å»ºä¸€ä¸ªç®€å•çš„äºŒåˆ†æ”¯æ¡ä»¶è¾¹<br>
                    2. å®ç°å¤šåˆ†æ”¯çš„æ¡ä»¶è·¯ç”±<br>
                    3. å°è¯•æ„å»ºå¤šçº§å†³ç­–æ ‘<br><br>
                    ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†æ·±å…¥å­¦ä¹  <strong>LangGraph çš„é«˜çº§ç‰¹æ€§</strong>ï¼Œ<br>
                    åŒ…æ‹¬å¾ªç¯ã€å¹¶è¡Œæ‰§è¡Œå’Œäººå·¥å¹²é¢„ç­‰ï¼
                </p>
            </div>
        </div>

        <!-- åœºæ™¯æŒ‡ç¤ºå™¨ -->
        <div class="scene-indicators">
            <div class="indicator active" data-scene="1"></div>
            <div class="indicator" data-scene="2"></div>
            <div class="indicator" data-scene="3"></div>
            <div class="indicator" data-scene="4"></div>
            <div class="indicator" data-scene="5"></div>
            <div class="indicator" data-scene="6"></div>
        </div>

        <!-- å¯¼èˆªæŒ‰é’® -->
        <div class="nav-buttons">
            <button class="nav-btn" id="prevBtn" disabled>
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
                ä¸Šä¸€èŠ‚
            </button>
            <a href="../langchain/index.html" class="nav-btn back-to-list">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/>
                </svg>
                è¯¾ç¨‹åˆ—è¡¨
            </a>
            <button class="nav-btn next" id="nextBtn">
                ä¸‹ä¸€èŠ‚
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // åœºæ™¯æ•°æ®
        const totalScenes = 6;
        let currentScene = 1;

        // DOM å…ƒç´ 
        const progressBar = document.getElementById('progressBar');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const indicators = document.querySelectorAll('.indicator');

        // åˆå§‹åŒ–
        function init() {
            setupEventListeners();
            updateScene();
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬
        function setupEventListeners() {
            // å¯¼èˆªæŒ‰é’®
            prevBtn.addEventListener('click', () => {
                if (currentScene > 1) {
                    currentScene--;
                    updateScene();
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentScene < totalScenes) {
                    currentScene++;
                    updateScene();
                }
            });

            // æŒ‡ç¤ºå™¨
            indicators.forEach(indicator => {
                indicator.addEventListener('click', () => {
                    currentScene = parseInt(indicator.dataset.scene);
                    updateScene();
                });
            });

            // é”®ç›˜å¯¼èˆª
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight' && currentScene < totalScenes) {
                    currentScene++;
                    updateScene();
                } else if (e.key === 'ArrowLeft' && currentScene > 1) {
                    currentScene--;
                    updateScene();
                }
            });
        }

        // æ›´æ–°åœºæ™¯
        function updateScene() {
            // æ›´æ–°è¿›åº¦æ¡
            const progress = ((currentScene - 1) / (totalScenes - 1)) * 100;
            progressBar.style.width = progress + '%';

            // æ›´æ–°åœºæ™¯æ˜¾ç¤º
            document.querySelectorAll('.scene').forEach((scene, index) => {
                if (index + 1 === currentScene) {
                    scene.classList.add('active');
                } else {
                    scene.classList.remove('active');
                }
            });

            // æ›´æ–°æŒ‡ç¤ºå™¨
            indicators.forEach((indicator, index) => {
                if (index + 1 === currentScene) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            prevBtn.disabled = currentScene === 1;
            nextBtn.disabled = currentScene === totalScenes;

            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // é‡ç½®æ‰€æœ‰åŠ¨ç”»å…ƒç´ 
            document.querySelectorAll('.feature-card, .decision-node').forEach(el => {
                el.classList.remove('visible');
            });

            // åŠ¨ç”»æ˜¾ç¤ºå…ƒç´ 
            setTimeout(() => {
                animateSceneElements();
            }, 100);
        }

        // åŠ¨ç”»æ˜¾ç¤ºåœºæ™¯å…ƒç´ 
        function animateSceneElements() {
            const currentSceneEl = document.querySelector(`#scene${currentScene}`);

            // ç‰¹æ€§å¡ç‰‡åŠ¨ç”»
            currentSceneEl.querySelectorAll('.feature-card').forEach((card, index) => {
                const delay = parseInt(card.dataset.delay) || index * 100;
                setTimeout(() => {
                    card.classList.add('visible');
                }, delay);
            });

            // å†³ç­–èŠ‚ç‚¹åŠ¨ç”»
            currentSceneEl.querySelectorAll('.decision-node').forEach((node, index) => {
                const delay = parseInt(node.dataset.delay) || index * 200;
                setTimeout(() => {
                    node.classList.add('visible');
                }, delay);
            });
        }

        // åœºæ™¯ 2: if-else äºŒåˆ†æ”¯é€»è¾‘åŠ¨ç”»
        async function runBranchDecision() {
            const btn = document.getElementById('runBranchBtn');
            const stateDisplay = document.getElementById('branchStateDisplay');
            const stateContent = document.getElementById('branchStateContent');
            const stepDesc = document.getElementById('branchStepDesc');

            btn.disabled = true;
            btn.textContent = 'â³ æ¼”ç¤ºä¸­...';

            // æ˜¾ç¤ºçŠ¶æ€é¢æ¿
            stateDisplay.style.display = 'block';

            // é‡ç½®æ‰€æœ‰èŠ‚ç‚¹
            const inputNode = document.getElementById('branch-input-node');
            const conditionNode = document.getElementById('branch-condition-node');
            const trueNode = document.getElementById('branch-true-node');
            const falseNode = document.getElementById('branch-false-node');

            [inputNode, conditionNode, trueNode, falseNode].forEach(node => {
                node.classList.remove('visible', 'active');
                node.style.borderColor = '';
                node.style.background = '';
            });

            stateContent.textContent = '{ score: ? }';
            await new Promise(resolve => setTimeout(resolve, 500));

            // ç”Ÿæˆéšæœºåˆ†æ•° (æ›´æ¥è¿‘60,å¢åŠ æ‚¬å¿µ)
            const score = Math.floor(Math.random() * 60) + 30; // 30-89ä¹‹é—´
            const isPass = score >= 60;

            // ç¬¬1æ­¥: åˆå§‹åŒ–çŠ¶æ€
            stepDesc.innerHTML = '<strong>æ­¥éª¤ 1/5ï¼š</strong>ğŸ“¥ <strong style="color: #d946ef;">åˆå§‹åŒ–çŠ¶æ€</strong> - ç³»ç»Ÿç”Ÿæˆä¸€ä¸ªéšæœºåˆ†æ•°';
            inputNode.classList.add('visible', 'active');
            inputNode.querySelector('p').textContent = `{ score: ${score} }`;
            animateStateUpdate(stateContent, `{ score: ${score} }`);
            await new Promise(resolve => setTimeout(resolve, 1500));
            inputNode.classList.remove('active');

            // ç¬¬2æ­¥: æ¡ä»¶å‡½æ•°æ¥æ”¶çŠ¶æ€
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 2/5ï¼š</strong>ğŸ”„ <strong style="color: #d946ef;">æ¡ä»¶å‡½æ•°æ¥æ”¶çŠ¶æ€</strong><br>route_condition(state) è¢«è°ƒç”¨ï¼Œè¯»å– score å€¼: <span style="color: #60a5fa; font-family: monospace; font-weight: bold;">${score}</span>`;
            conditionNode.classList.add('visible', 'active');
            conditionNode.querySelector('p').innerHTML = `æ£€æŸ¥: <span style="color: #60a5fa;">${score}</span> >= 60?`;
            await new Promise(resolve => setTimeout(resolve, 1800));
            conditionNode.classList.remove('active');

            // ç¬¬3æ­¥: æ‰§è¡Œæ¡ä»¶åˆ¤æ–­
            const result = isPass ? 'True' : 'False';
            const resultColor = isPass ? '#22c55e' : '#ef4444';
            const resultEmoji = isPass ? 'âœ…' : 'âŒ';

            stepDesc.innerHTML = `<strong>æ­¥éª¤ 3/5ï¼š</strong>ğŸ” <strong style="color: #d946ef;">æ‰§è¡Œæ¡ä»¶åˆ¤æ–­</strong><br>if ${score} >= 60: â†’ ç»“æœ = <span style="color: ${resultColor}; font-size: 1.3em; font-weight: bold;">${result}</span>`;
            conditionNode.classList.add('active');
            conditionNode.style.borderColor = resultColor;
            conditionNode.style.background = isPass ? 'rgba(34, 197, 94, 0.3)' : 'rgba(239, 68, 68, 0.3)';
            conditionNode.querySelector('p').innerHTML = `${resultEmoji} <strong style="color: ${resultColor};">${result}</strong>`;
            await new Promise(resolve => setTimeout(resolve, 1800));
            conditionNode.classList.remove('active');

            // ç¬¬4æ­¥: æ ¹æ®ç»“æœé€‰æ‹©åˆ†æ”¯
            if (isPass) {
                // True åˆ†æ”¯
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 4/5ï¼š</strong>âœ… <strong style="color: #22c55e;">æ¡ä»¶ä¸º Trueï¼Œè¿›å…¥ if åˆ†æ”¯</strong><br>return "pass_node" â†’ è·¯ç”±åˆ° <strong style="color: #22c55e;">pass_node</strong>`;
                trueNode.classList.add('visible', 'active');
                trueNode.style.borderColor = '#22c55e';
                trueNode.style.background = 'rgba(34, 197, 94, 0.3)';

                // é«˜äº®æ˜¾ç¤ºfalseèŠ‚ç‚¹ä½†ä¸æ¿€æ´»(å±•ç¤ºå¯¹æ¯”)
                falseNode.classList.add('visible');
                falseNode.style.opacity = '0.3';

                await new Promise(resolve => setTimeout(resolve, 1800));
                trueNode.classList.remove('active');
            } else {
                // False åˆ†æ”¯
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 4/5ï¼š</strong>âŒ <strong style="color: #ef4444;">æ¡ä»¶ä¸º Falseï¼Œè¿›å…¥ else åˆ†æ”¯</strong><br>return "fail_node" â†’ è·¯ç”±åˆ° <strong style="color: #ef4444;">fail_node</strong>`;
                falseNode.classList.add('visible', 'active');
                falseNode.style.borderColor = '#ef4444';
                falseNode.style.background = 'rgba(239, 68, 68, 0.3)';

                // é«˜äº®æ˜¾ç¤ºtrueèŠ‚ç‚¹ä½†ä¸æ¿€æ´»(å±•ç¤ºå¯¹æ¯”)
                trueNode.classList.add('visible');
                trueNode.style.opacity = '0.3';

                await new Promise(resolve => setTimeout(resolve, 1800));
                falseNode.classList.remove('active');
            }

            // ç¬¬5æ­¥: æœ€ç»ˆæ€»ç»“
            const nodeName = isPass ? 'pass_node (é€šè¿‡èŠ‚ç‚¹)' : 'fail_node (å¤±è´¥èŠ‚ç‚¹)';
            const explanation = isPass
                ? 'âœ“ å› ä¸º <code>score >= 60</code> ä¸º Trueï¼Œæ‰€ä»¥æ‰§è¡Œ <strong>if</strong> åˆ†æ”¯'
                : 'âœ— å› ä¸º <code>score >= 60</code> ä¸º Falseï¼Œæ‰€ä»¥æ‰§è¡Œ <strong>else</strong> åˆ†æ”¯';

            stepDesc.innerHTML = `
                <strong>æ­¥éª¤ 5/5ï¼š</strong>ğŸ‰ <strong style="color: #22c55e;">å®Œæˆï¼äºŒåˆ†æ”¯é€»è¾‘æ¼”ç¤º</strong><br><br>
                <div style="text-align: left; max-width: 600px; margin: 0 auto; line-height: 1.8;">
                    ğŸ“Š <strong>çŠ¶æ€å€¼ï¼š</strong><code style="color: #60a5fa;">{ score: ${score} }</code><br>
                    ğŸ” <strong>æ¡ä»¶åˆ¤æ–­ï¼š</strong><code>if ${score} >= 60</code><br>
                    ${explanation}<br>
                    ğŸ¯ <strong>æœ€ç»ˆè·¯ç”±åˆ°ï¼š</strong><span style="color: ${resultColor}; font-weight: bold;">${nodeName}</span>
                </div>
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); color: #94a3b8; font-size: 0.95em;">
                    ğŸ’¡ <strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>æ¡ä»¶è¾¹æ ¹æ®çŠ¶æ€è‡ªåŠ¨é€‰æ‹©è·¯å¾„ï¼Œå®ç° if-else é€»è¾‘ï¼
                </div>
            `;

            // æ¢å¤æŒ‰é’®
            await new Promise(resolve => setTimeout(resolve, 500));
            btn.disabled = false;
            btn.textContent = 'ğŸ”„ é‡æ–°æ¼”ç¤º if-else';
        }

        // åœºæ™¯ 1: ç®€å•å†³ç­–æ ‘
        async function runSimpleDecision() {
            const btn = document.getElementById('runDecisionBtn');
            const stateDisplay = document.getElementById('simpleStateDisplay');
            const stateContent = document.getElementById('simpleStateContent');
            const stepDesc = document.getElementById('simpleStepDesc');

            btn.disabled = true;
            btn.textContent = 'â³ æ¼”ç¤ºä¸­...';

            // æ˜¾ç¤ºçŠ¶æ€é¢æ¿
            stateDisplay.style.display = 'block';

            // é‡ç½®
            document.querySelectorAll('#simpleDecisionTree .decision-node').forEach(el => {
                el.classList.remove('visible', 'active');
                el.style.borderColor = '';
                el.style.background = '';
                // é‡ç½®èŠ‚ç‚¹æ–‡æœ¬
                if (el.querySelector('p')) {
                    const originalText = el.querySelector('p').getAttribute('data-original-text');
                    if (originalText) {
                        el.querySelector('p').textContent = originalText;
                    }
                }
            });

            stateContent.textContent = '{ score: ? }';
            await new Promise(resolve => setTimeout(resolve, 500));

            // ç”Ÿæˆéšæœºåˆ†æ•°
            const score = Math.floor(Math.random() * 100) + 1;
            const isPass = score >= 60;

            // è·å–èŠ‚ç‚¹
            const nodes = document.querySelectorAll('#simpleDecisionTree .decision-node');
            const conditionNode = nodes[0]; // æ¡ä»¶èŠ‚ç‚¹
            const judgeNode = nodes[1]; // åˆ¤æ–­èŠ‚ç‚¹
            const passNode = nodes[2]; // é€šè¿‡èŠ‚ç‚¹
            const failNode = nodes[3]; // å¤±è´¥èŠ‚ç‚¹

            // ä¿å­˜åŸå§‹æ–‡æœ¬
            if (!conditionNode.querySelector('p').getAttribute('data-original-text')) {
                conditionNode.querySelector('p').setAttribute('data-original-text', conditionNode.querySelector('p').textContent);
            }

            // ç¬¬1æ­¥ï¼šåˆå§‹åŒ–çŠ¶æ€
            stepDesc.innerHTML = '<strong>æ­¥éª¤ 1ï¼š</strong>ğŸ“¥ åˆå§‹åŒ–çŠ¶æ€ - ç³»ç»Ÿç”Ÿæˆä¸€ä¸ªéšæœºåˆ†æ•°';
            animateStateUpdate(stateContent, `{ score: ${score} }`);
            await new Promise(resolve => setTimeout(resolve, 1200));

            // ç¬¬2æ­¥ï¼šæ¡ä»¶èŠ‚ç‚¹å¤„ç†
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 2ï¼š</strong>ğŸ”„ æ¡ä»¶èŠ‚ç‚¹æ‰§è¡Œ - è¯»å–çŠ¶æ€ä¸­çš„åˆ†æ•°å€¼ï¼š<strong style="color: #60a5fa;">${score}</strong>`;
            conditionNode.classList.add('visible', 'active');
            conditionNode.querySelector('p').textContent = `åˆ†æ•°: ${score}`;
            await new Promise(resolve => setTimeout(resolve, 1500));
            conditionNode.classList.remove('active');

            // ç¬¬3æ­¥ï¼šæ¡ä»¶åˆ¤æ–­
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 3ï¼š</strong>ğŸ” æ¡ä»¶åˆ¤æ–­ - æ£€æŸ¥æ¡ä»¶ï¼š<span style="color: #fbbf24; font-family: monospace;">${score} >= 60</span>`;
            judgeNode.classList.add('visible', 'active');
            judgeNode.querySelector('p').textContent = `${score} >= 60?`;
            await new Promise(resolve => setTimeout(resolve, 1500));
            judgeNode.classList.remove('active');

            // ç¬¬4æ­¥ï¼šæ ¹æ®åˆ†æ•°é€‰æ‹©è·¯å¾„
            if (isPass) {
                // é€šè¿‡è·¯å¾„
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 4ï¼š</strong>âœ… æ¡ä»¶æ»¡è¶³ - <span style="color: #22c55e;">${score} >= 60</span>ï¼Œè·¯ç”±åˆ°<strong style="color: #22c55e;">é€šè¿‡èŠ‚ç‚¹</strong>`;
                passNode.classList.add('visible', 'active');
                passNode.querySelector('p').textContent = `âœ“ ${score} >= 60`;
                passNode.style.borderColor = '#22c55e';
                passNode.style.background = 'rgba(34, 197, 94, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1500));
                passNode.classList.remove('active');

                // æœ€ç»ˆæ€»ç»“
                stepDesc.innerHTML = `
                    <strong>å®Œæˆï¼</strong> ğŸ‰<br>
                    æ¡ä»¶è¾¹æ ¹æ®çŠ¶æ€ <span style="color: #60a5fa; font-family: monospace;">{ score: ${score} }</span> è‡ªåŠ¨é€‰æ‹©äº†<strong style="color: #22c55e;">é€šè¿‡</strong>è·¯å¾„<br>
                    <span style="color: #94a3b8; font-size: 0.9em;">è¿™å°±æ˜¯æ¡ä»¶è¾¹çš„æ ¸å¿ƒï¼šæ ¹æ®çŠ¶æ€åŠ¨æ€å†³å®šä¸‹ä¸€æ­¥ï¼</span>
                `;
            } else {
                // å¤±è´¥è·¯å¾„
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 4ï¼š</strong>âŒ æ¡ä»¶ä¸æ»¡è¶³ - <span style="color: #ef4444;">${score} < 60</span>ï¼Œè·¯ç”±åˆ°<strong style="color: #ef4444;">å¤±è´¥èŠ‚ç‚¹</strong>`;
                failNode.classList.add('visible', 'active');
                failNode.querySelector('p').textContent = `âœ— ${score} < 60`;
                failNode.style.borderColor = '#ef4444';
                failNode.style.background = 'rgba(239, 68, 68, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1500));
                failNode.classList.remove('active');

                // æœ€ç»ˆæ€»ç»“
                stepDesc.innerHTML = `
                    <strong>å®Œæˆï¼</strong> ğŸ‰<br>
                    æ¡ä»¶è¾¹æ ¹æ®çŠ¶æ€ <span style="color: #60a5fa; font-family: monospace;">{ score: ${score} }</span> è‡ªåŠ¨é€‰æ‹©äº†<strong style="color: #ef4444;">å¤±è´¥</strong>è·¯å¾„<br>
                    <span style="color: #94a3b8; font-size: 0.9em;">è¿™å°±æ˜¯æ¡ä»¶è¾¹çš„æ ¸å¿ƒï¼šæ ¹æ®çŠ¶æ€åŠ¨æ€å†³å®šä¸‹ä¸€æ­¥ï¼</span>
                `;
            }

            btn.disabled = false;
            btn.textContent = 'ğŸ”„ é‡æ–°æ¼”ç¤º';
        }

        // çŠ¶æ€æ›´æ–°åŠ¨ç”»å‡½æ•°
        function animateStateUpdate(element, newValue) {
            element.style.transform = 'scale(1.15)';
            element.style.color = '#22c55e';
            element.style.transition = 'all 0.15s ease-out';

            setTimeout(() => {
                element.textContent = newValue;
                element.style.transform = 'scale(1)';
                element.style.color = '#60a5fa';
            }, 150);
        }

        // åœºæ™¯ 3: å¤©æ°”å†³ç­–æ ‘
        async function runWeatherDecision() {
            const btn = document.getElementById('runWeatherBtn');
            const stateDisplay = document.getElementById('weatherStateDisplay');
            const stateContent = document.getElementById('weatherStateContent');
            const stepDesc = document.getElementById('weatherStepDesc');

            btn.disabled = true;
            btn.textContent = 'â³ æ¼”ç¤ºä¸­...';

            // æ˜¾ç¤ºçŠ¶æ€é¢æ¿
            stateDisplay.style.display = 'block';

            // é‡ç½®
            document.querySelectorAll('#weatherTree .decision-node').forEach(el => {
                el.classList.remove('visible', 'active');
                el.style.borderColor = '';
                el.style.background = '';
            });

            stateContent.textContent = '{ weather: ? }';
            await new Promise(resolve => setTimeout(resolve, 500));

            // å¤©æ°”ç±»å‹
            const weatherTypes = [
                { name: 'sunny', label: 'æ™´å¤©', icon: 'â˜€ï¸', activity: 'é‡é¤' },
                { name: 'rainy', label: 'é›¨å¤©', icon: 'ğŸŒ§ï¸', activity: 'çœ‹ç”µå½±' },
                { name: 'cloudy', label: 'å¤šäº‘', icon: 'â˜ï¸', activity: 'è´­ç‰©' },
                { name: 'snowy', label: 'é›ªå¤©', icon: 'â„ï¸', activity: 'å †é›ªäºº' }
            ];

            // éšæœºé€‰æ‹©ä¸€ç§å¤©æ°”
            const selectedWeather = weatherTypes[Math.floor(Math.random() * weatherTypes.length)];

            // è·å–èŠ‚ç‚¹
            const nodes = document.querySelectorAll('#weatherTree .decision-node');
            const checkNode = nodes[0]; // æ£€æŸ¥å¤©æ°”
            const judgeNode = nodes[1]; // å¤©æ°”ç±»å‹
            const weatherNodes = Array.from(nodes).slice(2); // å››ç§å¤©æ°”èŠ‚ç‚¹

            // ç¬¬1æ­¥ï¼šåˆå§‹åŒ–çŠ¶æ€
            stepDesc.innerHTML = '<strong>æ­¥éª¤ 1ï¼š</strong>ğŸ“¥ åˆå§‹åŒ–çŠ¶æ€ - ç³»ç»Ÿéšæœºé€‰æ‹©ä¸€ç§å¤©æ°”';
            animateStateUpdate(stateContent, `{ weather: "${selectedWeather.name}" }`);
            await new Promise(resolve => setTimeout(resolve, 1200));

            // ç¬¬2æ­¥ï¼šæ£€æŸ¥å¤©æ°”èŠ‚ç‚¹
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 2ï¼š</strong>ğŸŒ¤ï¸ æ£€æŸ¥å¤©æ°”èŠ‚ç‚¹ - è¯»å–çŠ¶æ€ï¼š<span style="color: #a855f7;">${selectedWeather.icon} ${selectedWeather.label}</span>`;
            checkNode.classList.add('visible', 'active');
            await new Promise(resolve => setTimeout(resolve, 1200));
            checkNode.classList.remove('active');

            // ç¬¬3æ­¥ï¼šæ¡ä»¶åˆ¤æ–­
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 3ï¼š</strong>ğŸ” æ¡ä»¶åˆ¤æ–­ - æ£€æŸ¥å¤©æ°”ç±»å‹ï¼š<span style="color: #fbbf24; font-family: monospace;">"${selectedWeather.name}"</span>`;
            judgeNode.classList.add('visible', 'active');
            judgeNode.querySelector('h4').textContent = `${selectedWeather.icon} ${selectedWeather.label}`;
            await new Promise(resolve => setTimeout(resolve, 1200));
            judgeNode.classList.remove('active');

            // ç¬¬4æ­¥ï¼šæ˜¾ç¤ºæ‰€æœ‰å¤©æ°”èŠ‚ç‚¹ï¼ˆå…ˆå…¨éƒ¨æ˜¾ç¤ºï¼‰
            weatherNodes.forEach(node => {
                node.classList.add('visible');
            });
            await new Promise(resolve => setTimeout(resolve, 500));

            // ç¬¬5æ­¥ï¼šè·¯ç”±åˆ°åŒ¹é…çš„èŠ‚ç‚¹
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 4ï¼š</strong>âœ… è·¯ç”±åŒ¹é… - å¤©æ°”ç±»å‹ <span style="color: #a855f7;">"${selectedWeather.name}"</span> å¯¹åº”<strong style="color: #22c55e;">${selectedWeather.icon} ${selectedWeather.label}</strong>èŠ‚ç‚¹`;
            const selectedNode = weatherNodes.find(node =>
                node.querySelector('h4').textContent === selectedWeather.label
            );

            if (selectedNode) {
                selectedNode.classList.add('active');
                selectedNode.style.borderColor = '#22c55e';
                selectedNode.style.background = 'rgba(34, 197, 94, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1500));
                selectedNode.classList.remove('active');
            }

            // æœ€ç»ˆæ€»ç»“
            stepDesc.innerHTML = `
                <strong>å®Œæˆï¼</strong> ğŸ‰<br>
                æ¡ä»¶è¾¹æ ¹æ®çŠ¶æ€ <span style="color: #60a5fa; font-family: monospace;">{ weather: "${selectedWeather.name}" }</span> è‡ªåŠ¨è·¯ç”±åˆ°<strong style="color: #22c55e;">${selectedWeather.icon} ${selectedWeather.label}</strong>èŠ‚ç‚¹<br>
                <span style="color: #94a3b8; font-size: 0.9em;">å¤šåˆ†æ”¯æ¡ä»¶å°±åƒ switch-caseï¼Œæ ¹æ®çŠ¶æ€å€¼é€‰æ‹©å¯¹åº”çš„è·¯å¾„ï¼</span>
            `;

            btn.disabled = false;
            btn.textContent = 'ğŸ”„ é‡æ–°æ¼”ç¤º';
        }

        // åœºæ™¯ 4: æ„å›¾è·¯ç”±
        async function runIntentDecision() {
            const btn = document.getElementById('runIntentBtn');
            const messageDisplay = document.getElementById('intentMessageDisplay');
            const messageContent = document.getElementById('intentMessageContent');
            const stepDesc = document.getElementById('intentStepDesc');

            btn.disabled = true;
            btn.textContent = 'â³ æ¼”ç¤ºä¸­...';

            // æ˜¾ç¤ºæ¶ˆæ¯é¢æ¿
            messageDisplay.style.display = 'block';

            // é‡ç½®
            document.querySelectorAll('#intentTree .decision-node').forEach(el => {
                el.classList.remove('visible', 'active');
                el.style.borderColor = '';
                el.style.background = '';
            });

            messageContent.textContent = '?';
            await new Promise(resolve => setTimeout(resolve, 500));

            // æ„å›¾ç±»å‹
            const intents = [
                { name: 'weather', label: 'å¤©æ°”', icon: 'ğŸŒ¤ï¸', example: 'ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ' },
                { name: 'time', label: 'æ—¶é—´', icon: 'ğŸ•', example: 'ç°åœ¨å‡ ç‚¹äº†ï¼Ÿ' },
                { name: 'calculator', label: 'è®¡ç®—', icon: 'ğŸ”¢', example: 'è®¡ç®— 2+2' },
                { name: 'general', label: 'é€šç”¨', icon: 'ğŸ’¬', example: 'ä½ å¥½' }
            ];

            // éšæœºé€‰æ‹©ä¸€ä¸ªæ„å›¾
            const selectedIntent = intents[Math.floor(Math.random() * intents.length)];

            // è·å–èŠ‚ç‚¹
            const nodes = document.querySelectorAll('#intentTree .decision-node');
            const inputNode = nodes[0]; // ç”¨æˆ·è¾“å…¥
            const classifyNode = nodes[1]; // æ„å›¾åˆ†ç±»
            const intentNodes = Array.from(nodes).slice(2); // å››ä¸ªæ„å›¾èŠ‚ç‚¹

            // ç¬¬1æ­¥ï¼šç”¨æˆ·è¾“å…¥æ¶ˆæ¯
            stepDesc.innerHTML = '<strong>æ­¥éª¤ 1ï¼š</strong>ğŸ’¬ ç”¨æˆ·è¾“å…¥ - ç³»ç»Ÿæ¥æ”¶åˆ°ç”¨æˆ·æ¶ˆæ¯';
            messageContent.textContent = `"${selectedIntent.example}"`;
            messageContent.style.transform = 'scale(1.05)';
            setTimeout(() => {
                messageContent.style.transform = 'scale(1)';
            }, 200);
            await new Promise(resolve => setTimeout(resolve, 1200));

            // ç¬¬2æ­¥ï¼šæ˜¾ç¤ºç”¨æˆ·è¾“å…¥èŠ‚ç‚¹
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 2ï¼š</strong>ğŸ“¥ è¯»å–æ¶ˆæ¯ - çŠ¶æ€åŒ…å«ç”¨æˆ·è¾“å…¥ï¼š<span style="color: #ec4899;">"${selectedIntent.example}"</span>`;
            inputNode.classList.add('visible', 'active');
            if (inputNode.querySelector('p')) {
                inputNode.querySelector('p').textContent = selectedIntent.example;
            }
            await new Promise(resolve => setTimeout(resolve, 1200));
            inputNode.classList.remove('active');

            // ç¬¬3æ­¥ï¼šæ„å›¾åˆ†ç±»
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 3ï¼š</strong>ğŸ¤– æ„å›¾åˆ†ç±» - AI è¯†åˆ«æ¶ˆæ¯æ„å›¾ä¸ºï¼š<span style="color: #fbbf24; font-weight: bold;">"${selectedIntent.name}"</span>`;
            classifyNode.classList.add('visible', 'active');
            if (classifyNode.querySelector('p')) {
                classifyNode.querySelector('p').textContent = `è¯†åˆ«ä¸º: ${selectedIntent.label}`;
            }
            await new Promise(resolve => setTimeout(resolve, 1200));
            classifyNode.classList.remove('active');

            // ç¬¬4æ­¥ï¼šæ˜¾ç¤ºæ‰€æœ‰æ„å›¾èŠ‚ç‚¹ï¼ˆå…ˆå…¨éƒ¨æ˜¾ç¤ºï¼‰
            intentNodes.forEach(node => {
                node.classList.add('visible');
            });
            await new Promise(resolve => setTimeout(resolve, 500));

            // ç¬¬5æ­¥ï¼šè·¯ç”±åˆ°åŒ¹é…çš„æ„å›¾å¤„ç†å™¨
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 4ï¼š</strong>âœ… è·¯ç”±åŒ¹é… - æ„å›¾ <span style="color: #ec4899;">"${selectedIntent.name}"</span> è·¯ç”±åˆ°<strong style="color: #ec4899;">${selectedIntent.icon} ${selectedIntent.label}</strong>å¤„ç†å™¨`;
            const selectedNode = intentNodes.find(node =>
                node.querySelector('h4').textContent === selectedIntent.label
            );

            if (selectedNode) {
                selectedNode.classList.add('active');
                selectedNode.style.borderColor = '#ec4899';
                selectedNode.style.background = 'rgba(236, 72, 153, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1500));
                selectedNode.classList.remove('active');
            }

            // æœ€ç»ˆæ€»ç»“
            stepDesc.innerHTML = `
                <strong>å®Œæˆï¼</strong> ğŸ‰<br>
                AI è¯†åˆ«ç”¨æˆ·æ¶ˆæ¯æ„å›¾ä¸º <span style="color: #ec4899; font-family: monospace;">"${selectedIntent.name}"</span>ï¼Œè‡ªåŠ¨è·¯ç”±åˆ°<strong style="color: #ec4899;">${selectedIntent.icon} ${selectedIntent.label}</strong>å¤„ç†å™¨<br>
                <span style="color: #94a3b8; font-size: 0.9em;">è¿™å°±æ˜¯æ™ºèƒ½å®¢æœçš„æ ¸å¿ƒï¼šæ ¹æ®æ„å›¾è‡ªåŠ¨è·¯ç”±åˆ°ä¸“é—¨çš„å¤„ç†å™¨ï¼</span>
            `;

            btn.disabled = false;
            btn.textContent = 'ğŸ”„ é‡æ–°æ¼”ç¤º';
        }

        // åœºæ™¯ 5: å®¢æˆ·æœåŠ¡è·¯ç”±
        async function runServiceDecision() {
            const btn = document.getElementById('runServiceBtn');
            const stateDisplay = document.getElementById('serviceStateDisplay');
            const stateContent = document.getElementById('serviceStateContent');
            const stepDesc = document.getElementById('serviceStepDesc');

            btn.disabled = true;
            btn.textContent = 'â³ æ¼”ç¤ºä¸­...';

            // æ˜¾ç¤ºçŠ¶æ€é¢æ¿
            stateDisplay.style.display = 'block';

            // é‡ç½®
            document.querySelectorAll('#serviceTree .decision-node').forEach(el => {
                el.classList.remove('visible', 'active');
                el.style.borderColor = '';
                el.style.background = '';
                // æ¢å¤åŸå§‹æ–‡æœ¬
                const p = el.querySelector('p');
                if (p) {
                    const h4 = el.querySelector('h4');
                    if (h4.textContent === 'VIPå®¢æˆ·') {
                        p.textContent = '';
                    } else if (h4.textContent === 'æ™®é€šå®¢æˆ·') {
                        p.textContent = '';
                    } else if (h4.textContent === 'VIPå›¢é˜Ÿ') {
                        p.textContent = '';
                    } else if (h4.textContent === 'æ™®é€šå›¢é˜Ÿ') {
                        p.textContent = '';
                    }
                }
            });

            stateContent.textContent = '{ customer_type: ?, issue_type: ? }';
            await new Promise(resolve => setTimeout(resolve, 500));

            // éšæœºé€‰æ‹©å®¢æˆ·ç±»å‹
            const isVIP = Math.random() > 0.5;

            // è·å–èŠ‚ç‚¹
            const nodes = document.querySelectorAll('#serviceTree .decision-node');
            const classifyNode = nodes[0]; // å®¢æˆ·åˆ†ç±»
            const vipNode = nodes[1]; // VIPå®¢æˆ·
            const normalNode = nodes[2]; // æ™®é€šå®¢æˆ·
            const vipConditionNode = nodes[3]; // VIPé—®é¢˜ç±»å‹
            const normalConditionNode = nodes[4]; // æ™®é€šé—®é¢˜ç±»å‹
            const vipTeamNode = nodes[5]; // VIPå›¢é˜Ÿ
            const normalTeamNode = nodes[6]; // æ™®é€šå›¢é˜Ÿ

            // ç¬¬1æ­¥ï¼šåˆå§‹åŒ–å®¢æˆ·ç±»å‹çŠ¶æ€
            const customerType = isVIP ? 'VIP' : 'æ™®é€š';
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 1ï¼š</strong>ğŸ“¥ åˆå§‹åŒ–çŠ¶æ€ - ç³»ç»Ÿéšæœºé€‰æ‹©å®¢æˆ·ç±»å‹ï¼š<span style="color: #8b5cf6; font-weight: bold;">${customerType}å®¢æˆ·</span>`;
            animateStateUpdate(stateContent, `{ customer_type: "${customerType}", issue_type: ? }`);
            await new Promise(resolve => setTimeout(resolve, 1200));

            // ç¬¬2æ­¥ï¼šæ˜¾ç¤ºå®¢æˆ·åˆ†ç±»èŠ‚ç‚¹
            stepDesc.innerHTML = `<strong>æ­¥éª¤ 2ï¼š</strong>ğŸ‘¤ å®¢æˆ·åˆ†ç±»èŠ‚ç‚¹ - è¯»å–çŠ¶æ€ä¸­çš„å®¢æˆ·ç±»å‹ï¼š<span style="color: #8b5cf6;">${customerType}</span>`;
            classifyNode.classList.add('visible', 'active');
            await new Promise(resolve => setTimeout(resolve, 1200));
            classifyNode.classList.remove('active');

            // ç¬¬3æ­¥ï¼šæ˜¾ç¤ºä¸¤ä¸ªå®¢æˆ·ç±»å‹èŠ‚ç‚¹
            vipNode.classList.add('visible');
            normalNode.classList.add('visible');
            await new Promise(resolve => setTimeout(resolve, 500));

            // ç¬¬4æ­¥ï¼šæ ¹æ®å®¢æˆ·ç±»å‹é€‰æ‹©è·¯å¾„ï¼ˆç¬¬ä¸€å±‚æ¡ä»¶åˆ¤æ–­ï¼‰
            if (isVIP) {
                // VIPè·¯å¾„
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 3ï¼š</strong>â­ ç¬¬ä¸€å±‚åˆ¤æ–­ - å®¢æˆ·ç±»å‹ä¸º <span style="color: #fbbf24;">VIP</span>ï¼Œè¿›å…¥VIPæœåŠ¡æµç¨‹`;
                vipNode.classList.add('active');
                vipNode.style.borderColor = '#fbbf24';
                vipNode.style.background = 'rgba(251, 191, 36, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1200));
                vipNode.classList.remove('active');

                // æ˜¾ç¤ºVIPæ¡ä»¶èŠ‚ç‚¹
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 4ï¼š</strong>ğŸ” ç¬¬äºŒå±‚åˆ¤æ–­ - æ£€æŸ¥VIPå®¢æˆ·çš„é—®é¢˜ç±»å‹`;
                vipConditionNode.classList.add('visible', 'active');
                await new Promise(resolve => setTimeout(resolve, 1200));
                vipConditionNode.classList.remove('active');

                // æ˜¾ç¤ºVIPå›¢é˜ŸèŠ‚ç‚¹
                vipTeamNode.classList.add('visible', 'active');
                vipTeamNode.style.borderColor = '#22c55e';
                vipTeamNode.style.background = 'rgba(34, 197, 94, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1500));
                vipTeamNode.classList.remove('active');

                // VIPæœ€ç»ˆæ€»ç»“
                stepDesc.innerHTML = `
                    <strong>å®Œæˆï¼</strong> ğŸ‰<br>
                    ç»è¿‡<span style="color: #fbbf24;">ä¸¤å±‚æ¡ä»¶åˆ¤æ–­</span>ï¼ŒVIPå®¢æˆ·è¢«è·¯ç”±åˆ°<strong style="color: #22c55e;">ğŸ’ VIPä¸“å±å›¢é˜Ÿ</strong><br>
                    <span style="color: #94a3b8; font-size: 0.9em;">å¤šçº§å†³ç­–æ ‘å¯ä»¥å¤„ç†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œå®ç°ç²¾å‡†è·¯ç”±ï¼</span>
                `;
            } else {
                // æ™®é€šå®¢æˆ·è·¯å¾„
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 3ï¼š</strong>ğŸ‘¥ ç¬¬ä¸€å±‚åˆ¤æ–­ - å®¢æˆ·ç±»å‹ä¸º <span style="color: #8b5cf6;">æ™®é€š</span>ï¼Œè¿›å…¥æ™®é€šæœåŠ¡æµç¨‹`;
                normalNode.classList.add('active');
                normalNode.style.borderColor = '#8b5cf6';
                normalNode.style.background = 'rgba(139, 92, 246, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1200));
                normalNode.classList.remove('active');

                // æ˜¾ç¤ºæ™®é€šæ¡ä»¶èŠ‚ç‚¹
                stepDesc.innerHTML = `<strong>æ­¥éª¤ 4ï¼š</strong>ğŸ” ç¬¬äºŒå±‚åˆ¤æ–­ - æ£€æŸ¥æ™®é€šå®¢æˆ·çš„é—®é¢˜ç±»å‹`;
                normalConditionNode.classList.add('visible', 'active');
                await new Promise(resolve => setTimeout(resolve, 1200));
                normalConditionNode.classList.remove('active');

                // æ˜¾ç¤ºæ™®é€šå›¢é˜ŸèŠ‚ç‚¹
                normalTeamNode.classList.add('visible', 'active');
                normalTeamNode.style.borderColor = '#22c55e';
                normalTeamNode.style.background = 'rgba(34, 197, 94, 0.3)';
                await new Promise(resolve => setTimeout(resolve, 1500));
                normalTeamNode.classList.remove('active');

                // æ™®é€šå®¢æˆ·æœ€ç»ˆæ€»ç»“
                stepDesc.innerHTML = `
                    <strong>å®Œæˆï¼</strong> ğŸ‰<br>
                    ç»è¿‡<span style="color: #8b5cf6;">ä¸¤å±‚æ¡ä»¶åˆ¤æ–­</span>ï¼Œæ™®é€šå®¢æˆ·è¢«è·¯ç”±åˆ°<strong style="color: #22c55e;">ğŸ‘¥ æ™®é€šæœåŠ¡å›¢é˜Ÿ</strong><br>
                    <span style="color: #94a3b8; font-size: 0.9em;">å¤šçº§å†³ç­–æ ‘å¯ä»¥å¤„ç†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œå®ç°ç²¾å‡†è·¯ç”±ï¼</span>
                `;
            }

            btn.disabled = false;
            btn.textContent = 'ğŸ”„ é‡æ–°æ¼”ç¤º';
        }

        // å¯åŠ¨
        init();
    </script>
</body>
</html>
