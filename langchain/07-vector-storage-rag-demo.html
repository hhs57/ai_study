<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘é‡å­˜å‚¨ä¸æ£€ç´¢ï¼ˆRAGï¼‰- LangChain å­¦ä¹  07</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
            min-height: 100vh;
            color: #e2e8f0;
            overflow-x: hidden;
            position: relative;
        }

        /* æµ®åŠ¨å…‰çƒ */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            pointer-events: none;
            z-index: 0;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(14, 165, 233, 0.3) 0%, rgba(139, 92, 246, 0.1) 50%, transparent 70%);
            top: -200px;
            right: -200px;
        }

        .orb-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(217, 70, 239, 0.2) 0%, rgba(59, 130, 246, 0.1) 50%, transparent 70%);
            bottom: -150px;
            left: -150px;
            animation-delay: -10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(30px, -30px) scale(1.1); }
            50% { transform: translate(-20px, 20px) scale(0.9); }
            75% { transform: translate(-30px, -20px) scale(1.05); }
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        /* å¤´éƒ¨ */
        .header {
            text-align: center;
            margin-bottom: 60px;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 40px rgba(14, 165, 233, 0.3);
        }

        .header p {
            font-size: 1.3em;
            color: rgba(226, 232, 240, 0.8);
        }

        /* è¿›åº¦æ¡ */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 1000;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #0ea5e9 0%, #8b5cf6 50%, #d946ef 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* åœºæ™¯å®¹å™¨ */
        .scene {
            display: none;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scene.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* åœºæ™¯æ ‡é¢˜ */
        .scene-title {
            font-size: 2.5em;
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* åŠ¨ç”»ç”»å¸ƒ */
        .canvas-container {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        /* å‘é‡å¯è§†åŒ– */
        .vector-visualization {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            padding: 40px;
        }

        .text-block {
            background: rgba(14, 165, 233, 0.2);
            border: 2px solid rgba(14, 165, 233, 0.5);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            font-size: 1.3em;
            font-weight: 600;
            color: #0ea5e9;
            transition: all 0.6s;
            position: relative;
        }

        .text-block.processing {
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(14, 165, 233, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(14, 165, 233, 0.8); }
        }

        .arrow-down {
            font-size: 3em;
            color: #8b5cf6;
            animation: bounce 1s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        .vector-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            width: 100%;
            max-width: 800px;
        }

        .vector-box {
            background: rgba(139, 92, 246, 0.15);
            border: 2px solid rgba(139, 92, 246, 0.4);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.6s;
            opacity: 0;
            transform: scale(0.8);
        }

        .vector-box.visible {
            opacity: 1;
            transform: scale(1);
        }

        .vector-box:hover {
            background: rgba(139, 92, 246, 0.25);
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.5);
        }

        .vector-box h4 {
            color: #a78bfa;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .vector-box .vector-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            color: rgba(226, 232, 240, 0.8);
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .similarity-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
        }

        .similarity-bar .fill {
            height: 100%;
            background: linear-gradient(90deg, #22c55e, #84cc16);
            transition: width 1s ease;
        }

        /* å‘é‡æ•°æ®åº“å¯è§†åŒ– */
        .database-container {
            display: flex;
            gap: 60px;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .database-visual {
            position: relative;
            width: 300px;
            height: 400px;
        }

        .database-stack {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .doc-layer {
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.2), rgba(139, 92, 246, 0.2));
            border: 2px solid rgba(14, 165, 233, 0.4);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.6s;
            opacity: 0;
            transform: translateX(-50px);
        }

        .doc-layer.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .doc-layer.stored {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(168, 85, 247, 0.2));
            border-color: rgba(34, 197, 94, 0.5);
        }

        .doc-layer h5 {
            color: #60a5fa;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .doc-layer p {
            font-size: 0.8em;
            color: rgba(226, 232, 240, 0.7);
        }

        .query-processing {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .query-box {
            background: rgba(217, 70, 239, 0.2);
            border: 2px solid rgba(217, 70, 239, 0.5);
            border-radius: 12px;
            padding: 20px 30px;
            font-size: 1.1em;
            color: #d946ef;
            transition: all 0.6s;
        }

        .query-box.matching {
            animation: glow 1s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(217, 70, 239, 0.4); }
            50% { box-shadow: 0 0 40px rgba(217, 70, 239, 0.8); }
        }

        .result-box {
            background: rgba(34, 197, 94, 0.15);
            border: 2px solid rgba(34, 197, 94, 0.4);
            border-radius: 12px;
            padding: 20px;
            min-width: 250px;
        }

        .result-box h5 {
            color: #22c55e;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .result-item {
            background: rgba(34, 197, 94, 0.1);
            padding: 10px;
            border-radius: 8px;
            margin: 8px 0;
            font-size: 0.9em;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.5s;
        }

        .result-item.visible {
            opacity: 1;
            transform: translateX(0);
        }

        /* RAG æµç¨‹å›¾ */
        .rag-flow {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            padding: 40px;
            position: relative;
        }

        .flow-stage {
            display: flex;
            align-items: center;
            gap: 30px;
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
            position: relative;
            padding: 30px;
            border-radius: 20px;
            transition: all 0.5s;
        }

        .flow-stage::before {
            content: attr(data-stage);
            position: absolute;
            top: -15px;
            left: 20px;
            background: rgba(14, 165, 233, 0.3);
            color: #60a5fa;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .flow-stage.active::before {
            opacity: 1;
        }

        .flow-stage.preparation {
            background: rgba(14, 165, 233, 0.05);
            border: 2px dashed rgba(14, 165, 233, 0.2);
        }

        .flow-stage.retrieval {
            background: rgba(217, 70, 239, 0.05);
            border: 2px dashed rgba(217, 70, 239, 0.2);
        }

        .flow-stage.generation {
            background: rgba(34, 197, 94, 0.05);
            border: 2px dashed rgba(34, 197, 94, 0.2);
        }

        /* çŠ¶æ€æç¤ºæ¡† */
        .status-indicator {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid rgba(139, 92, 246, 0.5);
            border-radius: 15px;
            padding: 20px 40px;
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.2em;
            font-weight: 600;
            color: #a78bfa;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.5s;
        }

        .status-indicator.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .status-indicator .status-text {
            transition: all 0.3s;
        }

        .flow-box {
            background: rgba(14, 165, 233, 0.15);
            border: 2px solid rgba(14, 165, 233, 0.4);
            border-radius: 15px;
            padding: 25px 35px;
            text-align: center;
            min-width: 180px;
            transition: all 0.6s;
            opacity: 0;
            transform: scale(0.8);
        }

        .flow-box.visible {
            opacity: 1;
            transform: scale(1);
        }

        .flow-box.active {
            background: rgba(14, 165, 233, 0.3);
            border-color: rgba(14, 165, 233, 0.8);
            box-shadow: 0 0 30px rgba(14, 165, 233, 0.6);
            animation: pulse 1s ease-in-out infinite;
        }

        .flow-box h4 {
            color: #60a5fa;
            margin-bottom: 8px;
            font-size: 1.2em;
        }

        .flow-box p {
            color: rgba(226, 232, 240, 0.7);
            font-size: 0.9em;
        }

        .flow-arrow {
            font-size: 2.5em;
            color: #8b5cf6;
            opacity: 0;
            transition: all 0.6s;
            position: relative;
        }

        .flow-arrow.visible {
            opacity: 1;
            animation: moveArrow 1s ease-in-out infinite;
        }

        .flow-arrow.active {
            color: #0ea5e9;
            text-shadow: 0 0 20px rgba(14, 165, 233, 0.8);
            transform: scale(1.2);
        }

        @keyframes moveArrow {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        /* æ•°æ®åŒ…åŠ¨ç”» */
        .data-packet {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #0ea5e9, #8b5cf6);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(14, 165, 233, 0.8);
            opacity: 0;
            z-index: 10;
            pointer-events: none;
        }

        .data-packet.moving {
            opacity: 1;
            animation: movePacket 0.8s ease-in-out forwards;
        }

        @keyframes movePacket {
            0% {
                transform: translate(0, 0) scale(0.5);
                opacity: 0;
            }
            50% {
                opacity: 1;
                transform: translate(50px, 0) scale(1);
            }
            100% {
                transform: translate(100px, 0) scale(0.5);
                opacity: 0;
            }
        }

        /* è¿æ¥çº¿åŠ¨ç”» */
        .connection-line {
            position: absolute;
            height: 3px;
            background: linear-gradient(90deg, transparent, #8b5cf6, transparent);
            opacity: 0;
            transition: all 0.5s;
            z-index: 1;
        }

        .connection-line.visible {
            opacity: 0.3;
        }

        .connection-line.active {
            opacity: 1;
            background: linear-gradient(90deg, transparent, #0ea5e9, #8b5cf6, transparent);
            animation: pulseLine 1s ease-in-out infinite;
        }

        @keyframes pulseLine {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .llm-box {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.25), rgba(217, 70, 239, 0.25));
            border: 3px solid rgba(139, 92, 246, 0.6);
            border-radius: 15px;
            padding: 30px 40px;
            text-align: center;
            min-width: 200px;
        }

        .llm-box h4 {
            color: #a78bfa;
            font-size: 1.4em;
            margin-bottom: 10px;
        }

        .llm-box p {
            color: rgba(226, 232, 240, 0.8);
            font-size: 1em;
        }

        /* ä»£ç å±•ç¤º */
        .code-showcase {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin: 30px 0;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s;
        }

        .code-showcase.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .code-showcase h4 {
            padding: 20px;
            margin: 0;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #60a5fa;
            font-size: 1.1em;
        }

        .code-showcase pre {
            padding: 20px;
            margin: 0;
            overflow-x: auto;
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            color: #e2e8f0;
        }

        .keyword { color: #c792ea; font-weight: bold; }
        .string { color: #c3e88d; }
        .comment { color: #546e7a; font-style: italic; }
        .function { color: #82aaff; }

        /* é€‰é¡¹ç½‘æ ¼ */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .option-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            transition: all 0.6s;
            opacity: 0;
            transform: translateY(30px);
            cursor: pointer;
        }

        .option-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .option-card:hover {
            background: rgba(14, 165, 233, 0.15);
            border-color: rgba(14, 165, 233, 0.5);
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(14, 165, 233, 0.3);
        }

        .option-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .option-card h4 {
            color: #60a5fa;
            margin-bottom: 12px;
            font-size: 1.3em;
        }

        .option-card p {
            color: rgba(226, 232, 240, 0.7);
            font-size: 0.95em;
            line-height: 1.6;
        }

        .option-card .tag {
            display: inline-block;
            background: rgba(14, 165, 233, 0.2);
            color: #60a5fa;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            margin-top: 10px;
        }

        /* åº”ç”¨åœºæ™¯ */
        .use-case-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .use-case-item {
            background: rgba(14, 165, 233, 0.1);
            border-left: 5px solid #0ea5e9;
            border-radius: 12px;
            padding: 25px;
            opacity: 0;
            transform: translateX(-30px);
            transition: all 0.6s;
        }

        .use-case-item.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .use-case-item:hover {
            background: rgba(14, 165, 233, 0.2);
            transform: translateX(10px);
            box-shadow: 0 5px 20px rgba(14, 165, 233, 0.3);
        }

        .use-case-item h4 {
            color: #60a5fa;
            margin-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .use-case-item p {
            color: rgba(226, 232, 240, 0.8);
            line-height: 1.7;
            font-size: 0.95em;
        }

        /* é«˜äº®æ¡† */
        .highlight-box {
            background: rgba(14, 165, 233, 0.15);
            border-left: 5px solid #0ea5e9;
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
            animation: slideInRight 0.8s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .highlight-box h3 {
            color: #60a5fa;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .highlight-box p {
            line-height: 1.8;
            color: rgba(226, 232, 240, 0.9);
        }

        /* å¯¹æ¯”è¡¨æ ¼ */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            overflow: hidden;
        }

        .comparison-table th {
            background: rgba(14, 165, 233, 0.2);
            padding: 20px;
            text-align: left;
            font-weight: 600;
            color: #60a5fa;
        }

        .comparison-table td {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comparison-table tr:hover td {
            background: rgba(14, 165, 233, 0.1);
        }

        /* å¯¼èˆªæŒ‰é’® */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            gap: 20px;
        }

        .nav-btn {
            padding: 15px 40px;
            background: rgba(14, 165, 233, 0.2);
            border: 2px solid rgba(14, 165, 233, 0.5);
            border-radius: 12px;
            color: #60a5fa;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-btn:hover:not(:disabled) {
            background: rgba(14, 165, 233, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(14, 165, 233, 0.4);
        }

        /* é’ˆå¯¹ a æ ‡ç­¾çš„å¯¼èˆªæŒ‰é’®æ ·å¼ */
        .nav-btn.back-to-list {
            text-decoration: none;
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            color: #60a5fa;
        }

        .nav-btn.back-to-list:hover {
            background: rgba(59, 130, 246, 0.4);
            box-shadow: 0 5px 20px rgba(59, 130, 246, 0.4);
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .nav-btn.next {
            margin-left: auto;
        }

        /* åœºæ™¯æŒ‡ç¤ºå™¨ */
        .scene-indicators {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 40px 0;
        }

        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s;
        }

        .indicator.active {
            background: #0ea5e9;
            transform: scale(1.3);
        }

        .indicator:hover {
            transform: scale(1.2);
        }

        /* äº¤äº’æŒ‰é’® */
        .action-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #0ea5e9, #8b5cf6);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(14, 165, 233, 0.5);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .database-container {
                flex-direction: column;
            }

            .vector-display {
                grid-template-columns: 1fr;
            }

            .flow-stage {
                flex-direction: column;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }
        }
    
        /* æ ‡å‡†å¯¼èˆªæ ·å¼ */
        .nav-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 32px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .nav-card a {
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .nav-card a:hover {
            transform: translateY(-2px);
        }

        /* é¡¶éƒ¨å¯¼èˆªå¡ç‰‡ */
        .top-nav-card {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px 24px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .top-nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .top-nav-left,
        .top-nav-center,
        .top-nav-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .top-nav-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #9ca3af;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .top-nav-link:hover {
            color: #e5e7eb;
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }

        .top-nav-link.home {
            color: #4ade80;
        }

        .top-nav-link.home:hover {
            color: #86efac;
        }

        .top-nav-link svg {
            width: 20px;
            height: 20px;
        }

        .top-nav-divider {
            width: 1px;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
        }

        .top-nav-text {
            color: #6b7280;
            font-size: 0.9em;
        }

        .top-nav-progress {
            color: #9ca3af;
            font-size: 0.9em;
            font-weight: 500;
        }
</style>
</head>
<body>
    <!-- æµ®åŠ¨å…‰çƒ -->
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>    <!-- é¡¶éƒ¨å¯¼èˆª - è·¨æ¨¡å— -->
    <div class="top-nav-card">
        <div class="top-nav-container">
            <div class="top-nav-left">
                <a href="index.html" class="top-nav-link home">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    è¿”å›LangChainç›®å½•
                </a>
            </div>
            <div class="top-nav-center">
                <a href="06-document-loading-demo.html" class="top-nav-link">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    ä¸Šä¸€è¯¾
                </a>
                <div class="top-nav-divider"></div>
                <a href="08-output-parsers-advanced-demo.html" class="top-nav-link">
                    ä¸‹ä¸€è¯¾
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>
            <div class="top-nav-right">
                <span class="top-nav-progress">è¯¾ç¨‹ 7 / 20</span>
            </div>
        </div>
    </div>

    <!-- è¿›åº¦æ¡ -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>ğŸ” å‘é‡å­˜å‚¨ä¸æ£€ç´¢ï¼ˆRAGï¼‰</h1>
            <p>æ„å»ºæ™ºèƒ½é—®ç­”ç³»ç»Ÿçš„æ ¸å¿ƒæŠ€æœ¯</p>
        </div>

        <!-- åœºæ™¯ 1: ä»€ä¹ˆæ˜¯ RAG -->
        <div class="scene active" id="scene1">
            <h2 class="scene-title">ğŸ¤” ä»€ä¹ˆæ˜¯ RAGï¼Ÿ</h2>

            <div class="canvas-container">
                <div class="vector-visualization">
                    <div class="text-block" id="rag-question">
                        â“ ç”¨æˆ·é—®é¢˜ï¼š<br>ä»€ä¹ˆæ˜¯ RAGï¼Ÿ
                    </div>

                    <div class="arrow-down" id="rag-arrow-1">â†“</div>

                    <div class="text-block" id="rag-retrieval" style="background: rgba(139, 92, 246, 0.2); border-color: rgba(139, 92, 246, 0.5); color: #a78bfa;">
                        ğŸ“š ä»çŸ¥è¯†åº“æ£€ç´¢<br>ç›¸å…³æ–‡æ¡£
                    </div>

                    <div class="arrow-down" id="rag-arrow-2">â†“</div>

                    <div class="llm-box" id="rag-llm">
                        <h4>ğŸ¤– LLM</h4>
                        <p>åŸºäºæ£€ç´¢åˆ°çš„æ–‡æ¡£<br>ç”Ÿæˆç­”æ¡ˆ</p>
                    </div>

                    <div class="arrow-down" id="rag-arrow-3">â†“</div>

                    <div class="text-box" id="rag-answer" style="background: rgba(34, 197, 94, 0.2); border: 2px solid rgba(34, 197, 94, 0.5); border-radius: 15px; padding: 20px; color: #22c55e;">
                        âœ… å‡†ç¡®ç­”æ¡ˆ
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <h3>ğŸ’¡ RAG çš„æ ¸å¿ƒä»·å€¼</h3>
                <p>
                    <strong>RAGï¼ˆRetrieval Augmented Generationï¼‰</strong> = æ£€ç´¢å¢å¼ºç”Ÿæˆ<br><br>
                    å®ƒè§£å†³äº† LLM çš„ä¸‰å¤§ç—›ç‚¹ï¼š<br><br>
                    â€¢ <strong>çŸ¥è¯†è¿‡æ—¶</strong>ï¼šLLM è®­ç»ƒæ•°æ®æœ‰æˆªæ­¢æ—¥æœŸï¼ŒRAG å¯ä»¥è®¿é—®æœ€æ–°ä¿¡æ¯<br>
                    â€¢ <strong>å¹»è§‰é—®é¢˜</strong>ï¼šLLM å¯èƒ½ç¼–é€ ç­”æ¡ˆï¼ŒRAG åŸºäºçœŸå®æ–‡æ¡£å›ç­”<br>
                    â€¢ <strong>ç§æœ‰æ•°æ®</strong>ï¼šLLM æ— æ³•è®¿é—®ä¼ä¸šå†…éƒ¨æ•°æ®ï¼ŒRAG å¯ä»¥ä½¿ç”¨ç§æœ‰çŸ¥è¯†åº“
                </p>
            </div>

            <div class="use-case-list">
                <div class="use-case-item" data-delay="0">
                    <h4>ğŸ“š æ™ºèƒ½å®¢æœ</h4>
                    <p>åŸºäºä¼ä¸šæ–‡æ¡£å’Œ FAQï¼Œè‡ªåŠ¨å›ç­”å®¢æˆ·é—®é¢˜ï¼Œå‡å°‘äººå·¥å®¢æœè´Ÿæ‹…</p>
                </div>

                <div class="use-case-item" data-delay="100">
                    <h4>ğŸ“– çŸ¥è¯†åº“é—®ç­”</h4>
                    <p>å¿«é€Ÿä»å¤§é‡æ–‡æ¡£ä¸­æ‰¾åˆ°ç›¸å…³ä¿¡æ¯ï¼Œç”Ÿæˆå‡†ç¡®çš„ç­”æ¡ˆ</p>
                </div>

                <div class="use-case-item" data-delay="200">
                    <h4>ğŸ”¬ ç ”ç©¶åŠ©æ‰‹</h4>
                    <p>å¸®åŠ©ç ”ç©¶äººå‘˜å¿«é€ŸæŸ¥æ‰¾å’Œæ€»ç»“ç›¸å…³æ–‡çŒ®</p>
                </div>
            </div>
        </div>

        <!-- åœºæ™¯ 2: å‘é‡åµŒå…¥ -->
        <div class="scene" id="scene2">
            <h2 class="scene-title">ğŸ¯ å‘é‡åµŒå…¥ï¼ˆEmbeddingsï¼‰</h2>

            <div class="canvas-container">
                <div class="vector-visualization">
                    <!-- æ­¥éª¤1: æ–‡æ¡£æ–‡æœ¬ -->
                    <div class="text-block" id="embed-text">
                        ğŸ“š æ–‡æ¡£æ–‡æœ¬ï¼š<br>"çŒ«" "ç‹—" "æ±½è½¦"
                    </div>

                    <div class="arrow-down" id="embed-arrow-1">â†“</div>

                    <!-- æ­¥éª¤2: åµŒå…¥æ¨¡å‹ -->
                    <div class="text-block processing" id="embed-model" style="background: rgba(139, 92, 246, 0.2); border-color: rgba(139, 92, 246, 0.5); color: #a78bfa;">
                        ğŸ”„ åµŒå…¥æ¨¡å‹<br>ï¼ˆOpenAI Embeddingsï¼‰
                    </div>

                    <div class="arrow-down" id="embed-arrow-2">â†“</div>

                    <!-- æ­¥éª¤3: å‘é‡è¡¨ç¤º -->
                    <div class="vector-display" id="embed-vectors">
                        <div class="vector-box" data-delay="0" data-word="çŒ«">
                            <h4>ğŸ± "çŒ«"</h4>
                            <div class="vector-value">[0.85, 0.12, 0.15]</div>
                            <div style="font-size: 0.85em; color: rgba(226, 232, 240, 0.6); margin-top: 5px;">
                                è¯­ä¹‰ç‰¹å¾ï¼šåŠ¨ç‰©ã€å¯çˆ±ã€å°å‹
                            </div>
                        </div>

                        <div class="vector-box" data-delay="100" data-word="ç‹—">
                            <h4>ğŸ¶ "ç‹—"</h4>
                            <div class="vector-value">[0.88, 0.10, 0.18]</div>
                            <div style="font-size: 0.85em; color: rgba(226, 232, 240, 0.6); margin-top: 5px;">
                                è¯­ä¹‰ç‰¹å¾ï¼šåŠ¨ç‰©ã€å¿ è¯šã€å°å‹
                            </div>
                        </div>

                        <div class="vector-box" data-delay="200" data-word="æ±½è½¦">
                            <h4>ğŸš— "æ±½è½¦"</h4>
                            <div class="vector-value">[0.15, 0.82, 0.78]</div>
                            <div style="font-size: 0.85em; color: rgba(226, 232, 240, 0.6); margin-top: 5px;">
                                è¯­ä¹‰ç‰¹å¾ï¼šäº¤é€šå·¥å…·ã€æœºæ¢°ã€å¤§å‹
                            </div>
                        </div>
                    </div>

                    <div class="arrow-down" id="embed-arrow-3" style="margin-top: 20px;">â†“</div>

                    <!-- æ­¥éª¤4: æŸ¥è¯¢æ¼”ç¤º -->
                    <div style="width: 100%; max-width: 800px; margin-top: 20px;">
                        <div class="text-block" id="query-input-section" style="background: rgba(217, 70, 239, 0.2); border-color: rgba(217, 70, 239, 0.5); color: #d946ef; cursor: pointer;">
                            <h4 style="margin-bottom: 10px;">â“ è¾“å…¥æŸ¥è¯¢æ–‡æœ¬</h4>
                            <input type="text" id="query-input" placeholder="è¾“å…¥æŸ¥è¯¢è¯ï¼Œä¾‹å¦‚ï¼šå® ç‰©" style="
                                background: rgba(0, 0, 0, 0.3);
                                border: 2px solid rgba(217, 70, 239, 0.4);
                                border-radius: 8px;
                                padding: 10px 15px;
                                color: #e2e8f0;
                                font-size: 1em;
                                width: 60%;
                                margin: 10px auto;
                                display: block;
                                text-align: center;
                            ">
                            <button class="action-btn" onclick="calculateSimilarity()" style="margin: 10px;">
                                ğŸ” è®¡ç®—ç›¸ä¼¼åº¦
                            </button>
                        </div>

                        <div id="similarity-results" style="display: none; margin-top: 30px;">
                            <div class="text-block" style="background: rgba(34, 197, 94, 0.15); border-color: rgba(34, 197, 94, 0.4); color: #22c55e; margin-bottom: 20px;">
                                <h4>ğŸ“Š ç›¸ä¼¼åº¦è®¡ç®—ç»“æœ</h4>
                                <p style="font-size: 0.9em; margin-top: 10px;">
                                    æŸ¥è¯¢: <span id="query-display" style="font-weight: bold;"></span><br>
                                    å‘é‡: <span id="query-vector" style="font-family: 'JetBrains Mono', monospace; font-size: 0.85em;"></span>
                                </p>
                            </div>

                            <div class="vector-display" id="similarity-bars">
                                <!-- åŠ¨æ€ç”Ÿæˆç›¸ä¼¼åº¦æ¡ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <h3>ğŸ§  ä»€ä¹ˆæ˜¯å‘é‡åµŒå…¥ï¼Ÿ</h3>
                <p>
                    å‘é‡åµŒå…¥æ˜¯å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—æ•°ç»„çš„è¿‡ç¨‹ï¼Œä½¿è®¡ç®—æœºèƒ½å¤Ÿ"ç†è§£"è¯­ä¹‰ã€‚<br><br>
                    â€¢ <strong>è¯­ä¹‰ç›¸è¿‘çš„æ–‡æœ¬</strong> â†’ å‘é‡è·ç¦»æ›´è¿‘ï¼ˆç›¸ä¼¼åº¦é«˜ï¼‰<br>
                    â€¢ <strong>è¯­ä¹‰ä¸åŒçš„æ–‡æœ¬</strong> â†’ å‘é‡è·ç¦»æ›´è¿œï¼ˆç›¸ä¼¼åº¦ä½ï¼‰<br>
                    â€¢ <strong>OpenAI text-embedding-3</strong> â†’ ç”Ÿæˆ 1536 ç»´å‘é‡<br><br>
                    è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ"çŒ«"å’Œ"ç‹—"çš„å‘é‡ç›¸ä¼¼åº¦å¾ˆé«˜ï¼Œè€Œ"çŒ«"å’Œ"æ±½è½¦"çš„ç›¸ä¼¼åº¦å¾ˆä½ï¼
                </p>
            </div>

            <div class="code-showcase">
                <h4>ğŸ’» ä»£ç ç¤ºä¾‹ï¼šåˆ›å»ºåµŒå…¥</h4>
                <pre><code><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings

<span class="comment"># åˆ›å»ºåµŒå…¥æ¨¡å‹</span>
embeddings = OpenAIEmbeddings()

<span class="comment"># å•ä¸ªæ–‡æœ¬åµŒå…¥</span>
vector = embeddings.embed_query(<span class="string">"Hello, world!"</span>)
<span class="keyword">print</span>(f<span class="string">"å‘é‡ç»´åº¦: {len(vector)}"</span>)  <span class="comment"># 1536</span>

<span class="comment"># æ‰¹é‡åµŒå…¥</span>
vectors = embeddings.embed_documents([
    <span class="string">"çŒ«"</span>,
    <span class="string">"ç‹—"</span>,
    <span class="string">"æ±½è½¦"</span>
])

<span class="comment"># è®¡ç®—ç›¸ä¼¼åº¦</span>
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="keyword">def</span> <span class="function">cosine_similarity</span>(vec1, vec2):
    <span class="keyword">return</span> np.dot(vec1, vec2) / (
        np.linalg.norm(vec1) * np.linalg.norm(vec2)
    )

similarity = cosine_similarity(vectors[0], vectors[1])
<span class="keyword">print</span>(f<span class="string">"çŒ«å’Œç‹—çš„ç›¸ä¼¼åº¦: {similarity:.2f}"</span>)</code></pre>
            </div>
        </div>

        <!-- åœºæ™¯ 3: å‘é‡æ•°æ®åº“ -->
        <div class="scene" id="scene3">
            <h2 class="scene-title">ğŸ—„ï¸ å‘é‡æ•°æ®åº“ï¼ˆVector Storeï¼‰</h2>

            <div class="canvas-container">
                <div class="database-container">
                    <div class="database-visual">
                        <div class="database-stack" id="doc-stack">
                            <div class="doc-layer" data-delay="0">
                                <h5>ğŸ“„ æ–‡æ¡£ 1</h5>
                                <p>"Python æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€"</p>
                            </div>

                            <div class="doc-layer" data-delay="100">
                                <h5>ğŸ“„ æ–‡æ¡£ 2</h5>
                                <p>"Python é€‚åˆæ•°æ®ç§‘å­¦"</p>
                            </div>

                            <div class="doc-layer" data-delay="200">
                                <h5>ğŸ“„ æ–‡æ¡£ 3</h5>
                                <p>"JavaScript ç”¨äº Web å¼€å‘"</p>
                            </div>

                            <div class="doc-layer" data-delay="300">
                                <h5>ğŸ“„ æ–‡æ¡£ 4</h5>
                                <p>"LangChain æ˜¯ä¸€ä¸ªæ¡†æ¶"</p>
                            </div>
                        </div>
                    </div>

                    <div class="query-processing">
                        <div class="query-box" id="query-text">
                            â“ æŸ¥è¯¢ï¼š"Python æ•°æ®åˆ†æ"
                        </div>

                        <button class="action-btn" id="search-btn" onclick="performSearch()">
                            ğŸ” å¼€å§‹æ£€ç´¢
                        </button>

                        <div class="result-box" id="search-results" style="display: none;">
                            <h5>âœ… æœ€ç›¸å…³çš„æ–‡æ¡£</h5>
                            <div class="result-item" data-delay="0">
                                ğŸ¥‡ "Python é€‚åˆæ•°æ®ç§‘å­¦" (ç›¸ä¼¼åº¦: 0.92)
                            </div>
                            <div class="result-item" data-delay="100">
                                ğŸ¥ˆ "Python æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€" (ç›¸ä¼¼åº¦: 0.85)
                            </div>
                            <div class="result-item" data-delay="200">
                                ğŸ¥‰ "LangChain æ˜¯ä¸€ä¸ªæ¡†æ¶" (ç›¸ä¼¼åº¦: 0.45)
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="options-grid">
                <div class="option-card" data-delay="0">
                    <div class="icon">ğŸŸ¦</div>
                    <h4>Chroma</h4>
                    <p>è½»é‡çº§ã€æ˜“ç”¨çš„å‘é‡æ•°æ®åº“ï¼Œéå¸¸é€‚åˆå¼€å‘å’Œå­¦ä¹ </p>
                    <span class="tag">æ¨èæ–°æ‰‹</span>
                </div>

                <div class="option-card" data-delay="100">
                    <div class="icon">ğŸŸ£</div>
                    <h4>FAISS</h4>
                    <p>Facebook å¼€æºçš„é«˜æ€§èƒ½å‘é‡æ£€ç´¢åº“</p>
                    <span class="tag">æœ¬åœ°éƒ¨ç½²</span>
                </div>

                <div class="option-card" data-delay="200">
                    <div class="icon">ğŸ©·</div>
                    <h4>Pinecone</h4>
                    <p>äº‘æ‰˜ç®¡çš„å‘é‡æ•°æ®åº“æœåŠ¡ï¼Œæ— éœ€è¿ç»´</p>
                    <span class="tag">äº‘æœåŠ¡</span>
                </div>

                <div class="option-card" data-delay="300">
                    <div class="icon">ğŸŸ©</div>
                    <h4>Weaviate</h4>
                    <p>åŠŸèƒ½ä¸°å¯Œçš„å¼€æºå‘é‡æœç´¢å¼•æ“</p>
                    <span class="tag">ä¼ä¸šçº§</span>
                </div>
            </div>

            <div class="code-showcase">
                <h4>ğŸ’» ä»£ç ç¤ºä¾‹ï¼šåˆ›å»ºå‘é‡å­˜å‚¨</h4>
                <pre><code><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> Chroma
<span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings
<span class="keyword">from</span> langchain_core.documents <span class="keyword">import</span> Document

<span class="comment"># å‡†å¤‡æ–‡æ¡£</span>
documents = [
    Document(page_content=<span class="string">"Python æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€"</span>),
    Document(page_content=<span class="string">"Python é€‚åˆæ•°æ®ç§‘å­¦"</span>),
    Document(page_content=<span class="string">"JavaScript ç”¨äº Web å¼€å‘"</span>)
]

<span class="comment"># åˆ›å»ºå‘é‡å­˜å‚¨</span>
vectorstore = Chroma.from_documents(
    documents=documents,
    embedding=OpenAIEmbeddings(),
    collection_name=<span class="string">"my_collection"</span>,
    persist_directory=<span class="string">"./chroma_db"</span>
)

<span class="comment"># åˆ›å»ºæ£€ç´¢å™¨</span>
retriever = vectorstore.as_retriever(
    search_type=<span class="string">"similarity"</span>,
    search_kwargs={<span class="string">"k"</span>: <span class="string">2</span>}  <span class="comment"># è¿”å›æœ€ç›¸å…³çš„ 2 ä¸ªæ–‡æ¡£</span>
)

<span class="comment"># æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
results = retriever.invoke(<span class="string">"Python æ•°æ®åˆ†æ"</span>)</code></pre>
            </div>
        </div>

        <!-- åœºæ™¯ 4: RAG å®Œæ•´æµç¨‹ -->
        <div class="scene" id="scene4">
            <h2 class="scene-title">ğŸ”„ RAG å®Œæ•´æµç¨‹</h2>

            <div class="canvas-container">
                <!-- çŠ¶æ€æç¤º -->
                <div class="status-indicator" id="rag-status">
                    <span class="status-text" id="status-text">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æ¼”ç¤º</span>
                </div>

                <div class="rag-flow" id="rag-flow-container">
                    <!-- é˜¶æ®µ 1: å‡†å¤‡çŸ¥è¯†åº“ -->
                    <div class="flow-stage preparation" id="stage-1" data-stage="ğŸ“š é˜¶æ®µ 1: å‡†å¤‡çŸ¥è¯†åº“">
                        <div class="flow-box" id="flow-docs" data-delay="0">
                            <h4>ğŸ“š æ–‡æ¡£</h4>
                            <p>åŠ è½½çŸ¥è¯†åº“</p>
                        </div>

                        <div class="flow-arrow" id="flow-arrow-1">â†’</div>

                        <div class="flow-box" id="flow-split" data-delay="100">
                            <h4>âœ‚ï¸ åˆ†å‰²</h4>
                            <p>æ–‡æœ¬åˆ‡åˆ†</p>
                        </div>

                        <div class="flow-arrow" id="flow-arrow-2">â†’</div>

                        <div class="flow-box" id="flow-embed" data-delay="200">
                            <h4>ğŸ¯ åµŒå…¥</h4>
                            <p>å‘é‡åŒ–</p>
                        </div>

                        <div class="flow-arrow" id="flow-arrow-3">â†’</div>

                        <div class="flow-box" id="flow-store" data-delay="300">
                            <h4>ğŸ—„ï¸ å­˜å‚¨</h4>
                            <p>å‘é‡æ•°æ®åº“</p>
                        </div>
                    </div>

                    <div style="height: 40px;"></div>

                    <!-- é˜¶æ®µ 2: æ£€ç´¢ -->
                    <div class="flow-stage retrieval" id="stage-2" data-stage="ğŸ” é˜¶æ®µ 2: æ£€ç´¢ç›¸å…³æ–‡æ¡£">
                        <div class="flow-box" id="flow-query" data-delay="400" style="background: rgba(217, 70, 239, 0.15); border-color: rgba(217, 70, 239, 0.4);">
                            <h4>â“ æŸ¥è¯¢</h4>
                            <p>ç”¨æˆ·é—®é¢˜</p>
                        </div>

                        <div class="flow-arrow" id="flow-arrow-4">â†’</div>

                        <div class="flow-box" id="flow-query-embed" data-delay="500" style="background: rgba(217, 70, 239, 0.15); border-color: rgba(217, 70, 239, 0.4);">
                            <h4>ğŸ¯ åµŒå…¥</h4>
                            <p>æŸ¥è¯¢å‘é‡åŒ–</p>
                        </div>

                        <div class="flow-arrow" id="flow-arrow-5">â†’</div>

                        <div class="flow-box" id="flow-retrieve" data-delay="600" style="background: rgba(217, 70, 239, 0.15); border-color: rgba(217, 70, 239, 0.4);">
                            <h4>ğŸ” æ£€ç´¢</h4>
                            <p>ç›¸ä¼¼åº¦æœç´¢</p>
                        </div>
                    </div>

                    <div style="height: 40px;"></div>

                    <!-- é˜¶æ®µ 3: ç”Ÿæˆ -->
                    <div class="flow-stage generation" id="stage-3" data-stage="ğŸ¤– é˜¶æ®µ 3: ç”Ÿæˆç­”æ¡ˆ">
                        <div class="flow-box" id="flow-context" data-delay="700">
                            <h4>ğŸ“‹ ä¸Šä¸‹æ–‡</h4>
                            <p>é—®é¢˜ + ç›¸å…³æ–‡æ¡£</p>
                        </div>

                        <div class="flow-arrow" id="flow-arrow-6">â†’</div>

                        <div class="llm-box" id="flow-gen-llm" data-delay="800">
                            <h4>ğŸ¤– LLM</h4>
                            <p>ç”Ÿæˆç­”æ¡ˆ</p>
                        </div>

                        <div class="flow-arrow" id="flow-arrow-7">â†’</div>

                        <div class="flow-box" id="flow-answer" data-delay="900" style="background: rgba(34, 197, 94, 0.15); border-color: rgba(34, 197, 94, 0.4);">
                            <h4>âœ… ç­”æ¡ˆ</h4>
                            <p>å‡†ç¡®å›å¤</p>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="action-btn" id="play-rag-btn" onclick="runRAGAnimation()">
                        ğŸ¬ æ’­æ”¾å®Œæ•´æµç¨‹åŠ¨ç”»
                    </button>
                </div>
            </div>

            <div class="code-showcase">
                <h4>ğŸ’» ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„ RAG é“¾</h4>
                <pre><code><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings, ChatOpenAI
<span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> Chroma
<span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate
<span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser
<span class="keyword">from</span> langchain_core.runnables <span class="keyword">import</span> RunnablePassthrough

<span class="comment"># åˆ›å»º RAG é“¾</span>
template = <span class="string">"""åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š

ä¸Šä¸‹æ–‡ï¼š
{context}

é—®é¢˜ï¼š{question}

ç­”æ¡ˆï¼š"""</span>

prompt = ChatPromptTemplate.from_template(template)
llm = ChatOpenAI(model=<span class="string">"gpt-3.5-turbo"</span>)

<span class="keyword">def</span> <span class="function">format_docs</span>(docs):
    <span class="keyword">return</span> <span class="string">"\n\n"</span>.join(doc.page_content <span class="keyword">for</span> doc <span class="keyword">in</span> docs)

<span class="comment"># ä½¿ç”¨ LCEL æ„å»ºé“¾</span>
rag_chain = (
    {
        <span class="string">"context"</span>: retriever | format_docs,
        <span class="string">"question"</span>: RunnablePassthrough()
    }
    | prompt
    | llm
    | StrOutputParser()
)

<span class="comment"># æé—®</span>
answer = rag_chain.invoke(<span class="string">"ä»€ä¹ˆæ˜¯ RAGï¼Ÿ"</span>)
<span class="keyword">print</span>(answer)</code></pre>
            </div>
        </div>

        <!-- åœºæ™¯ 5: æ£€ç´¢ç­–ç•¥ -->
        <div class="scene" id="scene5">
            <h2 class="scene-title">ğŸ¯ æ£€ç´¢ç­–ç•¥é€‰æ‹©</h2>

            <div class="comparison-table">
                <thead>
                    <tr>
                        <th style="width: 25%;">ç­–ç•¥</th>
                        <th style="width: 35%;">é€‚ç”¨åœºæ™¯</th>
                        <th style="width: 40%;">ä»£ç ç¤ºä¾‹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ğŸ¯ ç›¸ä¼¼åº¦æ£€ç´¢</td>
                        <td>æœ€å¸¸ç”¨ï¼Œè¿”å›æœ€ç›¸ä¼¼çš„ k ä¸ªæ–‡æ¡£</td>
                        <td><code>search_kwargs={"k": 3}</code></td>
                    </tr>
                    <tr>
                        <td>ğŸ“Š ç›¸ä¼¼åº¦é˜ˆå€¼</td>
                        <td>åªè¿”å›ç›¸ä¼¼åº¦è¶…è¿‡é˜ˆå€¼çš„æ–‡æ¡£</td>
                        <td><code>score_threshold=0.5</code></td>
                    </tr>
                    <tr>
                        <td>ğŸ”„ MMR</td>
                        <td>å¹³è¡¡ç›¸å…³æ€§å’Œå¤šæ ·æ€§</td>
                        <td><code>search_type="mmr"</code></td>
                    </tr>
                </tbody>
            </div>

            <div class="highlight-box">
                <h3>ğŸ’¡ å¦‚ä½•é€‰æ‹© k å€¼ï¼Ÿ</h3>
                <p>
                    <strong>k å€¼</strong>å†³å®šè¿”å›å¤šå°‘ä¸ªç›¸å…³æ–‡æ¡£ï¼š<br><br>
                    â€¢ <strong>k = 1-2</strong>ï¼šé—®é¢˜ç®€å•ï¼Œåªéœ€è¦æœ€ç›´æ¥çš„ç­”æ¡ˆ<br>
                    â€¢ <strong>k = 3-5</strong>ï¼šâœ… å¤§å¤šæ•°åœºæ™¯çš„æ¨èå€¼<br>
                    â€¢ <strong>k = 5-10</strong>ï¼šå¤æ‚é—®é¢˜ï¼Œéœ€è¦æ›´å¤šä¿¡æ¯<br>
                    â€¢ <strong>k > 10</strong>ï¼šå¯èƒ½å¯¼è‡´ä¸Šä¸‹æ–‡è¿‡é•¿ï¼Œå½±å“ LLM ç†è§£<br><br>
                    <strong>æœ€ä½³å®è·µï¼š</strong>ä» k=3 å¼€å§‹ï¼Œæ ¹æ®æ•ˆæœé€æ­¥è°ƒæ•´
                </p>
            </div>

            <div class="options-grid">
                <div class="option-card" data-delay="0">
                    <div class="icon">ğŸ¯</div>
                    <h4>ç›¸ä¼¼åº¦æ£€ç´¢</h4>
                    <p>è¿”å›ä¸æŸ¥è¯¢æœ€ç›¸ä¼¼çš„ k ä¸ªæ–‡æ¡£</p>
                    <span class="tag">æœ€å¸¸ç”¨</span>
                </div>

                <div class="option-card" data-delay="100">
                    <div class="icon">ğŸ“Š</div>
                    <h4>ç›¸ä¼¼åº¦é˜ˆå€¼</h4>
                    <p>åªè¿”å›ç›¸ä¼¼åº¦è¶…è¿‡é˜ˆå€¼çš„æ–‡æ¡£</p>
                    <span class="tag">è¿‡æ»¤ä½è´¨é‡</span>
                </div>

                <div class="option-card" data-delay="200">
                    <div class="icon">ğŸ”„</div>
                    <h4>MMR</h4>
                    <p>æœ€å¤§è¾¹é™…ç›¸å…³æ€§ï¼Œå¹³è¡¡ç›¸å…³æ€§å’Œå¤šæ ·æ€§</p>
                    <span class="tag">å¤šæ ·æ€§</span>
                </div>
            </div>
        </div>

        <!-- åœºæ™¯ 6: RAG æœ€ä½³å®è·µ -->
        <div class="scene" id="scene6">
            <h2 class="scene-title">âœ¨ RAG æœ€ä½³å®è·µ</h2>

            <div class="options-grid">
                <div class="option-card" data-delay="0">
                    <div class="icon">ğŸ“</div>
                    <h4>æ–‡æ¡£å‡†å¤‡</h4>
                    <p>æ¸…ç†æ–‡æ¡£ï¼Œç§»é™¤æ— å…³å†…å®¹ï¼Œä¿ç•™æœ‰æ„ä¹‰çš„å…ƒæ•°æ®</p>
                    <span class="tag">æ•°æ®è´¨é‡</span>
                </div>

                <div class="option-card" data-delay="100">
                    <div class="icon">âœ‚ï¸</div>
                    <h4>æ–‡æ¡£åˆ†å‰²</h4>
                    <p>chunk_size: 500-1500 å­—ç¬¦ï¼Œchunk_overlap: 10-20%</p>
                    <span class="tag">åˆ†å—ç­–ç•¥</span>
                </div>

                <div class="option-card" data-delay="200">
                    <div class="icon">ğŸ”</div>
                    <h4>æ£€ç´¢ä¼˜åŒ–</h4>
                    <p>k å€¼é€šå¸¸é€‰æ‹© 3-5ï¼Œè€ƒè™‘æŸ¥è¯¢é‡å†™å’Œæ··åˆæ£€ç´¢</p>
                    <span class="tag">æ£€ç´¢æ•ˆæœ</span>
                </div>

                <div class="option-card" data-delay="300">
                    <div class="icon">ğŸ’¬</div>
                    <h4>æç¤ºè¯å·¥ç¨‹</h4>
                    <p>æ˜ç¡®æŒ‡ç¤ºä½¿ç”¨ä¸Šä¸‹æ–‡ï¼Œæä¾›æ‹’ç»å›ç­”çš„æŒ‡ç¤º</p>
                    <span class="tag">Prompt</span>
                </div>
            </div>

            <div class="highlight-box" style="background: rgba(239, 68, 68, 0.15); border-left-color: #ef4444;">
                <h3 style="color: #ef4444;">âš ï¸ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3>
                <p>
                    <strong>é—®é¢˜ 1ï¼šæ£€ç´¢ä¸ç›¸å…³</strong><br>
                    â†’ æ”¹è¿›æ–‡æ¡£è´¨é‡ã€è°ƒæ•´ chunk_sizeã€ä½¿ç”¨æŸ¥è¯¢é‡å†™<br><br>
                    <strong>é—®é¢˜ 2ï¼šç­”æ¡ˆä¸å‡†ç¡®</strong><br>
                    â†’ å¢åŠ  k å€¼ã€æ”¹è¿›æç¤ºè¯ã€ä½¿ç”¨æ›´å¥½çš„ LLM<br><br>
                    <strong>é—®é¢˜ 3ï¼šå“åº”é€Ÿåº¦æ…¢</strong><br>
                    â†’ å‡å°‘æ£€ç´¢æ–‡æ¡£æ•°ã€ä½¿ç”¨æ›´å¿«çš„å‘é‡æ•°æ®åº“ã€ç¼“å­˜æŸ¥è¯¢
                </p>
            </div>

            <div class="code-showcase">
                <h4>ğŸ’» ä»£ç ç¤ºä¾‹ï¼šä¼˜åŒ–çš„ RAG æç¤ºè¯</h4>
                <pre><code>template = <span class="string">"""ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„é—®ç­”åŠ©æ‰‹ã€‚è¯·åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚

è¦æ±‚ï¼š
1. åªä½¿ç”¨æä¾›çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
2. å¦‚æœä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œæ˜ç¡®è¯´æ˜"æŠ±æ­‰ï¼Œæˆ‘æ— æ³•ä»æä¾›çš„ä¸Šä¸‹æ–‡ä¸­æ‰¾åˆ°ç­”æ¡ˆ"
3. ä¿æŒå›ç­”ç®€æ´å‡†ç¡®

ä¸Šä¸‹æ–‡ï¼š
{context}

é—®é¢˜ï¼š{question}

ç­”æ¡ˆï¼š"""</span>

prompt = ChatPromptTemplate.from_template(template)</code></pre>
            </div>
        </div>

        <!-- åœºæ™¯ 7: æ€»ç»“ -->
        <div class="scene" id="scene7">
            <h2 class="scene-title">ğŸ‰ æ€»ç»“ï¼šæŒæ¡ RAG</h2>

            <div class="use-case-list">
                <div class="use-case-item" data-delay="0">
                    <h4>ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ</h4>
                    <p>RAG = æ£€ç´¢ + ç”Ÿæˆï¼Œç»“åˆäº†ä¿¡æ¯æ£€ç´¢çš„å‡†ç¡®æ€§å’Œ LLM çš„ç”Ÿæˆèƒ½åŠ›</p>
                </div>

                <div class="use-case-item" data-delay="100">
                    <h4>ğŸ”‘ å…³é”®æŠ€æœ¯</h4>
                    <p>å‘é‡åµŒå…¥ã€å‘é‡æ•°æ®åº“ã€ç›¸ä¼¼åº¦æœç´¢ã€æç¤ºè¯å·¥ç¨‹</p>
                </div>

                <div class="use-case-item" data-delay="200">
                    <h4>ğŸ“Š å·¥ä½œæµç¨‹</h4>
                    <p>æ–‡æ¡£å‡†å¤‡ â†’ å‘é‡åŒ– â†’ å­˜å‚¨ â†’ æ£€ç´¢ â†’ ç”Ÿæˆç­”æ¡ˆ</p>
                </div>

                <div class="use-case-item" data-delay="300">
                    <h4>ğŸ’¡ æœ€ä½³å®è·µ</h4>
                    <p>æ•°æ®è´¨é‡ä¼˜å…ˆã€åˆç†çš„åˆ†å—ç­–ç•¥ã€ä¼˜åŒ–çš„ k å€¼ã€ç²¾å¿ƒè®¾è®¡çš„æç¤ºè¯</p>
                </div>
            </div>

            <div class="highlight-box" style="background: rgba(34, 197, 94, 0.15); border-left-color: #22c55e;">
                <h3 style="color: #22c55e;">ğŸš€ ä¸‹ä¸€æ­¥</h3>
                <p style="font-size: 1.1em; text-align: center;">
                    <strong>æ­å–œä½ æŒæ¡äº† RAG çš„æ ¸å¿ƒæ¦‚å¿µï¼</strong><br><br>
                    ç°åœ¨ä½ å¯ä»¥ï¼š<br>
                    â€¢ è¿”å›ä¸»é¡µç»§ç»­å­¦ä¹ å…¶ä»–æ¨¡å—<br>
                    â€¢ åŠ¨æ‰‹å®è·µï¼Œæ„å»ºè‡ªå·±çš„ RAG åº”ç”¨<br>
                    â€¢ æ¢ç´¢æ›´é«˜çº§çš„æ£€ç´¢ç­–ç•¥å’Œä¼˜åŒ–æŠ€å·§<br><br>
                    <strong>RAG æ˜¯æ„å»ºæ™ºèƒ½é—®ç­”ç³»ç»Ÿçš„åŸºç¡€ï¼ŒæŒæ¡å®ƒä½ å°±èƒ½åˆ›å»ºå¼ºå¤§çš„ AI åº”ç”¨ï¼</strong>
                </p>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <a href="index.html" class="action-btn" style="text-decoration: none; display: inline-block;">
                    ğŸ  è¿”å›é¦–é¡µ
                </a>
            </div>
        </div>

        <!-- åœºæ™¯æŒ‡ç¤ºå™¨ -->
        <div class="scene-indicators">
            <div class="indicator active" data-scene="1"></div>
            <div class="indicator" data-scene="2"></div>
            <div class="indicator" data-scene="3"></div>
            <div class="indicator" data-scene="4"></div>
            <div class="indicator" data-scene="5"></div>
            <div class="indicator" data-scene="6"></div>
            <div class="indicator" data-scene="7"></div>
        </div>

        <!-- å¯¼èˆªæŒ‰é’® -->
        <div class="nav-buttons">
            <button class="nav-btn" id="prevBtn" disabled>
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
                ä¸Šä¸€èŠ‚
            </button>
            <a href="index.html" class="nav-btn back-to-list">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/>
                </svg>
                è¯¾ç¨‹åˆ—è¡¨
            </a>
            <button class="nav-btn next" id="nextBtn">
                ä¸‹ä¸€èŠ‚
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // åœºæ™¯æ•°æ®
        const totalScenes = 7;
        let currentScene = 1;

        // DOM å…ƒç´ 
        const progressBar = document.getElementById('progressBar');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const indicators = document.querySelectorAll('.indicator');

        // åˆå§‹åŒ–
        function init() {
            updateScene();
            setupEventListeners();
            animateSceneElements();
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬
        function setupEventListeners() {
            // å¯¼èˆªæŒ‰é’®
            prevBtn.addEventListener('click', () => {
                if (currentScene > 1) {
                    currentScene--;
                    updateScene();
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentScene < totalScenes) {
                    currentScene++;
                    updateScene();
                }
            });

            // æŒ‡ç¤ºå™¨
            indicators.forEach(indicator => {
                indicator.addEventListener('click', () => {
                    currentScene = parseInt(indicator.dataset.scene);
                    updateScene();
                });
            });

            // é”®ç›˜å¯¼èˆª
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight' && currentScene < totalScenes) {
                    currentScene++;
                    updateScene();
                } else if (e.key === 'ArrowLeft' && currentScene > 1) {
                    currentScene--;
                    updateScene();
                }
            });
        }

        // æ›´æ–°åœºæ™¯
        function updateScene() {
            // æ›´æ–°è¿›åº¦æ¡
            const progress = ((currentScene - 1) / (totalScenes - 1)) * 100;
            progressBar.style.width = progress + '%';

            // æ›´æ–°åœºæ™¯æ˜¾ç¤º
            document.querySelectorAll('.scene').forEach((scene, index) => {
                if (index + 1 === currentScene) {
                    scene.classList.add('active');
                } else {
                    scene.classList.remove('active');
                }
            });

            // æ›´æ–°æŒ‡ç¤ºå™¨
            indicators.forEach((indicator, index) => {
                if (index + 1 === currentScene) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            prevBtn.disabled = currentScene === 1;
            nextBtn.disabled = currentScene === totalScenes;

            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // åŠ¨ç”»æ˜¾ç¤ºå…ƒç´ 
            setTimeout(() => {
                animateSceneElements();
            }, 300);
        }

        // åŠ¨ç”»æ˜¾ç¤ºåœºæ™¯å…ƒç´ 
        function animateSceneElements() {
            const currentSceneEl = document.querySelector(`#scene${currentScene}`);

            // å‘é‡ç›’å­åŠ¨ç”»
            currentSceneEl.querySelectorAll('.vector-box').forEach((box, index) => {
                const delay = parseInt(box.dataset.delay) || 0;
                setTimeout(() => {
                    box.classList.add('visible');
                    // åŠ¨ç”»æ˜¾ç¤ºç›¸ä¼¼åº¦æ¡
                    setTimeout(() => {
                        const fill = box.querySelector('.fill');
                        if (fill) {
                            const target = fill.dataset.target;
                            fill.style.width = target + '%';
                        }
                    }, 500);
                }, delay);
            });

            // æ–‡æ¡£å±‚åŠ¨ç”»
            currentSceneEl.querySelectorAll('.doc-layer').forEach((layer, index) => {
                const delay = parseInt(layer.dataset.delay) || 0;
                setTimeout(() => {
                    layer.classList.add('visible');
                }, delay);
            });

            // é€‰é¡¹å¡ç‰‡åŠ¨ç”»
            currentSceneEl.querySelectorAll('.option-card').forEach((card, index) => {
                const delay = parseInt(card.dataset.delay) || 0;
                setTimeout(() => {
                    card.classList.add('visible');
                }, delay);
            });

            // ç”¨ä¾‹é¡¹åŠ¨ç”»
            currentSceneEl.querySelectorAll('.use-case-item').forEach((item, index) => {
                const delay = parseInt(item.dataset.delay) || 0;
                setTimeout(() => {
                    item.classList.add('visible');
                }, delay);
            });

            // ä»£ç å±•ç¤ºåŠ¨ç”»
            currentSceneEl.querySelectorAll('.code-showcase').forEach((showcase, index) => {
                setTimeout(() => {
                    showcase.classList.add('visible');
                }, 500);
            });

            // æµç¨‹ç›’å­åŠ¨ç”»
            currentSceneEl.querySelectorAll('.flow-box').forEach((box, index) => {
                const delay = parseInt(box.dataset.delay) || 0;
                setTimeout(() => {
                    box.classList.add('visible');
                }, delay);
            });

            // æµç¨‹ç®­å¤´åŠ¨ç”»
            currentSceneEl.querySelectorAll('.flow-arrow').forEach((arrow, index) => {
                const delay = parseInt(arrow.dataset.delay) || 0;
                setTimeout(() => {
                    arrow.classList.add('visible');
                }, delay);
            });
        }

        // æ‰§è¡Œå‘é‡æ•°æ®åº“æœç´¢æ¼”ç¤º
        function performSearch() {
            const queryBox = document.getElementById('query-text');
            const resultsBox = document.getElementById('search-results');
            const docLayers = document.querySelectorAll('.doc-layer');

            // æŸ¥è¯¢åŠ¨ç”»
            queryBox.classList.add('matching');
            queryBox.innerHTML = 'ğŸ”„ æ­£åœ¨æ£€ç´¢...';

            // æ–‡æ¡£å±‚åŠ¨ç”»
            docLayers.forEach((layer, index) => {
                setTimeout(() => {
                    layer.classList.add('stored');
                }, index * 200);
            });

            // æ˜¾ç¤ºç»“æœ
            setTimeout(() => {
                queryBox.classList.remove('matching');
                queryBox.innerHTML = 'âœ… æ£€ç´¢å®Œæˆï¼';
                resultsBox.style.display = 'block';

                // åŠ¨ç”»æ˜¾ç¤ºç»“æœé¡¹
                document.querySelectorAll('.result-item').forEach((item, index) => {
                    const delay = parseInt(item.dataset.delay) || 0;
                    setTimeout(() => {
                        item.classList.add('visible');
                    }, delay);
                });
            }, 1500);
        }

        // è¿è¡Œ RAG å®Œæ•´æµç¨‹åŠ¨ç”»
        function runRAGAnimation() {
            const statusIndicator = document.getElementById('rag-status');
            const statusText = document.getElementById('status-text');
            const playBtn = document.getElementById('play-rag-btn');
            const stages = document.querySelectorAll('.flow-stage');
            const flowBoxes = document.querySelectorAll('.flow-box, .llm-box');
            const flowArrows = document.querySelectorAll('.flow-arrow');

            // ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
            playBtn.disabled = true;
            playBtn.textContent = 'â³ æ¼”ç¤ºè¿›è¡Œä¸­...';

            // æ˜¾ç¤ºçŠ¶æ€æç¤º
            statusIndicator.classList.add('visible');

            // é‡ç½®æ‰€æœ‰å…ƒç´ 
            flowBoxes.forEach(box => {
                box.classList.remove('visible', 'active');
            });
            flowArrows.forEach(arrow => {
                arrow.classList.remove('visible', 'active');
            });
            stages.forEach(stage => {
                stage.classList.remove('active');
            });

            // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°çŠ¶æ€æ–‡å­—
            const updateStatus = (text) => {
                statusText.style.opacity = '0';
                setTimeout(() => {
                    statusText.textContent = text;
                    statusText.style.opacity = '1';
                }, 300);
            };

            // è¾…åŠ©å‡½æ•°ï¼šæ¿€æ´»ç®­å¤´
            const activateArrow = (arrowId) => {
                const arrow = document.getElementById(arrowId);
                arrow.classList.add('visible', 'active');
                setTimeout(() => {
                    arrow.classList.remove('active');
                }, 800);
            };

            // ========== é˜¶æ®µ 1ï¼šå‡†å¤‡çŸ¥è¯†åº“ ==========
            setTimeout(() => {
                stages[0].classList.add('active');
                updateStatus('ğŸ“š é˜¶æ®µ 1/3: å‡†å¤‡çŸ¥è¯†åº“ - åŠ è½½æ–‡æ¡£');
                document.getElementById('flow-docs').classList.add('visible', 'active');
            }, 500);

            setTimeout(() => {
                updateStatus('âœ‚ï¸ æ–‡æ¡£åˆ†å‰² - å°†å¤§æ–‡æ¡£åˆ‡åˆ†æˆå°å—');
                activateArrow('flow-arrow-1');
                document.getElementById('flow-docs').classList.remove('active');
                document.getElementById('flow-split').classList.add('visible', 'active');
            }, 1500);

            setTimeout(() => {
                updateStatus('ğŸ¯ å‘é‡åµŒå…¥ - å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—å‘é‡');
                activateArrow('flow-arrow-2');
                document.getElementById('flow-split').classList.remove('active');
                document.getElementById('flow-embed').classList.add('visible', 'active');
            }, 2500);

            setTimeout(() => {
                updateStatus('ğŸ—„ï¸ å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ - ä¿å­˜å‘é‡ä»¥ä¾¿æ£€ç´¢');
                activateArrow('flow-arrow-3');
                document.getElementById('flow-embed').classList.remove('active');
                document.getElementById('flow-store').classList.add('visible', 'active');
            }, 3500);

            setTimeout(() => {
                document.getElementById('flow-store').classList.remove('active');
                stages[0].classList.remove('active');
            }, 4000);

            // ========== é˜¶æ®µ 2ï¼šæ£€ç´¢ ==========
            setTimeout(() => {
                stages[1].classList.add('active');
                updateStatus('ğŸ” é˜¶æ®µ 2/3: æ£€ç´¢ - ç”¨æˆ·æå‡ºé—®é¢˜');
                document.getElementById('flow-query').classList.add('visible', 'active');
            }, 4500);

            setTimeout(() => {
                updateStatus('ğŸ¯ æŸ¥è¯¢å‘é‡åŒ– - å°†é—®é¢˜è½¬æ¢ä¸ºå‘é‡');
                activateArrow('flow-arrow-4');
                document.getElementById('flow-query').classList.remove('active');
                document.getElementById('flow-query-embed').classList.add('visible', 'active');
            }, 5500);

            setTimeout(() => {
                updateStatus('ğŸ” ç›¸ä¼¼åº¦æœç´¢ - åœ¨å‘é‡æ•°æ®åº“ä¸­æŸ¥æ‰¾ç›¸å…³æ–‡æ¡£');
                activateArrow('flow-arrow-5');
                document.getElementById('flow-query-embed').classList.remove('active');
                document.getElementById('flow-retrieve').classList.add('visible', 'active');
            }, 6500);

            setTimeout(() => {
                document.getElementById('flow-retrieve').classList.remove('active');
                stages[1].classList.remove('active');
            }, 7000);

            // ========== é˜¶æ®µ 3ï¼šç”Ÿæˆ ==========
            setTimeout(() => {
                stages[2].classList.add('active');
                updateStatus('ğŸ“‹ é˜¶æ®µ 3/3: ç”Ÿæˆ - ç»„åˆä¸Šä¸‹æ–‡');
                activateArrow('flow-arrow-6');
                document.getElementById('flow-context').classList.add('visible', 'active');
            }, 7500);

            setTimeout(() => {
                updateStatus('ğŸ¤– LLM ç”Ÿæˆç­”æ¡ˆ - åŸºäºä¸Šä¸‹æ–‡ç”Ÿæˆå‡†ç¡®å›å¤');
                activateArrow('flow-arrow-7');
                document.getElementById('flow-context').classList.remove('active');
                document.getElementById('flow-gen-llm').classList.add('visible', 'active');
            }, 8500);

            setTimeout(() => {
                updateStatus('âœ… å®Œæˆ! RAG æµç¨‹æ¼”ç¤ºç»“æŸ');
                document.getElementById('flow-gen-llm').classList.remove('active');
                document.getElementById('flow-answer').classList.add('visible', 'active');
                stages[2].classList.remove('active');

                // æ¢å¤æŒ‰é’®
                setTimeout(() => {
                    playBtn.disabled = false;
                    playBtn.textContent = 'ğŸ¬ é‡æ–°æ’­æ”¾åŠ¨ç”»';
                }, 1000);
            }, 9500);
        }

        // å‘é‡æ•°æ®ï¼ˆæ¨¡æ‹Ÿè¯­ä¹‰å‘é‡ï¼‰
        const documentVectors = {
            "çŒ«": [0.85, 0.12, 0.15],
            "ç‹—": [0.88, 0.10, 0.18],
            "æ±½è½¦": [0.15, 0.82, 0.78]
        };

        // æŸ¥è¯¢è¯å¯¹åº”çš„æ¨¡æ‹Ÿå‘é‡ï¼ˆåŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦ï¼‰
        const queryVectors = {
            // åŠ¨ç‰©ç±»æŸ¥è¯¢
            "çŒ«": [0.85, 0.12, 0.15],
            "ç‹—": [0.88, 0.10, 0.18],
            "å® ç‰©": [0.86, 0.11, 0.16],
            "åŠ¨ç‰©": [0.87, 0.13, 0.19],
            "å°ç‹—": [0.89, 0.09, 0.17],
            "å°çŒ«": [0.84, 0.13, 0.14],
            "ç‹—ç‹—": [0.88, 0.11, 0.17],
            "çŒ«å’ª": [0.85, 0.13, 0.14],
            "æ¯›èŒ¸èŒ¸": [0.83, 0.15, 0.16],
            "å¯çˆ±çš„": [0.84, 0.14, 0.15],
            "å¿ è¯šçš„": [0.89, 0.08, 0.16],
            // äº¤é€šå·¥å…·ç±»æŸ¥è¯¢
            "æ±½è½¦": [0.15, 0.82, 0.78],
            "è½¦": [0.18, 0.84, 0.76],
            "äº¤é€šå·¥å…·": [0.12, 0.85, 0.80],
            "æœºå™¨": [0.20, 0.80, 0.75],
            "è½¦è¾†": [0.16, 0.83, 0.77],
            "æœºåŠ¨è½¦": [0.14, 0.86, 0.79]
        };

        // ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—
        function cosineSimilarity(vec1, vec2) {
            let dotProduct = 0;
            let norm1 = 0;
            let norm2 = 0;

            for (let i = 0; i < vec1.length; i++) {
                dotProduct += vec1[i] * vec2[i];
                norm1 += vec1[i] * vec1[i];
                norm2 += vec2[i] * vec2[i];
            }

            return dotProduct / (Math.sqrt(norm1) * Math.sqrt(norm2));
        }

        // è·å–æŸ¥è¯¢å‘é‡ï¼ˆå¦‚æœé¢„å®šä¹‰äº†å°±ä½¿ç”¨ï¼Œå¦åˆ™ç”Ÿæˆéšæœºå‘é‡ï¼‰
        function getQueryVector(query) {
            if (queryVectors[query]) {
                return queryVectors[query];
            }

            // å¦‚æœæ²¡æœ‰é¢„å®šä¹‰ï¼Œç”Ÿæˆä¸€ä¸ªåŸºäºæŸ¥è¯¢è¯é•¿åº¦çš„ä¼ªéšæœºå‘é‡
            const hash = query.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
            return [
                0.3 + (Math.sin(hash) * 0.3),
                0.3 + (Math.cos(hash) * 0.3),
                0.3 + (Math.sin(hash * 2) * 0.3)
            ];
        }

        // è®¡ç®—ç›¸ä¼¼åº¦å¹¶æ˜¾ç¤ºç»“æœ
        function calculateSimilarity() {
            const queryInput = document.getElementById('query-input');
            const query = queryInput.value.trim();

            if (!query) {
                alert('è¯·è¾“å…¥æŸ¥è¯¢è¯ï¼');
                return;
            }

            // è·å–æŸ¥è¯¢å‘é‡
            const queryVector = getQueryVector(query);

            // è®¡ç®—ä¸æ¯ä¸ªæ–‡æ¡£çš„ç›¸ä¼¼åº¦
            const similarities = [];
            for (const [word, vector] of Object.entries(documentVectors)) {
                const similarity = cosineSimilarity(queryVector, vector);
                similarities.push({
                    word: word,
                    vector: vector,
                    similarity: similarity
                });
            }

            // æŒ‰ç›¸ä¼¼åº¦æ’åº
            similarities.sort((a, b) => b.similarity - a.similarity);

            // æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯
            document.getElementById('query-display').textContent = query;
            document.getElementById('query-vector').textContent =
                '[' + queryVector.map(v => v.toFixed(2)).join(', ') + ']';

            // ç”Ÿæˆç›¸ä¼¼åº¦æ¡
            const similarityBars = document.getElementById('similarity-bars');
            similarityBars.innerHTML = '';

            similarities.forEach((item, index) => {
                const percentage = Math.round(item.similarity * 100);
                const emoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : 'ğŸ¥‰';

                const box = document.createElement('div');
                box.className = 'vector-box visible';
                box.style.marginTop = '15px';

                box.innerHTML = `
                    <h4>${emoji} "${item.word}"</h4>
                    <div class="vector-value">[${item.vector.map(v => v.toFixed(2)).join(', ')}]</div>
                    <div class="similarity-bar" style="height: 12px; margin-top: 15px;">
                        <div class="fill" style="width: ${percentage}%"></div>
                    </div>
                    <div style="text-align: center; margin-top: 8px; font-weight: bold; color: ${percentage > 70 ? '#22c55e' : percentage > 40 ? '#f59e0b' : '#ef4444'};">
                        ç›¸ä¼¼åº¦: ${percentage}%
                    </div>
                `;

                similarityBars.appendChild(box);
            });

            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            document.getElementById('similarity-results').style.display = 'block';

            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            setTimeout(() => {
                document.getElementById('similarity-results').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }

        // æ”¯æŒå›è½¦é”®æäº¤
        document.addEventListener('DOMContentLoaded', () => {
            const queryInput = document.getElementById('query-input');
            if (queryInput) {
                queryInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        calculateSimilarity();
                    }
                });
            }
        });

        // å¯åŠ¨
        init();
    </script>
</body>
</html>
