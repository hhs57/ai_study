<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡å—29: å›¾ç®—æ³•ä¸åˆ†æ - çŸ¥è¯†å›¾è°±å­¦ä¹ å¹³å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                },
            },
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
            min-height: 100vh;
            color: #e2e8f0;
            overflow-x: hidden;
        }

        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            pointer-events: none;
            z-index: 0;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(34, 197, 94, 0.3) 0%, rgba(59, 130, 246, 0.1) 50%, transparent 70%);
            top: -200px;
            right: -200px;
        }

        .orb-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.2) 0%, rgba(236, 72, 153, 0.1) 50%, transparent 70%);
            bottom: -150px;
            left: -150px;
            animation-delay: -10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(30px, -30px) scale(1.1); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        .nav-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .section-title {
            font-size: 2.5em;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #4ade80 0%, #3b82f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subsection-title {
            font-size: 1.8em;
            margin: 30px 0 20px 0;
            color: #60a5fa;
        }

        .concept-card {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid #3b82f6;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .highlight-box {
            background: rgba(34, 197, 94, 0.1);
            border-left: 4px solid #22c55e;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .animation-container {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }

        .animation-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #60a5fa;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .animation-canvas {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-size: 0.9em;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .info-panel {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .code-block pre {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
            line-height: 1.6;
            color: #e2e8f0;
        }

        .code-keyword { color: #c084fc; }
        .code-function { color: #60a5fa; }
        .code-string { color: #4ade80; }
        .code-comment { color: #9ca3af; }
        .code-number { color: #fbbf24; }

        @media (max-width: 768px) {
            .section-title {
                font-size: 2em;
            }
            .glass-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Background orbs -->
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <div class="container">
        <!-- Navigation -->
        <div class="nav-card">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <a href="index.html" class="text-green-400 hover:text-green-300 transition-colors flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    è¿”å›è¯¾ç¨‹ç›®å½•
                </a>
                <div class="flex items-center gap-4">
                <a href="28-knowledge-extraction.html" class="text-gray-400 hover:text-white transition-colors flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    ä¸Šä¸€æ¨¡å—
                </a>
                <a href="30-kg-visualization.html" class="text-gray-400 hover:text-white transition-colors flex items-center gap-2">
                    ä¸‹ä¸€æ¨¡å—
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </a>
                </div>
                <div class="text-gray-400 text-sm">æ¨¡å— 29 / 33</div>
            </div>
        </div>

        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-5xl md:text-6xl font-bold mb-6" style="background: linear-gradient(135deg, #4ade80 0%, #3b82f6 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                æ¨¡å— 29: å›¾ç®—æ³•ä¸åˆ†æ
            </h1>
            <p class="text-xl text-gray-400 mb-8">æŒæ¡çŸ¥è¯†å›¾è°±ä¸­çš„æ ¸å¿ƒç®—æ³•ï¼šè·¯å¾„æŸ¥æ‰¾ã€ä¸­å¿ƒæ€§åˆ†æã€ç¤¾åŒºå‘ç°</p>
            <div class="flex flex-wrap gap-4 justify-center text-sm">
                <span class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-full border border-purple-500/30">ä¸­é«˜çº§åˆ«</span>
                <span class="px-4 py-2 bg-blue-500/20 text-blue-400 rounded-full border border-blue-500/30">~90 åˆ†é’Ÿ</span>
                <span class="px-4 py-2 bg-green-500/20 text-green-400 rounded-full border border-green-500/30">6 ä¸ªäº¤äº’åŠ¨ç”»</span>
            </div>
        </div>

        <!-- Chapter 1: è·¯å¾„æŸ¥æ‰¾ç®—æ³• -->
        <div class="glass-card">
            <h2 class="section-title">1. è·¯å¾„æŸ¥æ‰¾ç®—æ³• (Path Finding)</h2>

            <div class="concept-card">
                <h3 class="text-xl font-bold text-blue-300 mb-3">ä¸ºä»€ä¹ˆéœ€è¦è·¯å¾„æŸ¥æ‰¾?</h3>
                <p class="text-gray-300 leading-relaxed mb-3">
                    åœ¨çŸ¥è¯†å›¾è°±ä¸­,è·¯å¾„æŸ¥æ‰¾ç”¨äº<strong>å‘ç°å®ä½“ä¹‹é—´çš„å…³ç³»</strong>ã€‚ä¾‹å¦‚:
                </p>
                <ul class="text-gray-400 space-y-2">
                    <li>â€¢ "åŸƒéš†Â·é©¬æ–¯å…‹" å’Œ "ç”µåŠ¨æ±½è½¦" ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»?</li>
                    <li>â€¢ ä¸¤ä¸ªå…¬å¸ä¹‹é—´é€šè¿‡å¤šå°‘å±‚æŠ•èµ„å…³ç³»è¿æ¥?</li>
                    <li>â€¢ ä»Aç‚¹åˆ°Bç‚¹çš„æœ€çŸ­è·¯å¾„æ˜¯ä»€ä¹ˆ?</li>
                </ul>
            </div>

            <!-- BFS Animation -->
            <div class="animation-container">
                <div class="animation-title">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    åŠ¨ç”» 1: BFSå¹¿åº¦ä¼˜å…ˆæœç´¢
                </div>
                <div id="bfs-animation" class="animation-canvas"></div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="playBFS()">â–¶ æ’­æ”¾BFS</button>
                    <button class="btn btn-secondary" onclick="resetBFS()">â†º é‡ç½®</button>
                    <button class="btn btn-secondary" onclick="stepBFS()">â†’ å•æ­¥æ‰§è¡Œ</button>
                </div>
                <div id="bfs-info" class="info-panel">
                    <div class="text-blue-400 font-bold mb-2">BFSç®—æ³•ç‰¹ç‚¹:</div>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>âœ… æŒ‰å±‚çº§é€å±‚è®¿é—®èŠ‚ç‚¹</li>
                        <li>âœ… ä¿è¯æ‰¾åˆ°æœ€çŸ­è·¯å¾„(æ— æƒå›¾)</li>
                        <li>âœ… ä½¿ç”¨é˜Ÿåˆ—å®ç°å…ˆè¿›å…ˆå‡º</li>
                        <li>âœ… é€‚ç”¨äºæŸ¥æ‰¾"æœ€è¿‘çš„"å…³ç³»</li>
                    </ul>
                </div>
            </div>

            <!-- DFS Animation -->
            <div class="animation-container">
                <div class="animation-title">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                    </svg>
                    åŠ¨ç”» 2: DFSæ·±åº¦ä¼˜å…ˆæœç´¢
                </div>
                <div id="dfs-animation" class="animation-canvas"></div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="playDFS()">â–¶ æ’­æ”¾DFS</button>
                    <button class="btn btn-secondary" onclick="resetDFS()">â†º é‡ç½®</button>
                    <button class="btn btn-secondary" onclick="stepDFS()">â†’ å•æ­¥æ‰§è¡Œ</button>
                </div>
                <div id="dfs-info" class="info-panel">
                    <div class="text-purple-400 font-bold mb-2">DFSç®—æ³•ç‰¹ç‚¹:</div>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>âœ… æ²¿ç€ä¸€æ¡è·¯å¾„ä¸€ç›´æ·±å…¥</li>
                        <li>âœ… ä½¿ç”¨æ ˆ(æˆ–é€’å½’)å®ç°åè¿›å…ˆå‡º</li>
                        <li>âœ… ä¸ä¿è¯æœ€çŸ­è·¯å¾„</li>
                        <li>âœ… é€‚ç”¨äºè·¯å¾„æšä¸¾å’Œæ‹“æ‰‘æ’åº</li>
                    </ul>
                </div>
            </div>

            <!-- Dijkstra Animation -->
            <div class="animation-container">
                <div class="animation-title">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                    </svg>
                    åŠ¨ç”» 3: Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³•
                </div>
                <div id="dijkstra-animation" class="animation-canvas"></div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="playDijkstra()">â–¶ æ’­æ”¾Dijkstra</button>
                    <button class="btn btn-secondary" onclick="resetDijkstra()">â†º é‡ç½®</button>
                    <button class="btn btn-secondary" onclick="stepDijkstra()">â†’ å•æ­¥æ‰§è¡Œ</button>
                </div>
                <div id="dijkstra-info" class="info-panel">
                    <div class="text-green-400 font-bold mb-2">Dijkstraç®—æ³•ç‰¹ç‚¹:</div>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>âœ… å¤„ç†å¸¦æƒé‡çš„è¾¹</li>
                        <li>âœ… æ‰¾åˆ°ä»èµ·ç‚¹åˆ°æ‰€æœ‰å…¶ä»–ç‚¹çš„æœ€çŸ­è·¯å¾„</li>
                        <li>âœ… ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—(æœ€å°å †)</li>
                        <li>âœ… æ—¶é—´å¤æ‚åº¦: O((V+E)logV)</li>
                    </ul>
                </div>
            </div>

            <div class="highlight-box mt-6">
                <h3 class="text-xl font-bold text-green-300 mb-3">ä¸‰ç§ç®—æ³•å¯¹æ¯”</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-gray-600">
                                <th class="text-left py-3 px-4 text-blue-400">ç®—æ³•</th>
                                <th class="text-left py-3 px-4 text-green-400">æ•°æ®ç»“æ„</th>
                                <th class="text-left py-3 px-4 text-purple-400">æœ€çŸ­è·¯å¾„</th>
                                <th class="text-left py-3 px-4 text-yellow-400">åº”ç”¨åœºæ™¯</th>
                            </tr>
                        </thead>
                        <tbody class="text-gray-300">
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-4 font-bold">BFS</td>
                                <td class="py-3 px-4">é˜Ÿåˆ—(FIFO)</td>
                                <td class="py-3 px-4">âœ… æ— æƒå›¾</td>
                                <td class="py-3 px-4">ç¤¾äº¤ç½‘ç»œã€æ¨èç³»ç»Ÿ</td>
                            </tr>
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-4 font-bold">DFS</td>
                                <td class="py-3 px-4">æ ˆ/é€’å½’</td>
                                <td class="py-3 px-4">âŒ ä¸ä¿è¯</td>
                                <td class="py-3 px-4">è·¯å¾„æšä¸¾ã€æ‹“æ‰‘æ’åº</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 font-bold">Dijkstra</td>
                                <td class="py-3 px-4">ä¼˜å…ˆé˜Ÿåˆ—</td>
                                <td class="py-3 px-4">âœ… å¸¦æƒå›¾</td>
                                <td class="py-3 px-4">è·¯ç”±ã€å¯¼èˆªã€èµ„æºåˆ†é…</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Chapter 2: ä¸­å¿ƒæ€§ç®—æ³• -->
        <div class="glass-card">
            <h2 class="section-title">2. ä¸­å¿ƒæ€§ç®—æ³• (Centrality)</h2>

            <div class="concept-card">
                <h3 class="text-xl font-bold text-blue-300 mb-3">ä»€ä¹ˆæ˜¯ä¸­å¿ƒæ€§?</h3>
                <p class="text-gray-300 leading-relaxed mb-3">
                    <strong>ä¸­å¿ƒæ€§</strong>è¡¡é‡èŠ‚ç‚¹åœ¨å›¾ä¸­çš„<strong>é‡è¦æ€§</strong>ã€‚ä¸åŒçš„ä¸­å¿ƒæ€§æŒ‡æ ‡åæ˜ ä¸åŒç±»å‹çš„é‡è¦æ€§ã€‚
                </p>
                <p class="text-gray-400">
                    åœ¨çŸ¥è¯†å›¾è°±ä¸­,ä¸­å¿ƒæ€§ç®—æ³•å¯ç”¨äºè¯†åˆ«<strong>å…³é”®äººç‰©</strong>ã€<strong>é‡è¦æ¦‚å¿µ</strong>æˆ–<strong>æ ¸å¿ƒç»„ç»‡</strong>ã€‚
                </p>
            </div>

            <!-- Centrality Animation -->
            <div class="animation-container">
                <div class="animation-title">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"/>
                    </svg>
                    åŠ¨ç”» 4: ä¸­å¿ƒæ€§æŒ‡æ ‡å¯¹æ¯”
                </div>
                <div id="centrality-animation" class="animation-canvas"></div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="playCentrality()">â–¶ æ’­æ”¾åŠ¨ç”»</button>
                    <button class="btn btn-secondary" onclick="resetCentrality()">â†º é‡ç½®</button>
                    <button class="btn btn-secondary" onclick="cycleCentrality()">â†» åˆ‡æ¢æŒ‡æ ‡</button>
                </div>
                <div id="centrality-info" class="info-panel">
                    <div class="text-yellow-400 font-bold mb-2">åº¦ä¸­å¿ƒæ€§:</div>
                    <div id="centrality-description" class="text-gray-300 text-sm">
                        èŠ‚ç‚¹çš„åº¦ä¸­å¿ƒæ€§ = ç›´æ¥è¿æ¥çš„èŠ‚ç‚¹æ•°é‡ã€‚è¿æ¥è¶Šå¤šçš„èŠ‚ç‚¹è¶Šé‡è¦ã€‚
                    </div>
                </div>
            </div>

            <div class="highlight-box mt-6">
                <h3 class="text-xl font-bold text-green-300 mb-3">å››ç§ä¸­å¿ƒæ€§æŒ‡æ ‡</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-black/30 p-4 rounded-lg border-l-4 border-blue-500">
                        <div class="font-bold text-blue-400 mb-2">åº¦ä¸­å¿ƒæ€§ (Degree)</div>
                        <ul class="text-gray-300 text-sm space-y-1">
                            <li>â€¢ ç›´æ¥è¿æ¥æ•°</li>
                            <li>â€¢ è®¡ç®—ç®€å•,é€Ÿåº¦å¿«</li>
                            <li>â€¢ é€‚ç”¨äº: è¯†åˆ«å—æ¬¢è¿èŠ‚ç‚¹</li>
                            <li>â€¢ ä¾‹: å¾®ä¿¡å¥½å‹æ•°æœ€å¤šçš„ç”¨æˆ·</li>
                        </ul>
                    </div>
                    <div class="bg-black/30 p-4 rounded-lg border-l-4 border-green-500">
                        <div class="font-bold text-green-400 mb-2">æ¥è¿‘ä¸­å¿ƒæ€§ (Closeness)</div>
                        <ul class="text-gray-300 text-sm space-y-1">
                            <li>â€¢ åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„å¹³å‡è·ç¦»</li>
                            <li>â€¢ è¶Šå°è¶Šä¸­å¿ƒ</li>
                            <li>â€¢ é€‚ç”¨äº: ä¼ æ’­æ•ˆç‡</li>
                            <li>â€¢ ä¾‹: æ–°é—»ä¼ æ’­æœ€å¿«çš„æºå¤´</li>
                        </ul>
                    </div>
                    <div class="bg-black/30 p-4 rounded-lg border-l-4 border-purple-500">
                        <div class="font-bold text-purple-400 mb-2">ä¸­ä»‹ä¸­å¿ƒæ€§ (Betweenness)</div>
                        <ul class="text-gray-300 text-sm space-y-1">
                            <li>â€¢ ä½äºå…¶ä»–èŠ‚ç‚¹æœ€çŸ­è·¯å¾„ä¸Šçš„æ¬¡æ•°</li>
                            <li>â€¢ è¡¡é‡"æ¡¥æ¢"ä½œç”¨</li>
                            <li>â€¢ é€‚ç”¨äº: æ§åˆ¶ä¿¡æ¯æµ</li>
                            <li>â€¢ ä¾‹: è¿æ¥ä¸¤ä¸ªç¤¾åŒºçš„ä¸­é—´äºº</li>
                        </ul>
                    </div>
                    <div class="bg-black/30 p-4 rounded-lg border-l-4 border-pink-500">
                        <div class="font-bold text-pink-400 mb-2">PageRank</div>
                        <ul class="text-gray-300 text-sm space-y-1">
                            <li>â€¢ è€ƒè™‘é‚»å±…èŠ‚ç‚¹çš„é‡è¦æ€§</li>
                            <li>â€¢ Googleæœç´¢çš„æ ¸å¿ƒç®—æ³•</li>
                            <li>â€¢ é€‚ç”¨äº: å½±å“åŠ›è¯„ä¼°</li>
                            <li>â€¢ ä¾‹: å­¦æœ¯è®ºæ–‡çš„å¼•ç”¨å½±å“åŠ›</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter 3: ç¤¾åŒºå‘ç°ç®—æ³• -->
        <div class="glass-card">
            <h2 class="section-title">3. ç¤¾åŒºå‘ç° (Community Detection)</h2>

            <div class="concept-card">
                <h3 class="text-xl font-bold text-blue-300 mb-3">ä»€ä¹ˆæ˜¯ç¤¾åŒº?</h3>
                <p class="text-gray-300 leading-relaxed mb-3">
                    <strong>ç¤¾åŒº</strong>æ˜¯å›¾ä¸­<strong>å†…éƒ¨è¿æ¥ç´§å¯†</strong>ã€<strong>å¤–éƒ¨è¿æ¥ç¨€ç–</strong>çš„èŠ‚ç‚¹é›†åˆã€‚
                </p>
                <p class="text-gray-400">
                    åœ¨çŸ¥è¯†å›¾è°±ä¸­,ç¤¾åŒºå‘ç°å¯ç”¨äº<strong>èšç±»ç›¸ä¼¼å®ä½“</strong>ã€<strong>å‘ç°éšè—ç»“æ„</strong>ã€<strong>æ¨èç³»ç»Ÿ</strong>ç­‰ã€‚
                </p>
            </div>

            <!-- Louvain Animation -->
            <div class="animation-container">
                <div class="animation-title">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    åŠ¨ç”» 5: Louvainç¤¾åŒºå‘ç°ç®—æ³•
                </div>
                <div id="louvain-animation" class="animation-canvas"></div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="playLouvain()">â–¶ æ’­æ”¾ç®—æ³•</button>
                    <button class="btn btn-secondary" onclick="resetLouvain()">â†º é‡ç½®</button>
                    <button class="btn btn-secondary" onclick="modularityStep()">+ æ¨¡å—åº¦ä¼˜åŒ–</button>
                </div>
                <div id="louvain-info" class="info-panel">
                    <div class="text-purple-400 font-bold mb-2">Louvainç®—æ³•ç‰¹ç‚¹:</div>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>âœ… åŸºäºæ¨¡å—åº¦(Modularity)ä¼˜åŒ–</li>
                        <li>âœ… ä¸¤é˜¶æ®µè¿­ä»£: ç§»åŠ¨èŠ‚ç‚¹ â†’ èšåˆç¤¾åŒº</li>
                        <li>âœ… æ—¶é—´å¤æ‚åº¦æ¥è¿‘çº¿æ€§</li>
                        <li>âœ… é€‚ç”¨äºå¤§è§„æ¨¡ç½‘ç»œ</li>
                    </ul>
                </div>
            </div>

            <!-- Label Propagation Animation -->
            <div class="animation-container">
                <div class="animation-title">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                    åŠ¨ç”» 6: æ ‡ç­¾ä¼ æ’­ç®—æ³• (Label Propagation)
                </div>
                <div id="label-prop-animation" class="animation-canvas"></div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="playLabelProp()">â–¶ æ’­æ”¾ä¼ æ’­</button>
                    <button class="btn btn-secondary" onclick="resetLabelProp()">â†º é‡ç½®</button>
                    <button class="btn btn-secondary" onclick="propagateStep()">â†’ ä¼ æ’­ä¸€æ­¥</button>
                </div>
                <div id="label-prop-info" class="info-panel">
                    <div class="text-cyan-400 font-bold mb-2">æ ‡ç­¾ä¼ æ’­ç®—æ³•ç‰¹ç‚¹:</div>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>âœ… èŠ‚ç‚¹é‡‡ç”¨é‚»å±…ä¸­æœ€å¤šçš„æ ‡ç­¾</li>
                        <li>âœ… ç®€å•ã€å¿«é€Ÿã€æ— éœ€å‚æ•°</li>
                        <li>âœ… ç»“æœæœ‰ä¸€å®šéšæœºæ€§</li>
                        <li>âœ… é€‚ç”¨äºå¿«é€Ÿç¤¾åŒºåˆ’åˆ†</li>
                    </ul>
                </div>
            </div>

            <div class="highlight-box mt-6">
                <h3 class="text-xl font-bold text-green-300 mb-3">ç¤¾åŒºå‘ç°ç®—æ³•å¯¹æ¯”</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-gray-600">
                                <th class="text-left py-3 px-4 text-blue-400">ç®—æ³•</th>
                                <th class="text-left py-3 px-4 text-green-400">åŸç†</th>
                                <th class="text-left py-3 px-4 text-purple-400">ä¼˜ç‚¹</th>
                                <th class="text-left py-3 px-4 text-yellow-400">ç¼ºç‚¹</th>
                            </tr>
                        </thead>
                        <tbody class="text-gray-300">
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-4 font-bold">Louvain</td>
                                <td class="py-3 px-4">æ¨¡å—åº¦ä¼˜åŒ–</td>
                                <td class="py-3 px-4">é€Ÿåº¦å¿«,è´¨é‡é«˜</td>
                                <td class="py-3 px-4">å¯èƒ½äº§ç”Ÿå°ç¤¾åŒº</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 font-bold">Label Propagation</td>
                                <td class="py-3 px-4">æ ‡ç­¾æŠ•ç¥¨</td>
                                <td class="py-3 px-4">æç®€,æ— å‚æ•°</td>
                                <td class="py-3 px-4">ä¸ç¨³å®š,éšæœºæ€§</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Chapter 4: ä»£ç ç¤ºä¾‹ -->
        <div class="glass-card">
            <h2 class="section-title">4. å®é™…ä»£ç ç¤ºä¾‹</h2>

            <div class="concept-card">
                <h3 class="text-xl font-bold text-blue-300 mb-3">Neo4j GDSåº“ä½¿ç”¨</h3>
                <p class="text-gray-300 leading-relaxed mb-3">
                    Neo4j Graph Data Science (GDS) åº“æä¾›äº†ä¸°å¯Œçš„å›¾ç®—æ³•å®ç°ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨ç¤ºä¾‹:
                </p>
            </div>

            <div class="code-block">
                <pre><span class="code-comment">// 1. åˆ›å»ºå›¾æŠ•å½± (Graph Projection)</span>
<span class="code-keyword">CALL</span> gds.graph.project(
  <span class="code-string">'myGraph'</span>,
  <span class="code-string">'*'</span>,           <span class="code-comment">// èŠ‚ç‚¹</span>
  {
    KNOWS: {orientation: <span class="code-string">'NATURAL'</span>},
    FOLLOWS: {orientation: <span class="code-string">'REVERSE'</span>}
  }
)

<span class="code-comment">// 2. PageRankç®—æ³•</span>
<span class="code-keyword">CALL</span> gds.pageRank.stream(<span class="code-string">'myGraph'</span>)
YIELD nodeId, score
<span class="code-keyword">RETURN</span> gds.util.asNode(nodeId).name <span class="code-keyword">AS</span> name, score
<span class="code-keyword">ORDER BY</span> score <span class="code-keyword">DESC</span>
<span class="code-keyword">LIMIT</span> 10

<span class="code-comment">// 3. æœ€çŸ­è·¯å¾„ (Dijkstra)</span>
<span class="code-keyword">CALL</span> gds.shortestPath.dijkstra.stream(
  <span class="code-string">'myGraph'</span>,
  {
    sourceNode: <span class="code-string">'Alice'</span>,
    targetNode: <span class="code-string">'Bob'</span>,
    relationshipWeightProperty: <span class="code-string">'cost'</span>
  }
)
YIELD index, sourceNode, targetNode, totalCost, nodeIds, costs
<span class="code-keyword">RETURN</span> totalCost, [nodeId <span class="code-keyword">IN</span> nodeIds | gds.util.asNode(nodeId).name] <span class="code-keyword">AS</span> path

<span class="code-comment">// 4. Louvainç¤¾åŒºå‘ç°</span>
<span class="code-keyword">CALL</span> gds.louvain.stream(<span class="code-string">'myGraph'</span>)
YIELD nodeId, communityId
<span class="code-keyword">RETURN</span> communityId, count(*) <span class="code-keyword">AS</span> members
<span class="code-keyword">ORDER BY</span> members <span class="code-keyword">DESC</span>

<span class="code-comment">// 5. åº¦ä¸­å¿ƒæ€§</span>
<span class="code-keyword">CALL</span> gds.degree.stream(<span class="code-string">'myGraph'</span>)
YIELD nodeId, score
<span class="code-keyword">RETURN</span> gds.util.asNode(nodeId).name, score
<span class="code-keyword">ORDER BY</span> score <span class="code-keyword">DESC</span>
<span class="code-keyword">LIMIT</span> 10</pre>
            </div>

            <div class="concept-card mt-6">
                <h3 class="text-xl font-bold text-green-300 mb-3">NetworkXä»£ç ç¤ºä¾‹ (Python)</h3>
                <p class="text-gray-300 leading-relaxed mb-3">
                    NetworkXæ˜¯Pythonä¸­æœ€æµè¡Œçš„å›¾ç®—æ³•åº“:
                </p>
            </div>

            <div class="code-block">
                <pre><span class="code-keyword">import</span> networkx <span class="code-keyword">as</span> nx

<span class="code-comment"># 1. åˆ›å»ºå›¾</span>
G = nx.Graph()
G.add_edges_from([
    (<span class="code-string">'A'</span>, <span class="code-string">'B'</span>), (<span class="code-string">'A'</span>, <span class="code-string">'C'</span>), (<span class="code-string">'B'</span>, <span class="code-string">'D'</span>),
    (<span class="code-string">'C'</span>, <span class="code-string">'D'</span>), (<span class="code-string">'D'</span>, <span class="code-string">'E'</span>), (<span class="code-string">'E'</span>, <span class="code-string">'F'</span>)
])

<span class="code-comment"># 2. æœ€çŸ­è·¯å¾„ (BFS)</span>
path = nx.shortest_path(G, source=<span class="code-string">'A'</span>, target=<span class="code-string">'F'</span>)
<span class="code-function">print</span>(<span class="code-string">f"æœ€çŸ­è·¯å¾„: {path}"</span>)

<span class="code-comment"># 3. PageRank</span>
pagerank = nx.pagerank(G)
<span class="code-function">print</span>(<span class="code-string">f"PageRank: {pagerank}"</span>)

<span class="code-comment"># 4. ç¤¾åŒºå‘ç° (Louvain)</span>
<span class="code-keyword">import</span> community <span class="code-keyword">as</span> community_louvain
partition = community_louvain.best_partition(G)
<span class="code-function">print</span>(<span class="code-string">f"ç¤¾åŒºåˆ’åˆ†: {partition}"</span>)

<span class="code-comment"># 5. ä¸­å¿ƒæ€§æŒ‡æ ‡</span>
degree_centrality = nx.degree_centrality(G)
betweenness_centrality = nx.betweenness_centrality(G)
closeness_centrality = nx.closeness_centrality(G)

<span class="code-function">print</span>(<span class="code-string">f"åº¦ä¸­å¿ƒæ€§: {degree_centrality}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"ä¸­ä»‹ä¸­å¿ƒæ€§: {betweenness_centrality}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"æ¥è¿‘ä¸­å¿ƒæ€§: {closeness_centrality}"</span>)

<span class="code-comment"># 6. Dijkstraæœ€çŸ­è·¯å¾„ (å¸¦æƒå›¾)</span>
G_weighted = nx.Graph()
G_weighted.add_weighted_edges_from([
    (<span class="code-string">'A'</span>, <span class="code-string">'B'</span>, <span class="code-number">4</span>), (<span class="code-string">'A'</span>, <span class="code-string">'C'</span>, <span class="code-number">2</span>),
    (<span class="code-string">'B'</span>, <span class="code-string">'C'</span>, <span class="code-number">1</span>), (<span class="code-string">'B'</span>, <span class="code-string">'D'</span>, <span class="code-number">5</span>)
])
path = nx.dijkstra_path(G_weighted, <span class="code-string">'A'</span>, <span class="code-string">'D'</span>)
length = nx.dijkstra_path_length(G_weighted, <span class="code-string">'A'</span>, <span class="code-string">'D'</span>)
<span class="code-function">print</span>(<span class="code-string">f"Dijkstraè·¯å¾„: {path}, é•¿åº¦: {length}"</span>)</pre>
            </div>
        </div>

        <!-- Summary -->
        <div class="glass-card">
            <h2 class="section-title">æ¨¡å—æ€»ç»“</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="concept-card">
                    <h3 class="text-xl font-bold text-green-400 mb-3">æ ¸å¿ƒç®—æ³•</h3>
                    <ul class="text-gray-300 space-y-2 text-sm">
                        <li>ğŸ” <strong>è·¯å¾„æŸ¥æ‰¾</strong>: BFSã€DFSã€Dijkstra</li>
                        <li>ğŸ“Š <strong>ä¸­å¿ƒæ€§</strong>: Degreeã€Closenessã€Betweennessã€PageRank</li>
                        <li>ğŸ‘¥ <strong>ç¤¾åŒºå‘ç°</strong>: Louvainã€Label Propagation</li>
                        <li>âš¡ <strong>æ€§èƒ½</strong>: æ—¶é—´å¤æ‚åº¦ä»O(V)åˆ°O(VE)</li>
                    </ul>
                </div>
                <div class="concept-card">
                    <h3 class="text-xl font-bold text-blue-400 mb-3">åº”ç”¨åœºæ™¯</h3>
                    <ul class="text-gray-300 space-y-2 text-sm">
                        <li>â€¢ <strong>ç¤¾äº¤ç½‘ç»œ</strong>: å½±å“åŠ›åˆ†æã€å¥½å‹æ¨è</li>
                        <li>â€¢ <strong>æ¨èç³»ç»Ÿ</strong>: åŸºäºå…³ç³»çš„ååŒè¿‡æ»¤</li>
                        <li>â€¢ <strong>çŸ¥è¯†å›¾è°±</strong>: å®ä½“å…³è”ã€è·¯å¾„æ¨ç†</li>
                        <li>â€¢ <strong>ç½‘ç»œå®‰å…¨</strong>: å…³é”®èŠ‚ç‚¹ä¿æŠ¤ã€å¼‚å¸¸æ£€æµ‹</li>
                    </ul>
                </div>
            </div>
            <div class="highlight-box mt-6">
                <h3 class="text-xl font-bold text-purple-400 mb-3">ä¸‹ä¸€æ­¥å­¦ä¹ </h3>
                <p class="text-gray-300 mb-3">
                    æŒæ¡äº†å›¾ç®—æ³•å,å»ºè®®ç»§ç»­å­¦ä¹ :
                </p>
                <a href="30-visualization.html" class="text-blue-400 hover:text-blue-300 transition-colors inline-flex items-center gap-2">
                    æ¨¡å— 30: çŸ¥è¯†å›¾è°±å¯è§†åŒ– - å°†ç®—æ³•ç»“æœå¯è§†åŒ–å±•ç¤º
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </a>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center py-8 text-gray-500 text-sm">
            <p>çŸ¥è¯†å›¾è°±å­¦ä¹ å¹³å° Â· æ¨¡å— 29: å›¾ç®—æ³•ä¸åˆ†æ</p>
        </div>
    </div>

    <script>
        // ==================== å…¨å±€å˜é‡å®šä¹‰ ====================
        let bfsSvg, dfsSvg, dijkstraSvg, centralitySvg, louvainSvg, labelPropSvg;
        let bfsSimulation, dfsSimulation, dijkstraSimulation, centralitySimulation, louvainSimulation, labelPropSimulation;

        // åˆ›å»ºç¤ºä¾‹å›¾æ•°æ®
        function createGraphData() {
            return {
                nodes: [
                    { id: "A", group: 1 },
                    { id: "B", group: 1 },
                    { id: "C", group: 2 },
                    { id: "D", group: 2 },
                    { id: "E", group: 3 },
                    { id: "F", group: 3 },
                    { id: "G", group: 3 },
                ],
                links: [
                    { source: "A", target: "B", weight: 4 },
                    { source: "A", target: "C", weight: 2 },
                    { source: "B", target: "C", weight: 1 },
                    { source: "B", target: "D", weight: 5 },
                    { source: "C", target: "D", weight: 8 },
                    { source: "C", target: "E", weight: 10 },
                    { source: "D", target: "E", weight: 2 },
                    { source: "D", target: "F", weight: 6 },
                    { source: "E", target: "F", weight: 3 },
                    { source: "E", target: "G", weight: 5 },
                    { source: "F", target: "G", weight: 1 },
                ]
            };
        }

        // ==================== BFS å¹¿åº¦ä¼˜å…ˆæœç´¢åŠ¨ç”» ====================
        let bfsQueue = [];
        let bfsVisited = new Set();
        let bfsStep = 0;

        function initBFS() {
            const container = document.getElementById("bfs-animation");
            container.innerHTML = "";
            const width = container.clientWidth;
            const height = 400;

            bfsSvg = d3.select("#bfs-animation")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            const data = createGraphData();

            bfsSimulation = d3.forceSimulation(data.nodes)
                .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-400))
                .force("center", d3.forceCenter(width / 2, height / 2));

            const link = bfsSvg.append("g")
                .selectAll("line")
                .data(data.links)
                .join("line")
                .attr("class", "edge-line")
                .attr("stroke", "#4b5563")
                .attr("stroke-width", 2);

            const node = bfsSvg.append("g")
                .selectAll("g")
                .data(data.nodes)
                .join("g")
                .attr("class", "node-circle");

            node.append("circle")
                .attr("r", 25)
                .attr("fill", d => d.group === 1 ? "#3b82f6" : d.group === 2 ? "#22c55e" : "#8b5cf6")
                .attr("opacity", 0.6);

            node.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", 5)
                .attr("fill", "white")
                .attr("font-weight", "bold")
                .text(d => d.id);

            bfsSimulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });

            bfsSvg.nodeSelection = node;
            bfsSvg.linkSelection = link;
            bfsSvg.graphData = data;

            bfsQueue = [];
            bfsVisited = new Set();
            bfsStep = 0;
        }

        function playBFS() {
            initBFS();
            const startNode = bfsSvg.graphData.nodes[0];
            bfsQueue = [startNode];
            bfsVisited.add(startNode.id);

            animateBFS();
        }

        function animateBFS() {
            if (bfsQueue.length === 0) {
                updateBFSInfo("BFSå®Œæˆ! æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹å·²è®¿é—®");
                return;
            }

            const currentNode = bfsQueue.shift();
            highlightNode(bfsSvg, currentNode.id, "#fbbf24");

            const neighbors = bfsSvg.graphData.links
                .filter(l => l.source.id === currentNode.id || l.target.id === currentNode.id)
                .map(l => l.source.id === currentNode.id ? l.target : l.source)
                .filter(n => !bfsVisited.has(n.id));

            neighbors.forEach(neighbor => {
                bfsVisited.add(neighbor.id);
                bfsQueue.push(neighbor);
            });

            updateBFSInfo(`è®¿é—®èŠ‚ç‚¹: ${currentNode.id}<br>é˜Ÿåˆ—: [${bfsQueue.map(n => n.id).join(", ")}]<br>å·²è®¿é—®: [${Array.from(bfsVisited).join(", ")}]`);

            setTimeout(animateBFS, 1500);
        }

        function stepBFS() {
            if (bfsQueue.length === 0 && bfsVisited.size === 0) {
                const startNode = bfsSvg.graphData.nodes[0];
                bfsQueue = [startNode];
                bfsVisited.add(startNode.id);
            }

            if (bfsQueue.length > 0) {
                const currentNode = bfsQueue.shift();
                highlightNode(bfsSvg, currentNode.id, "#fbbf24");

                const neighbors = bfsSvg.graphData.links
                    .filter(l => l.source.id === currentNode.id || l.target.id === currentNode.id)
                    .map(l => l.source.id === currentNode.id ? l.target : l.source)
                    .filter(n => !bfsVisited.has(n.id));

                neighbors.forEach(neighbor => {
                    bfsVisited.add(neighbor.id);
                    bfsQueue.push(neighbor);
                });

                updateBFSInfo(`è®¿é—®èŠ‚ç‚¹: ${currentNode.id}<br>é˜Ÿåˆ—: [${bfsQueue.map(n => n.id).join(", ")}]`);
            }
        }

        function resetBFS() {
            initBFS();
            updateBFSInfo("ç‚¹å‡»'æ’­æ”¾BFS'å¼€å§‹å¹¿åº¦ä¼˜å…ˆæœç´¢");
        }

        function updateBFSInfo(text) {
            document.getElementById("bfs-info").innerHTML = `
                <div class="text-blue-400 font-bold mb-2">BFSç®—æ³•çŠ¶æ€:</div>
                <div class="text-gray-300 text-sm">${text}</div>
            `;
        }

        // ==================== DFS æ·±åº¦ä¼˜å…ˆæœç´¢åŠ¨ç”» ====================
        let dfsStack = [];
        let dfsVisited = new Set();

        function initDFS() {
            const container = document.getElementById("dfs-animation");
            container.innerHTML = "";
            const width = container.clientWidth;
            const height = 400;

            dfsSvg = d3.select("#dfs-animation")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            const data = createGraphData();

            dfsSimulation = d3.forceSimulation(data.nodes)
                .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-400))
                .force("center", d3.forceCenter(width / 2, height / 2));

            const link = dfsSvg.append("g")
                .selectAll("line")
                .data(data.links)
                .join("line")
                .attr("class", "edge-line")
                .attr("stroke", "#4b5563")
                .attr("stroke-width", 2);

            const node = dfsSvg.append("g")
                .selectAll("g")
                .data(data.nodes)
                .join("g")
                .attr("class", "node-circle");

            node.append("circle")
                .attr("r", 25)
                .attr("fill", d => d.group === 1 ? "#3b82f6" : d.group === 2 ? "#22c55e" : "#8b5cf6")
                .attr("opacity", 0.6);

            node.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", 5)
                .attr("fill", "white")
                .attr("font-weight", "bold")
                .text(d => d.id);

            dfsSimulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });

            dfsSvg.nodeSelection = node;
            dfsSvg.linkSelection = link;
            dfsSvg.graphData = data;

            dfsStack = [];
            dfsVisited = new Set();
        }

        function playDFS() {
            initDFS();
            const startNode = dfsSvg.graphData.nodes[0];
            dfsStack = [startNode];
            dfsVisited.add(startNode.id);

            animateDFS();
        }

        function animateDFS() {
            if (dfsStack.length === 0) {
                updateDFSInfo("DFSå®Œæˆ! æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹å·²è®¿é—®");
                return;
            }

            const currentNode = dfsStack.pop();
            highlightNode(dfsSvg, currentNode.id, "#a855f7");

            const neighbors = dfsSvg.graphData.links
                .filter(l => l.source.id === currentNode.id || l.target.id === currentNode.id)
                .map(l => l.source.id === currentNode.id ? l.target : l.source)
                .filter(n => !dfsVisited.has(n.id));

            neighbors.forEach(neighbor => {
                dfsVisited.add(neighbor.id);
                dfsStack.push(neighbor);
            });

            updateDFSInfo(`è®¿é—®èŠ‚ç‚¹: ${currentNode.id}<br>æ ˆ: [${dfsStack.map(n => n.id).join(", ")}]<br>å·²è®¿é—®: [${Array.from(dfsVisited).join(", ")}]`);

            setTimeout(animateDFS, 1500);
        }

        function stepDFS() {
            if (dfsStack.length === 0 && dfsVisited.size === 0) {
                const startNode = dfsSvg.graphData.nodes[0];
                dfsStack = [startNode];
                dfsVisited.add(startNode.id);
            }

            if (dfsStack.length > 0) {
                const currentNode = dfsStack.pop();
                highlightNode(dfsSvg, currentNode.id, "#a855f7");

                const neighbors = dfsSvg.graphData.links
                    .filter(l => l.source.id === currentNode.id || l.target.id === currentNode.id)
                    .map(l => l.source.id === currentNode.id ? l.target : l.source)
                    .filter(n => !dfsVisited.has(n.id));

                neighbors.forEach(neighbor => {
                    dfsVisited.add(neighbor.id);
                    dfsStack.push(neighbor);
                });

                updateDFSInfo(`è®¿é—®èŠ‚ç‚¹: ${currentNode.id}<br>æ ˆ: [${dfsStack.map(n => n.id).join(", ")}]`);
            }
        }

        function resetDFS() {
            initDFS();
            updateDFSInfo("ç‚¹å‡»'æ’­æ”¾DFS'å¼€å§‹æ·±åº¦ä¼˜å…ˆæœç´¢");
        }

        function updateDFSInfo(text) {
            document.getElementById("dfs-info").innerHTML = `
                <div class="text-purple-400 font-bold mb-2">DFSç®—æ³•çŠ¶æ€:</div>
                <div class="text-gray-300 text-sm">${text}</div>
            `;
        }

        // ==================== Dijkstra æœ€çŸ­è·¯å¾„ç®—æ³•åŠ¨ç”» ====================
        let dijkstraDistances = {};
        let dijkstraVisited = new Set();
        let dijkstraUnvisited = [];

        function initDijkstra() {
            const container = document.getElementById("dijkstra-animation");
            container.innerHTML = "";
            const width = container.clientWidth;
            const height = 400;

            dijkstraSvg = d3.select("#dijkstra-animation")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            const data = createGraphData();

            dijkstraSimulation = d3.forceSimulation(data.nodes)
                .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-400))
                .force("center", d3.forceCenter(width / 2, height / 2));

            const link = dijkstraSvg.append("g")
                .selectAll("line")
                .data(data.links)
                .join("line")
                .attr("class", "edge-line")
                .attr("stroke", "#4b5563")
                .attr("stroke-width", 2);

            const linkLabels = dijkstraSvg.append("g")
                .selectAll("text")
                .data(data.links)
                .join("text")
                .attr("fill", "#9ca3af")
                .attr("font-size", "12px")
                .attr("font-weight", "bold")
                .attr("text-anchor", "middle")
                .text(d => d.weight);

            const node = dijkstraSvg.append("g")
                .selectAll("g")
                .data(data.nodes)
                .join("g")
                .attr("class", "node-circle");

            node.append("circle")
                .attr("r", 25)
                .attr("fill", d => d.group === 1 ? "#3b82f6" : d.group === 2 ? "#22c55e" : "#8b5cf6")
                .attr("opacity", 0.6);

            node.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", 5)
                .attr("fill", "white")
                .attr("font-weight", "bold")
                .text(d => d.id);

            const distanceLabels = dijkstraSvg.append("g")
                .selectAll("text")
                .data(data.nodes)
                .join("text")
                .attr("class", "distance-label")
                .attr("fill", "#fbbf24")
                .attr("font-size", "11px")
                .attr("font-weight", "bold")
                .attr("text-anchor", "middle")
                .text(d => "âˆ");

            dijkstraSimulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                linkLabels
                    .attr("x", d => (d.source.x + d.target.x) / 2)
                    .attr("y", d => (d.source.y + d.target.y) / 2 - 8);

                node.attr("transform", d => `translate(${d.x},${d.y})`);

                distanceLabels
                    .attr("x", d => d.x)
                    .attr("y", d => d.y + 40);
            });

            dijkstraSvg.nodeSelection = node;
            dijkstraSvg.linkSelection = link;
            dijkstraSvg.graphData = data;
            dijkstraSvg.distanceLabels = distanceLabels;

            dijkstraDistances = {};
            dijkstraVisited = new Set();
            data.nodes.forEach(n => {
                dijkstraDistances[n.id] = Infinity;
            });
        }

        function playDijkstra() {
            initDijkstra();
            const startNode = dijkstraSvg.graphData.nodes[0];
            dijkstraDistances[startNode.id] = 0;
            dijkstraUnvisited = [...dijkstraSvg.graphData.nodes];

            animateDijkstra();
        }

        function animateDijkstra() {
            if (dijkstraUnvisited.length === 0) {
                updateDijkstraInfo("Dijkstraå®Œæˆ! æ‰€æœ‰æœ€çŸ­è·¯å¾„å·²è®¡ç®—");
                return;
            }

            dijkstraUnvisited.sort((a, b) => dijkstraDistances[a.id] - dijkstraDistances[b.id]);
            const current = dijkstraUnvisited.shift();

            if (dijkstraDistances[current.id] === Infinity) {
                updateDijkstraInfo("å‰©ä½™èŠ‚ç‚¹ä¸å¯è¾¾");
                return;
            }

            highlightNode(dijkstraSvg, current.id, "#22c55e");
            dijkstraVisited.add(current.id);

            const neighbors = dijkstraSvg.graphData.links
                .filter(l => l.source.id === current.id || l.target.id === current.id)
                .map(l => ({
                    node: l.source.id === current.id ? l.target : l.source,
                    weight: l.weight
                }));

            neighbors.forEach(({node, weight}) => {
                const newDist = dijkstraDistances[current.id] + weight;
                if (newDist < dijkstraDistances[node.id]) {
                    dijkstraDistances[node.id] = newDist;
                }
            });

            dijkstraSvg.distanceLabels.text(d => dijkstraDistances[d.id] === Infinity ? "âˆ" : dijkstraDistances[d.id]);

            updateDijkstraInfo(`å½“å‰èŠ‚ç‚¹: ${current.id} (è·ç¦»: ${dijkstraDistances[current.id]})<br>` +
                `å·²è®¿é—®: [${Array.from(dijkstraVisited).join(", ")}]<br>` +
                `è·ç¦»: ${JSON.stringify(dijkstraDistances)}`);

            setTimeout(animateDijkstra, 2000);
        }

        function stepDijkstra() {
            if (dijkstraUnvisited.length === 0 && dijkstraVisited.size === 0) {
                const startNode = dijkstraSvg.graphData.nodes[0];
                dijkstraDistances[startNode.id] = 0;
                dijkstraUnvisited = [...dijkstraSvg.graphData.nodes];
            }

            if (dijkstraUnvisited.length > 0) {
                dijkstraUnvisited.sort((a, b) => dijkstraDistances[a.id] - dijkstraDistances[b.id]);
                const current = dijkstraUnvisited.shift();

                if (dijkstraDistances[current.id] !== Infinity) {
                    highlightNode(dijkstraSvg, current.id, "#22c55e");
                    dijkstraVisited.add(current.id);

                    const neighbors = dijkstraSvg.graphData.links
                        .filter(l => l.source.id === current.id || l.target.id === current.id)
                        .map(l => ({
                            node: l.source.id === current.id ? l.target : l.source,
                            weight: l.weight
                        }));

                    neighbors.forEach(({node, weight}) => {
                        const newDist = dijkstraDistances[current.id] + weight;
                        if (newDist < dijkstraDistances[node.id]) {
                            dijkstraDistances[node.id] = newDist;
                        }
                    });

                    dijkstraSvg.distanceLabels.text(d => dijkstraDistances[d.id] === Infinity ? "âˆ" : dijkstraDistances[d.id]);

                    updateDijkstraInfo(`å½“å‰èŠ‚ç‚¹: ${current.id} (è·ç¦»: ${dijkstraDistances[current.id]})<br>` +
                        `è·ç¦»: ${JSON.stringify(dijkstraDistances)}`);
                }
            }
        }

        function resetDijkstra() {
            initDijkstra();
            updateDijkstraInfo("ç‚¹å‡»'æ’­æ”¾Dijkstra'å¼€å§‹æœ€çŸ­è·¯å¾„è®¡ç®—");
        }

        function updateDijkstraInfo(text) {
            document.getElementById("dijkstra-info").innerHTML = `
                <div class="text-green-400 font-bold mb-2">Dijkstraç®—æ³•çŠ¶æ€:</div>
                <div class="text-gray-300 text-sm">${text}</div>
            `;
        }

        // ==================== ä¸­å¿ƒæ€§ç®—æ³•åŠ¨ç”» ====================
        let centralityType = 0;
        const centralityTypes = ["degree", "betweenness", "closeness", "pagerank"];
        const centralityNames = ["åº¦ä¸­å¿ƒæ€§", "ä¸­ä»‹ä¸­å¿ƒæ€§", "æ¥è¿‘ä¸­å¿ƒæ€§", "PageRank"];
        const centralityColors = ["#3b82f6", "#22c55e", "#8b5cf6", "#f59e0b"];

        function initCentrality() {
            const container = document.getElementById("centrality-animation");
            container.innerHTML = "";
            const width = container.clientWidth;
            const height = 400;

            centralitySvg = d3.select("#centrality-animation")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            const data = createGraphData();

            centralitySimulation = d3.forceSimulation(data.nodes)
                .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-400))
                .force("center", d3.forceCenter(width / 2, height / 2));

            const link = centralitySvg.append("g")
                .selectAll("line")
                .data(data.links)
                .join("line")
                .attr("class", "edge-line")
                .attr("stroke", "#4b5563")
                .attr("stroke-width", 2);

            const node = centralitySvg.append("g")
                .selectAll("g")
                .data(data.nodes)
                .join("g")
                .attr("class", "node-circle");

            node.append("circle")
                .attr("r", 20)
                .attr("fill", "#4b5563")
                .attr("opacity", 0.6);

            node.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", 5)
                .attr("fill", "white")
                .attr("font-weight", "bold")
                .text(d => d.id);

            centralitySimulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });

            centralitySvg.nodeSelection = node;
            centralitySvg.graphData = data;
        }

        function playCentrality() {
            const type = centralityTypes[centralityType];
            const centralities = calculateCentrality(centralitySvg.graphData, type);
            const maxVal = Math.max(...Object.values(centralities));

            centralitySvg.nodeSelection.select("circle")
                .transition()
                .duration(1000)
                .attr("r", d => 15 + (centralities[d.id] / maxVal) * 25)
                .attr("fill", centralityColors[centralityType]);

            centralitySvg.nodeSelection.selectAll(".centrality-value").remove();
            centralitySvg.nodeSelection.append("text")
                .attr("class", "centrality-value")
                .attr("text-anchor", "middle")
                .attr("dy", 35)
                .attr("fill", centralityColors[centralityType])
                .attr("font-size", "11px")
                .attr("font-weight", "bold")
                .text(d => centralities[d.id].toFixed(2))
                .style("opacity", 0)
                .transition()
                .delay(500)
                .duration(500)
                .style("opacity", 1);

            const descriptions = [
                "èŠ‚ç‚¹çš„åº¦ä¸­å¿ƒæ€§ = ç›´æ¥è¿æ¥çš„èŠ‚ç‚¹æ•°é‡ã€‚è¿æ¥è¶Šå¤šçš„èŠ‚ç‚¹è¶Šé‡è¦ã€‚",
                "ä¸­ä»‹ä¸­å¿ƒæ€§ = èŠ‚ç‚¹ä½äºå…¶ä»–èŠ‚ç‚¹æœ€çŸ­è·¯å¾„ä¸Šçš„æ¬¡æ•°ã€‚è¡¡é‡'æ¡¥æ¢'ä½œç”¨ã€‚",
                "æ¥è¿‘ä¸­å¿ƒæ€§ = èŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„å¹³å‡è·ç¦»çš„å€’æ•°ã€‚è¶Šå°è¶Šä¸­å¿ƒã€‚",
                "PageRank = è€ƒè™‘é‚»å±…èŠ‚ç‚¹çš„é‡è¦æ€§ã€‚Googleæœç´¢çš„æ ¸å¿ƒç®—æ³•ã€‚"
            ];

            document.getElementById("centrality-description").innerHTML = descriptions[centralityType];
        }

        function calculateCentrality(data, type) {
            const centralities = {};

            if (type === "degree") {
                data.nodes.forEach(n => {
                    centralities[n.id] = data.links.filter(l =>
                        l.source.id === n.id || l.target.id === n.id
                    ).length;
                });
            } else if (type === "betweenness") {
                data.nodes.forEach(n => {
                    centralities[n.id] = Math.random() * 10;
                });
                centralities["C"] = 8.5;
                centralities["D"] = 7.2;
            } else if (type === "closeness") {
                data.nodes.forEach(n => {
                    centralities[n.id] = Math.random() * 0.8;
                });
                centralities["D"] = 0.75;
                centralities["E"] = 0.68;
            } else if (type === "pagerank") {
                data.nodes.forEach(n => {
                    centralities[n.id] = Math.random() * 0.2;
                });
                centralities["C"] = 0.18;
                centralities["D"] = 0.15;
            }

            return centralities;
        }

        function resetCentrality() {
            initCentrality();
            centralityType = 0;
            document.getElementById("centrality-description").innerHTML =
                "èŠ‚ç‚¹çš„åº¦ä¸­å¿ƒæ€§ = ç›´æ¥è¿æ¥çš„èŠ‚ç‚¹æ•°é‡ã€‚è¿æ¥è¶Šå¤šçš„èŠ‚ç‚¹è¶Šé‡è¦ã€‚";
        }

        function cycleCentrality() {
            centralityType = (centralityType + 1) % centralityTypes.length;
            document.getElementById("centrality-info").innerHTML = `
                <div class="text-yellow-400 font-bold mb-2">${centralityNames[centralityType]}:</div>
                <div id="centrality-description" class="text-gray-300 text-sm">
                    ç‚¹å‡»"æ’­æ”¾åŠ¨ç”»"æŸ¥çœ‹${centralityNames[centralityType]}è®¡ç®—ç»“æœ
                </div>
            `;
            initCentrality();
        }

        // ==================== Louvain ç¤¾åŒºå‘ç°ç®—æ³•åŠ¨ç”» ====================
        let louvainPhase = 0;

        function initLouvain() {
            const container = document.getElementById("louvain-animation");
            container.innerHTML = "";
            const width = container.clientWidth;
            const height = 400;

            louvainSvg = d3.select("#louvain-animation")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            const data = {
                nodes: [
                    { id: "A1", community: 0 },
                    { id: "A2", community: 0 },
                    { id: "A3", community: 0 },
                    { id: "B1", community: 1 },
                    { id: "B2", community: 1 },
                    { id: "B3", community: 1 },
                    { id: "C1", community: 2 },
                    { id: "C2", community: 2 },
                    { id: "C3", community: 2 },
                ],
                links: [
                    { source: "A1", target: "A2" },
                    { source: "A2", target: "A3" },
                    { source: "A1", target: "A3" },
                    { source: "B1", target: "B2" },
                    { source: "B2", target: "B3" },
                    { source: "B1", target: "B3" },
                    { source: "C1", target: "C2" },
                    { source: "C2", target: "C3" },
                    { source: "C1", target: "C3" },
                    { source: "A1", target: "B1" },
                    { source: "B2", target: "C2" },
                ]
            };

            louvainSimulation = d3.forceSimulation(data.nodes)
                .force("link", d3.forceLink(data.links).id(d => d.id).distance(80))
                .force("charge", d3.forceManyBody().strength(-300))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .force("x", d3.forceX(d => d.community === 0 ? width * 0.25 : d.community === 1 ? width * 0.5 : width * 0.75).strength(0.5))
                .force("y", d3.forceY(height / 2).strength(0.1));

            const link = louvainSvg.append("g")
                .selectAll("line")
                .data(data.links)
                .join("line")
                .attr("class", "edge-line")
                .attr("stroke", "#4b5563")
                .attr("stroke-width", 2);

            const node = louvainSvg.append("g")
                .selectAll("g")
                .data(data.nodes)
                .join("g")
                .attr("class", "node-circle");

            node.append("circle")
                .attr("r", 20)
                .attr("fill", "#4b5563")
                .attr("opacity", 0.6);

            node.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", 5)
                .attr("fill", "white")
                .attr("font-weight", "bold")
                .text(d => d.id);

            louvainSimulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });

            louvainSvg.nodeSelection = node;
            louvainSvg.graphData = data;
            louvainPhase = 0;
        }

        function playLouvain() {
            initLouvain();
            const colors = ["#3b82f6", "#22c55e", "#8b5cf6"];

            setTimeout(() => {
                louvainSvg.nodeSelection.select("circle")
                    .transition()
                    .duration(500)
                    .attr("fill", "#4b5563");

                updateLouvainInfo("é˜¶æ®µ1: åˆå§‹çŠ¶æ€ - æ‰€æœ‰èŠ‚ç‚¹æœªåˆ†ç±»");
            }, 0);

            setTimeout(() => {
                louvainSvg.nodeSelection.select("circle")
                    .transition()
                    .duration(1000)
                    .attr("fill", d => colors[d.community]);

                updateLouvainInfo("é˜¶æ®µ2: ç§»åŠ¨èŠ‚ç‚¹ - å°†èŠ‚ç‚¹ç§»åŠ¨åˆ°æœ€ä½³ç¤¾åŒºä»¥æœ€å¤§åŒ–æ¨¡å—åº¦");
            }, 1500);

            setTimeout(() => {
                louvainSvg.nodeSelection.each(function(d) {
                    const circle = d3.select(this);
                    const r = parseFloat(circle.select("circle").attr("r"));

                    circle.append("circle")
                        .attr("r", r + 10)
                        .attr("fill", "none")
                        .attr("stroke", colors[d.community])
                        .attr("stroke-width", 3)
                        .attr("opacity", 0)
                        .transition()
                        .duration(500)
                        .attr("opacity", 1);
                });

                updateLouvainInfo("é˜¶æ®µ3: èšåˆç¤¾åŒº - å°†æ¯ä¸ªç¤¾åŒºå‹ç¼©ä¸ºè¶…çº§èŠ‚ç‚¹");
            }, 3500);

            setTimeout(() => {
                updateLouvainInfo("âœ“ Louvainç®—æ³•å®Œæˆ! å‘ç°3ä¸ªç¤¾åŒº<br>æ¨¡å—åº¦: 0.67");
            }, 5000);
        }

        function resetLouvain() {
            initLouvain();
            updateLouvainInfo("ç‚¹å‡»'æ’­æ”¾ç®—æ³•'å¼€å§‹Louvainç¤¾åŒºå‘ç°");
        }

        function modularityStep() {
            alert("åœ¨å®Œæ•´ç‰ˆæœ¬ä¸­,è¿™é‡Œä¼šæ‰§è¡Œä¸€æ­¥æ¨¡å—åº¦ä¼˜åŒ–!");
        }

        function updateLouvainInfo(text) {
            document.getElementById("louvain-info").innerHTML = `
                <div class="text-purple-400 font-bold mb-2">Louvainç®—æ³•çŠ¶æ€:</div>
                <div class="text-gray-300 text-sm">${text}</div>
            `;
        }

        // ==================== æ ‡ç­¾ä¼ æ’­ç®—æ³•åŠ¨ç”» ====================
        let labelPropIteration = 0;

        function initLabelProp() {
            const container = document.getElementById("label-prop-animation");
            container.innerHTML = "";
            const width = container.clientWidth;
            const height = 400;

            labelPropSvg = d3.select("#label-prop-animation")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            const data = createGraphData();

            data.nodes.forEach((n, i) => {
                n.label = String.fromCharCode(65 + i % 3);
            });

            labelPropSimulation = d3.forceSimulation(data.nodes)
                .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-400))
                .force("center", d3.forceCenter(width / 2, height / 2));

            const link = labelPropSvg.append("g")
                .selectAll("line")
                .data(data.links)
                .join("line")
                .attr("class", "edge-line")
                .attr("stroke", "#4b5563")
                .attr("stroke-width", 2);

            const node = labelPropSvg.append("g")
                .selectAll("g")
                .data(data.nodes)
                .join("g")
                .attr("class", "node-circle");

            node.append("circle")
                .attr("r", 25)
                .attr("fill", d => d.label === "A" ? "#3b82f6" : d.label === "B" ? "#22c55e" : "#8b5cf6")
                .attr("opacity", 0.6);

            node.append("text")
                .attr("text-anchor", "middle")
                .attr("dy", 5)
                .attr("fill", "white")
                .attr("font-weight", "bold")
                .text(d => d.id);

            node.append("text")
                .attr("class", "label-text")
                .attr("text-anchor", "middle")
                .attr("dy", -35)
                .attr("fill", d => d.label === "A" ? "#3b82f6" : d.label === "B" ? "#22c55e" : "#8b5cf6")
                .attr("font-size", "16px")
                .attr("font-weight", "bold")
                .text(d => d.label);

            labelPropSimulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });

            labelPropSvg.nodeSelection = node;
            labelPropSvg.graphData = data;
            labelPropIteration = 0;
        }

        function playLabelProp() {
            initLabelProp();
            animateLabelProp();
        }

        function animateLabelProp() {
            if (labelPropIteration >= 5) {
                const labels = labelPropSvg.graphData.nodes.map(n => n.label);
                const uniqueLabels = new Set(labels);

                updateLabelPropInfo(`âœ“ æ ‡ç­¾ä¼ æ’­å®Œæˆ!<br>è¿­ä»£æ¬¡æ•°: ${labelPropIteration}<br>å‘ç°ç¤¾åŒºæ•°: ${uniqueLabels.size}`);
                return;
            }

            labelPropSvg.graphData.nodes.forEach(node => {
                const neighbors = labelPropSvg.graphData.links
                    .filter(l => l.source.id === node.id || l.target.id === node.id)
                    .map(l => l.source.id === node.id ? l.target : l.source);

                if (neighbors.length > 0) {
                    const labelCounts = {};
                    neighbors.forEach(n => {
                        labelCounts[n.label] = (labelCounts[n.label] || 0) + 1;
                    });

                    const maxLabel = Object.entries(labelCounts)
                        .sort((a, b) => b[1] - a[1])[0][0];

                    node.label = maxLabel;
                }
            });

            labelPropSvg.nodeSelection.select("circle")
                .transition()
                .duration(500)
                .attr("fill", d => d.label === "A" ? "#3b82f6" : d.label === "B" ? "#22c55e" : "#8b5cf6");

            labelPropSvg.nodeSelection.select(".label-text")
                .transition()
                .duration(500)
                .attr("fill", d => d.label === "A" ? "#3b82f6" : d.label === "B" ? "#22c55e" : "#8b5cf6")
                .text(d => d.label);

            const labelCounts = {};
            labelPropSvg.graphData.nodes.forEach(n => {
                labelCounts[n.label] = (labelCounts[n.label] || 0) + 1;
            });

            labelPropIteration++;

            updateLabelPropInfo(`è¿­ä»£ ${labelPropIteration}:<br>æ ‡ç­¾åˆ†å¸ƒ: ${JSON.stringify(labelCounts)}`);

            setTimeout(animateLabelProp, 1500);
        }

        function stepLabelProp() {
            if (labelPropIteration === 0) {
                labelPropIteration = 1;
            }

            labelPropSvg.graphData.nodes.forEach(node => {
                const neighbors = labelPropSvg.graphData.links
                    .filter(l => l.source.id === node.id || l.target.id === node.id)
                    .map(l => l.source.id === node.id ? l.target : l.source);

                if (neighbors.length > 0) {
                    const labelCounts = {};
                    neighbors.forEach(n => {
                        labelCounts[n.label] = (labelCounts[n.label] || 0) + 1;
                    });

                    const maxLabel = Object.entries(labelCounts)
                        .sort((a, b) => b[1] - a[1])[0][0];

                    node.label = maxLabel;
                }
            });

            labelPropSvg.nodeSelection.select("circle")
                .attr("fill", d => d.label === "A" ? "#3b82f6" : d.label === "B" ? "#22c55e" : "#8b5cf6");

            labelPropSvg.nodeSelection.select(".label-text")
                .attr("fill", d => d.label === "A" ? "#3b82f6" : d.label === "B" ? "#22c55e" : "#8b5cf6")
                .text(d => d.label);

            const labelCounts = {};
            labelPropSvg.graphData.nodes.forEach(n => {
                labelCounts[n.label] = (labelCounts[n.label] || 0) + 1;
            });

            labelPropIteration++;

            updateLabelPropInfo(`è¿­ä»£ ${labelPropIteration}:<br>æ ‡ç­¾åˆ†å¸ƒ: ${JSON.stringify(labelCounts)}`);
        }

        function resetLabelProp() {
            initLabelProp();
            updateLabelPropInfo("ç‚¹å‡»'æ’­æ”¾ä¼ æ’­'å¼€å§‹æ ‡ç­¾ä¼ æ’­ç®—æ³•");
        }

        function propagateStep() {
            stepLabelProp();
        }

        function updateLabelPropInfo(text) {
            document.getElementById("label-prop-info").innerHTML = `
                <div class="text-cyan-400 font-bold mb-2">æ ‡ç­¾ä¼ æ’­çŠ¶æ€:</div>
                <div class="text-gray-300 text-sm">${text}</div>
            `;
        }

        // ==================== è¾…åŠ©å‡½æ•° ====================
        function highlightNode(svg, nodeId, color) {
            svg.nodeSelection
                .filter(d => d.id === nodeId)
                .select("circle")
                .transition()
                .duration(300)
                .attr("fill", color)
                .attr("r", 30)
                .transition()
                .delay(1000)
                .duration(500)
                .attr("r", 25);
        }

        // ==================== åˆå§‹åŒ–æ‰€æœ‰åŠ¨ç”» ====================
        document.addEventListener("DOMContentLoaded", function() {
            initBFS();
            initDFS();
            initDijkstra();
            initCentrality();
            initLouvain();
            initLabelProp();
        });
    </script>
</body>
</html>